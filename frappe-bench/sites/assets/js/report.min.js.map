{"version":3,"file":"report.min.js","sources":["../../../apps/frappe/frappe/public/js/lib/clusterize.min.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/report_factory.js","../../../apps/frappe/node_modules/sortablejs/Sortable.js","../../../apps/frappe/node_modules/frappe-datatable/dist/frappe-datatable.cjs.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/report_view.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/query_report.js","../../../apps/frappe/frappe/public/js/frappe/views/reports/grid_report.js"],"sourcesContent":["/*! Clusterize.js - v0.17.6 - 2017-03-05\n* http://NeXTs.github.com/Clusterize.js/\n* Copyright (c) 2015 Denis Lukov; Licensed GPLv3 */\n\n;(function(q,n){\"undefined\"!=typeof module?module.exports=n():\"function\"==typeof define&&\"object\"==typeof define.amd?define(n):this[q]=n()})(\"Clusterize\",function(){function q(b,a,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent(\"on\"+b,c)}function n(b,a,c){return a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent(\"on\"+b,c)}function r(b){return\"[object Array]\"===Object.prototype.toString.call(b)}function m(b,a){return window.getComputedStyle?window.getComputedStyle(a)[b]:\n\ta.currentStyle[b]}var l=function(){for(var b=3,a=document.createElement(\"b\"),c=a.all||[];a.innerHTML=\"\\x3c!--[if gt IE \"+ ++b+\"]><i><![endif]--\\x3e\",c[0];);return 4<b?b:document.documentMode}(),x=navigator.platform.toLowerCase().indexOf(\"mac\")+1,p=function(b){if(!(this instanceof p))return new p(b);var a=this,c={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:\"clusterize-no-data\",no_data_text:\"No data\",keep_parity:!0,callbacks:{}};a.options={};for(var d=\"rows_in_block blocks_in_cluster show_no_data_row no_data_class no_data_text keep_parity tag callbacks\".split(\" \"),\n\tf=0,h;h=d[f];f++)a.options[h]=\"undefined\"!=typeof b[h]&&null!=b[h]?b[h]:c[h];c=[\"scroll\",\"content\"];for(f=0;d=c[f];f++)if(a[d+\"_elem\"]=b[d+\"Id\"]?document.getElementById(b[d+\"Id\"]):b[d+\"Elem\"],!a[d+\"_elem\"])throw Error(\"Error! Could not find \"+d+\" element\");a.content_elem.hasAttribute(\"tabindex\")||a.content_elem.setAttribute(\"tabindex\",0);var e=r(b.rows)?b.rows:a.fetchMarkup(),g={};b=a.scroll_elem.scrollTop;a.insertToDOM(e,g);a.scroll_elem.scrollTop=b;var k=!1,m=0,l=!1,t=function(){x&&(l||(a.content_elem.style.pointerEvents=\n\t\"none\"),l=!0,clearTimeout(m),m=setTimeout(function(){a.content_elem.style.pointerEvents=\"auto\";l=!1},50));k!=(k=a.getClusterNum())&&a.insertToDOM(e,g);a.options.callbacks.scrollingProgress&&a.options.callbacks.scrollingProgress(a.getScrollProgress())},u=0,v=function(){clearTimeout(u);u=setTimeout(a.refresh,100)};q(\"scroll\",a.scroll_elem,t);q(\"resize\",window,v);a.destroy=function(b){n(\"scroll\",a.scroll_elem,t);n(\"resize\",window,v);a.html((b?a.generateEmptyRow():e).join(\"\"))};a.refresh=function(b){(a.getRowsHeight(e)||\n\tb)&&a.update(e)};a.update=function(b){e=r(b)?b:[];b=a.scroll_elem.scrollTop;e.length*a.options.item_height<b&&(k=a.scroll_elem.scrollTop=0);a.insertToDOM(e,g);a.scroll_elem.scrollTop=b};a.clear=function(){a.update([])};a.getRowsAmount=function(){return e.length};a.getScrollProgress=function(){return this.options.scroll_top/(e.length*this.options.item_height)*100||0};var w=function(b,c){var d=r(c)?c:[];d.length&&(e=\"append\"==b?e.concat(d):d.concat(e),a.insertToDOM(e,g))};a.append=function(a){w(\"append\",\n\ta)};a.prepend=function(a){w(\"prepend\",a)}};p.prototype={constructor:p,fetchMarkup:function(){for(var b=[],a=this.getChildNodes(this.content_elem);a.length;)b.push(a.shift().outerHTML);return b},exploreEnvironment:function(b,a){var c=this.options;c.content_tag=this.content_elem.tagName.toLowerCase();b.length&&(l&&9>=l&&!c.tag&&(c.tag=b[0].match(/<([^>\\s/]*)/)[1].toLowerCase()),1>=this.content_elem.children.length&&(a.data=this.html(b[0]+b[0]+b[0])),c.tag||(c.tag=this.content_elem.children[0].tagName.toLowerCase()),\n\tthis.getRowsHeight(b))},getRowsHeight:function(b){var a=this.options,c=a.item_height;a.cluster_height=0;if(b.length){b=this.content_elem.children;var d=b[Math.floor(b.length/2)];a.item_height=d.offsetHeight;\"tr\"==a.tag&&\"collapse\"!=m(\"borderCollapse\",this.content_elem)&&(a.item_height+=parseInt(m(\"borderSpacing\",this.content_elem),10)||0);\"tr\"!=a.tag&&(b=parseInt(m(\"marginTop\",d),10)||0,d=parseInt(m(\"marginBottom\",d),10)||0,a.item_height+=Math.max(b,d));a.block_height=a.item_height*a.rows_in_block;\n\ta.rows_in_cluster=a.blocks_in_cluster*a.rows_in_block;a.cluster_height=a.blocks_in_cluster*a.block_height;return c!=a.item_height}},getClusterNum:function(){this.options.scroll_top=this.scroll_elem.scrollTop;return Math.floor(this.options.scroll_top/(this.options.cluster_height-this.options.block_height))||0},generateEmptyRow:function(){var b=this.options;if(!b.tag||!b.show_no_data_row)return[];var a=document.createElement(b.tag),c=document.createTextNode(b.no_data_text),d;a.className=b.no_data_class;\n\t\"tr\"==b.tag&&(d=document.createElement(\"td\"),d.colSpan=100,d.appendChild(c));a.appendChild(d||c);return[a.outerHTML]},generate:function(b,a){var c=this.options,d=b.length;if(d<c.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:d?b:this.generateEmptyRow()};var f=Math.max((c.rows_in_cluster-c.rows_in_block)*a,0),h=f+c.rows_in_cluster,e=Math.max(f*c.item_height,0),c=Math.max((d-h)*c.item_height,0),d=[],g=f;for(1>e&&g++;f<h;f++)b[f]&&d.push(b[f]);return{top_offset:e,bottom_offset:c,\n\trows_above:g,rows:d}},renderExtraTag:function(b,a){var c=document.createElement(this.options.tag);c.className=[\"clusterize-extra-row\",\"clusterize-\"+b].join(\" \");a&&(c.style.height=a+\"px\");return c.outerHTML},insertToDOM:function(b,a){this.options.cluster_height||this.exploreEnvironment(b,a);var c=this.generate(b,this.getClusterNum()),d=c.rows.join(\"\"),f=this.checkChanges(\"data\",d,a),h=this.checkChanges(\"top\",c.top_offset,a),e=this.checkChanges(\"bottom\",c.bottom_offset,a),g=this.options.callbacks,\n\tk=[];f||h?(c.top_offset&&(this.options.keep_parity&&k.push(this.renderExtraTag(\"keep-parity\")),k.push(this.renderExtraTag(\"top-space\",c.top_offset))),k.push(d),c.bottom_offset&&k.push(this.renderExtraTag(\"bottom-space\",c.bottom_offset)),g.clusterWillChange&&g.clusterWillChange(),this.html(k.join(\"\")),\"ol\"==this.options.content_tag&&this.content_elem.setAttribute(\"start\",c.rows_above),g.clusterChanged&&g.clusterChanged()):e&&(this.content_elem.lastChild.style.height=c.bottom_offset+\"px\")},html:function(b){var a=\n\tthis.content_elem;if(l&&9>=l&&\"tr\"==this.options.tag){var c=document.createElement(\"div\");for(c.innerHTML=\"<table><tbody>\"+b+\"</tbody></table>\";b=a.lastChild;)a.removeChild(b);for(c=this.getChildNodes(c.firstChild.firstChild);c.length;)a.appendChild(c.shift())}else a.innerHTML=b},getChildNodes:function(b){b=b.children;for(var a=[],c=0,d=b.length;c<d;c++)a.push(b[c]);return a},checkChanges:function(b,a,c){var d=a!=c[b];c[b]=a;return d}};return p});","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\nfrappe.views.ReportFactory = class ReportFactory extends frappe.views.Factory {\n\tmake(route) {\n\t\tconst _route = ['List', route[1], 'Report'];\n\n\t\tif (route[2]) {\n\t\t\t// custom report\n\t\t\t_route.push(route[2]);\n\t\t}\n\n\t\tfrappe.set_route(_route);\n\t}\n}\n","/**!\n * Sortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @license MIT\n */\n\n(function sortableModule(factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"Sortable\"] = factory();\n\t}\n})(function sortableFactory() {\n\t\"use strict\";\n\n\tif (typeof window === \"undefined\" || !window.document) {\n\t\treturn function sortableError() {\n\t\t\tthrow new Error(\"Sortable.js requires a window with a document\");\n\t\t};\n\t}\n\n\tvar dragEl,\n\t\tparentEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tnextEl,\n\t\tlastDownEl,\n\n\t\tscrollEl,\n\t\tscrollParentEl,\n\t\tscrollCustomFn,\n\n\t\tlastEl,\n\t\tlastCSS,\n\t\tlastParentCSS,\n\n\t\toldIndex,\n\t\tnewIndex,\n\n\t\tactiveGroup,\n\t\tputSortable,\n\n\t\tautoScroll = {},\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\tmoved,\n\n\t\t/** @const */\n\t\tR_SPACE = /\\s+/g,\n\t\tR_FLOAT = /left|right|inline/,\n\n\t\texpando = 'Sortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\t\tsetTimeout = win.setTimeout,\n\n\t\t$ = win.jQuery || win.Zepto,\n\t\tPolymer = win.Polymer,\n\n\t\tcaptureMode = false,\n\t\tpassiveMode = false,\n\n\t\tsupportDraggable = ('draggable' in document.createElement('div')),\n\t\tsupportCssPointerEvents = (function (el) {\n\t\t\t// false when IE11\n\t\t\tif (!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\\.|msie)/i)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tel = document.createElement('x');\n\t\t\tel.style.cssText = 'pointer-events:auto';\n\t\t\treturn el.style.pointerEvents === 'auto';\n\t\t})(),\n\n\t\t_silent = false,\n\n\t\tabs = Math.abs,\n\t\tmin = Math.min,\n\n\t\tsavedInputChecked = [],\n\t\ttouchDragOverListeners = [],\n\n\t\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (rootEl && options.scroll) {\n\t\t\t\tvar _this = rootEl[expando],\n\t\t\t\t\tel,\n\t\t\t\t\trect,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinWidth = window.innerWidth,\n\t\t\t\t\twinHeight = window.innerHeight,\n\n\t\t\t\t\tvx,\n\t\t\t\t\tvy,\n\n\t\t\t\t\tscrollOffsetX,\n\t\t\t\t\tscrollOffsetY\n\t\t\t\t;\n\n\t\t\t\t// Delect scrollEl\n\t\t\t\tif (scrollParentEl !== rootEl) {\n\t\t\t\t\tscrollEl = options.scroll;\n\t\t\t\t\tscrollParentEl = rootEl;\n\t\t\t\t\tscrollCustomFn = options.scrollFn;\n\n\t\t\t\t\tif (scrollEl === true) {\n\t\t\t\t\t\tscrollEl = rootEl;\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif ((scrollEl.offsetWidth < scrollEl.scrollWidth) ||\n\t\t\t\t\t\t\t\t(scrollEl.offsetHeight < scrollEl.scrollHeight)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\t\t} while (scrollEl = scrollEl.parentNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (scrollEl) {\n\t\t\t\t\tel = scrollEl;\n\t\t\t\t\trect = scrollEl.getBoundingClientRect();\n\t\t\t\t\tvx = (abs(rect.right - x) <= sens) - (abs(rect.left - x) <= sens);\n\t\t\t\t\tvy = (abs(rect.bottom - y) <= sens) - (abs(rect.top - y) <= sens);\n\t\t\t\t}\n\n\n\t\t\t\tif (!(vx || vy)) {\n\t\t\t\t\tvx = (winWidth - x <= sens) - (x <= sens);\n\t\t\t\t\tvy = (winHeight - y <= sens) - (y <= sens);\n\n\t\t\t\t\t/* jshint expr:true */\n\t\t\t\t\t(vx || vy) && (el = win);\n\t\t\t\t}\n\n\n\t\t\t\tif (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !== el) {\n\t\t\t\t\tautoScroll.el = el;\n\t\t\t\t\tautoScroll.vx = vx;\n\t\t\t\t\tautoScroll.vy = vy;\n\n\t\t\t\t\tclearInterval(autoScroll.pid);\n\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tautoScroll.pid = setInterval(function () {\n\t\t\t\t\t\t\tscrollOffsetY = vy ? vy * speed : 0;\n\t\t\t\t\t\t\tscrollOffsetX = vx ? vx * speed : 0;\n\n\t\t\t\t\t\t\tif ('function' === typeof(scrollCustomFn)) {\n\t\t\t\t\t\t\t\treturn scrollCustomFn.call(_this, scrollOffsetX, scrollOffsetY, evt);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (el === win) {\n\t\t\t\t\t\t\t\twin.scrollTo(win.pageXOffset + scrollOffsetX, win.pageYOffset + scrollOffsetY);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tel.scrollTop += scrollOffsetY;\n\t\t\t\t\t\t\t\tel.scrollLeft += scrollOffsetX;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 24);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 30),\n\n\t\t_prepareGroup = function (options) {\n\t\t\tfunction toFn(value, pull) {\n\t\t\t\tif (value === void 0 || value === true) {\n\t\t\t\t\tvalue = group.name;\n\t\t\t\t}\n\n\t\t\t\tif (typeof value === 'function') {\n\t\t\t\t\treturn value;\n\t\t\t\t} else {\n\t\t\t\t\treturn function (to, from) {\n\t\t\t\t\t\tvar fromGroup = from.options.group.name;\n\n\t\t\t\t\t\treturn pull\n\t\t\t\t\t\t\t? value\n\t\t\t\t\t\t\t: value && (value.join\n\t\t\t\t\t\t\t\t? value.indexOf(fromGroup) > -1\n\t\t\t\t\t\t\t\t: (fromGroup == value)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar group = {};\n\t\t\tvar originalGroup = options.group;\n\n\t\t\tif (!originalGroup || typeof originalGroup != 'object') {\n\t\t\t\toriginalGroup = {name: originalGroup};\n\t\t\t}\n\n\t\t\tgroup.name = originalGroup.name;\n\t\t\tgroup.checkPull = toFn(originalGroup.pull, true);\n\t\t\tgroup.checkPut = toFn(originalGroup.put);\n\t\t\tgroup.revertClone = originalGroup.revertClone;\n\n\t\t\toptions.group = group;\n\t\t}\n\t;\n\n\t// Detect support a passive mode\n\ttry {\n\t\twindow.addEventListener('test', null, Object.defineProperty({}, 'passive', {\n\t\t\tget: function () {\n\t\t\t\t// `false`, because everything starts to work incorrectly and instead of d'n'd,\n\t\t\t\t// begins the page has scrolled.\n\t\t\t\tpassiveMode = false;\n\t\t\t\tcaptureMode = {\n\t\t\t\t\tcapture: false,\n\t\t\t\t\tpassive: passiveMode\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t} catch (err) {}\n\n\t/**\n\t * @class  Sortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction Sortable(el, options) {\n\t\tif (!(el && el.nodeType && el.nodeType === 1)) {\n\t\t\tthrow 'Sortable: `el` must be HTMLElement, and not ' + {}.toString.call(el);\n\t\t}\n\n\t\tthis.el = el; // root element\n\t\tthis.options = options = _extend({}, options);\n\n\n\t\t// Export instance\n\t\tel[expando] = this;\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: Math.random(),\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? 'li' : '>*',\n\t\t\tghostClass: 'sortable-ghost',\n\t\t\tchosenClass: 'sortable-chosen',\n\t\t\tdragClass: 'sortable-drag',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tpreventOnFilter: true,\n\t\t\tanimation: 0,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false,\n\t\t\tdataIdAttr: 'data-id',\n\t\t\tdelay: 0,\n\t\t\tforceFallback: false,\n\t\t\tfallbackClass: 'sortable-fallback',\n\t\t\tfallbackOnBody: false,\n\t\t\tfallbackTolerance: 0,\n\t\t\tfallbackOffset: {x: 0, y: 0},\n\t\t\tsupportPointer: Sortable.supportPointer !== false\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\t\t_prepareGroup(options);\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n\t\t\t\tthis[fn] = this[fn].bind(this);\n\t\t\t}\n\t\t}\n\n\t\t// Setup drag mode\n\t\tthis.nativeDraggable = options.forceFallback ? false : supportDraggable;\n\n\t\t// Bind events\n\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t_on(el, 'touchstart', this._onTapStart);\n\t\toptions.supportPointer && _on(el, 'pointerdown', this._onTapStart);\n\n\t\tif (this.nativeDraggable) {\n\t\t\t_on(el, 'dragover', this);\n\t\t\t_on(el, 'dragenter', this);\n\t\t}\n\n\t\ttouchDragOverListeners.push(this._onDragOver);\n\n\t\t// Restore sorting\n\t\toptions.store && this.sort(options.store.get(this));\n\t}\n\n\n\tSortable.prototype = /** @lends Sortable.prototype */ {\n\t\tconstructor: Sortable,\n\n\t\t_onTapStart: function (/** Event|TouchEvent */evt) {\n\t\t\tvar _this = this,\n\t\t\t\tel = this.el,\n\t\t\t\toptions = this.options,\n\t\t\t\tpreventOnFilter = options.preventOnFilter,\n\t\t\t\ttype = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = evt.target.shadowRoot && (evt.path && evt.path[0]) || target,\n\t\t\t\tfilter = options.filter,\n\t\t\t\tstartIndex;\n\n\t\t\t_saveInputCheckedState(el);\n\n\n\t\t\t// Don't trigger start event when an element is been dragged, otherwise the evt.oldindex always wrong when set option.group.\n\t\t\tif (dragEl) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button or enabled\n\t\t\t}\n\n\t\t\t// cancel dnd if original target is content editable\n\t\t\tif (originalTarget.isContentEditable) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttarget = _closest(target, options.draggable, el);\n\n\t\t\tif (!target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (lastDownEl === target) {\n\t\t\t\t// Ignoring duplicate `down`\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get the index of the dragged element within its parent\n\t\t\tstartIndex = _index(target, options.draggable);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(_this, originalTarget, 'filter', target, el, el, startIndex);\n\t\t\t\t\tpreventOnFilter && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(_this, criteria, 'filter', target, el, el, startIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tpreventOnFilter && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.handle && !_closest(originalTarget, options.handle, el)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Prepare `dragstart`\n\t\t\tthis._prepareDragStart(evt, touch, target, startIndex);\n\t\t},\n\n\t\t_prepareDragStart: function (/** Event */evt, /** Touch */touch, /** HTMLElement */target, /** Number */startIndex) {\n\t\t\tvar _this = this,\n\t\t\t\tel = _this.el,\n\t\t\t\toptions = _this.options,\n\t\t\t\townerDocument = el.ownerDocument,\n\t\t\t\tdragStartFn;\n\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\ttapEvt = evt;\n\n\t\t\t\trootEl = el;\n\t\t\t\tdragEl = target;\n\t\t\t\tparentEl = dragEl.parentNode;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tlastDownEl = target;\n\t\t\t\tactiveGroup = options.group;\n\t\t\t\toldIndex = startIndex;\n\n\t\t\t\tthis._lastX = (touch || evt).clientX;\n\t\t\t\tthis._lastY = (touch || evt).clientY;\n\n\t\t\t\tdragEl.style['will-change'] = 'all';\n\n\t\t\t\tdragStartFn = function () {\n\t\t\t\t\t// Delayed drag has been triggered\n\t\t\t\t\t// we can re-enable the events: touchmove/mousemove\n\t\t\t\t\t_this._disableDelayedDrag();\n\n\t\t\t\t\t// Make the element draggable\n\t\t\t\t\tdragEl.draggable = _this.nativeDraggable;\n\n\t\t\t\t\t// Chosen item\n\t\t\t\t\t_toggleClass(dragEl, options.chosenClass, true);\n\n\t\t\t\t\t// Bind the events: dragstart/dragend\n\t\t\t\t\t_this._triggerDragStart(evt, touch);\n\n\t\t\t\t\t// Drag start event\n\t\t\t\t\t_dispatchEvent(_this, rootEl, 'choose', dragEl, rootEl, rootEl, oldIndex);\n\t\t\t\t};\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(dragEl, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\t_on(ownerDocument, 'mouseup', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchend', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchcancel', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'selectstart', _this);\n\t\t\t\toptions.supportPointer && _on(ownerDocument, 'pointercancel', _this._onDrop);\n\n\t\t\t\tif (options.delay) {\n\t\t\t\t\t// If the user moves the pointer or let go the click or touch\n\t\t\t\t\t// before the delay has been reached:\n\t\t\t\t\t// disable the delayed drag\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'mousemove', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchmove', _this._disableDelayedDrag);\n\t\t\t\t\toptions.supportPointer && _on(ownerDocument, 'pointermove', _this._disableDelayedDrag);\n\n\t\t\t\t\t_this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n\t\t\t\t} else {\n\t\t\t\t\tdragStartFn();\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t},\n\n\t\t_disableDelayedDrag: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\t\t\t_off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchend', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'mousemove', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchmove', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'pointermove', this._disableDelayedDrag);\n\t\t},\n\n\t\t_triggerDragStart: function (/** Event */evt, /** Touch */touch) {\n\t\t\ttouch = touch || (evt.pointerType == 'touch' ? evt : null);\n\n\t\t\tif (touch) {\n\t\t\t\t// Touch device support\n\t\t\t\ttapEvt = {\n\t\t\t\t\ttarget: dragEl,\n\t\t\t\t\tclientX: touch.clientX,\n\t\t\t\t\tclientY: touch.clientY\n\t\t\t\t};\n\n\t\t\t\tthis._onDragStart(tapEvt, 'touch');\n\t\t\t}\n\t\t\telse if (!this.nativeDraggable) {\n\t\t\t\tthis._onDragStart(tapEvt, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\t// Timeout neccessary for IE9\n\t\t\t\t\t_nextTick(function () {\n\t\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t},\n\n\t\t_dragStarted: function () {\n\t\t\tif (rootEl && dragEl) {\n\t\t\t\tvar options = this.options;\n\n\t\t\t\t// Apply effect\n\t\t\t\t_toggleClass(dragEl, options.ghostClass, true);\n\t\t\t\t_toggleClass(dragEl, options.dragClass, false);\n\n\t\t\t\tSortable.active = this;\n\n\t\t\t\t// Drag start event\n\t\t\t\t_dispatchEvent(this, rootEl, 'start', dragEl, rootEl, rootEl, oldIndex);\n\t\t\t} else {\n\t\t\t\tthis._nulling();\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function () {\n\t\t\tif (touchEvt) {\n\t\t\t\tif (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._lastX = touchEvt.clientX;\n\t\t\t\tthis._lastY = touchEvt.clientY;\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', 'none');\n\t\t\t\t}\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n\t\t\t\tvar parent = target;\n\t\t\t\tvar i = touchDragOverListeners.length;\n\n\t\t\t\tif (target && target.shadowRoot) {\n\t\t\t\t\ttarget = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n\t\t\t\t\tparent = target;\n\t\t\t\t}\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (parent[expando]) {\n\t\t\t\t\t\t\twhile (i--) {\n\t\t\t\t\t\t\t\ttouchDragOverListeners[i]({\n\t\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt) {\n\t\t\tif (tapEvt) {\n\t\t\t\tvar\toptions = this.options,\n\t\t\t\t\tfallbackTolerance = options.fallbackTolerance,\n\t\t\t\t\tfallbackOffset = options.fallbackOffset,\n\t\t\t\t\ttouch = evt.touches ? evt.touches[0] : evt,\n\t\t\t\t\tdx = (touch.clientX - tapEvt.clientX) + fallbackOffset.x,\n\t\t\t\t\tdy = (touch.clientY - tapEvt.clientY) + fallbackOffset.y,\n\t\t\t\t\ttranslate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';\n\n\t\t\t\t// only set the status to dragging, when we are actually dragging\n\t\t\t\tif (!Sortable.active) {\n\t\t\t\t\tif (fallbackTolerance &&\n\t\t\t\t\t\tmin(abs(touch.clientX - this._lastX), abs(touch.clientY - this._lastY)) < fallbackTolerance\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._dragStarted();\n\t\t\t\t}\n\n\t\t\t\t// as well as creating the ghost element on the document body\n\t\t\t\tthis._appendGhost();\n\n\t\t\t\tmoved = true;\n\t\t\t\ttouchEvt = touch;\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_appendGhost: function () {\n\t\t\tif (!ghostEl) {\n\t\t\t\tvar rect = dragEl.getBoundingClientRect(),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\toptions = this.options,\n\t\t\t\t\tghostRect;\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_toggleClass(ghostEl, options.ghostClass, false);\n\t\t\t\t_toggleClass(ghostEl, options.fallbackClass, true);\n\t\t\t\t_toggleClass(ghostEl, options.dragClass, true);\n\n\t\t\t\t_css(ghostEl, 'top', rect.top - parseInt(css.marginTop, 10));\n\t\t\t\t_css(ghostEl, 'left', rect.left - parseInt(css.marginLeft, 10));\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', 'fixed');\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\t\t\t\t_css(ghostEl, 'pointerEvents', 'none');\n\n\t\t\t\toptions.fallbackOnBody && document.body.appendChild(ghostEl) || rootEl.appendChild(ghostEl);\n\n\t\t\t\t// Fixing dimensions.\n\t\t\t\tghostRect = ghostEl.getBoundingClientRect();\n\t\t\t\t_css(ghostEl, 'width', rect.width * 2 - ghostRect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height * 2 - ghostRect.height);\n\t\t\t}\n\t\t},\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/useFallback) {\n\t\t\tvar _this = this;\n\t\t\tvar dataTransfer = evt.dataTransfer;\n\t\t\tvar options = _this.options;\n\n\t\t\t_this._offUpEvents();\n\n\t\t\tif (activeGroup.checkPull(_this, _this, dragEl, evt)) {\n\t\t\t\tcloneEl = _clone(dragEl);\n\n\t\t\t\tcloneEl.draggable = false;\n\t\t\t\tcloneEl.style['will-change'] = '';\n\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\t_toggleClass(cloneEl, _this.options.chosenClass, false);\n\n\t\t\t\t// #1143: IFrame support workaround\n\t\t\t\t_this._cloneId = _nextTick(function () {\n\t\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t\t_dispatchEvent(_this, rootEl, 'clone', dragEl);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t_toggleClass(dragEl, options.dragClass, true);\n\n\t\t\tif (useFallback) {\n\t\t\t\tif (useFallback === 'touch') {\n\t\t\t\t\t// Bind touch events\n\t\t\t\t\t_on(document, 'touchmove', _this._onTouchMove);\n\t\t\t\t\t_on(document, 'touchend', _this._onDrop);\n\t\t\t\t\t_on(document, 'touchcancel', _this._onDrop);\n\n\t\t\t\t\tif (options.supportPointer) {\n\t\t\t\t\t\t_on(document, 'pointermove', _this._onTouchMove);\n\t\t\t\t\t\t_on(document, 'pointerup', _this._onDrop);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Old brwoser\n\t\t\t\t\t_on(document, 'mousemove', _this._onTouchMove);\n\t\t\t\t\t_on(document, 'mouseup', _this._onDrop);\n\t\t\t\t}\n\n\t\t\t\t_this._loopId = setInterval(_this._emulateDragOver, 50);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(_this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', _this);\n\n\t\t\t\t// #1143: Бывает элемент с IFrame внутри блокирует `drop`,\n\t\t\t\t// поэтому если вызвался `mouseover`, значит надо отменять весь d'n'd.\n\t\t\t\t// Breaking Chrome 62+\n\t\t\t\t// _on(document, 'mouseover', _this);\n\n\t\t\t\t_this._dragStartId = _nextTick(_this._dragStarted);\n\t\t\t}\n\t\t},\n\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget,\n\t\t\t\tdragRect,\n\t\t\t\ttargetRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tactiveSortable = Sortable.active,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tisMovingBetweenSortable = false,\n\t\t\t\tcanSort = options.sort;\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation();\n\t\t\t}\n\n\t\t\tif (dragEl.animated) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmoved = true;\n\n\t\t\tif (activeSortable && !options.disabled &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl)) // Reverting item into the original list\n\t\t\t\t\t: (\n\t\t\t\t\t\tputSortable === this ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(activeSortable.lastPullMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) &&\n\t\t\t\t\t\t\tgroup.checkPut(this, activeSortable, dragEl, evt)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t) &&\n\t\t\t\t(evt.rootEl === void 0 || evt.rootEl === this.el) // touch fallback\n\t\t\t) {\n\t\t\t\t// Smart auto-scrolling\n\t\t\t\t_autoScroll(evt, options, this.el);\n\n\t\t\t\tif (_silent) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttarget = _closest(evt.target, options.draggable, el);\n\t\t\t\tdragRect = dragEl.getBoundingClientRect();\n\n\t\t\t\tif (putSortable !== this) {\n\t\t\t\t\tputSortable = this;\n\t\t\t\t\tisMovingBetweenSortable = true;\n\t\t\t\t}\n\n\t\t\t\tif (revert) {\n\t\t\t\t\t_cloneHide(activeSortable, true);\n\t\t\t\t\tparentEl = rootEl; // actualization\n\n\t\t\t\t\tif (cloneEl || nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, cloneEl || nextEl);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!canSort) {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\n\t\t\t\tif ((el.children.length === 0) || (el.children[0] === ghostEl) ||\n\t\t\t\t\t(el === evt.target) && (_ghostIsLast(el, evt))\n\t\t\t\t) {\n\t\t\t\t\t//assign target only if condition is true\n\t\t\t\t\tif (el.children.length !== 0 && el.children[0] !== ghostEl && el === evt.target) {\n\t\t\t\t\t\ttarget = el.lastElementChild;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\tif (target.animated) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\t\t\t\t\t}\n\n\t\t\t\t\t_cloneHide(activeSortable, isOwner);\n\n\t\t\t\t\tif (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt) !== false) {\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\tparentEl = el; // actualization\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\ttarget && this._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target && !target.animated && target !== dragEl && (target.parentNode[expando] !== void 0)) {\n\t\t\t\t\tif (lastEl !== target) {\n\t\t\t\t\t\tlastEl = target;\n\t\t\t\t\t\tlastCSS = _css(target);\n\t\t\t\t\t\tlastParentCSS = _css(target.parentNode);\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\n\t\t\t\t\tvar width = targetRect.right - targetRect.left,\n\t\t\t\t\t\theight = targetRect.bottom - targetRect.top,\n\t\t\t\t\t\tfloating = R_FLOAT.test(lastCSS.cssFloat + lastCSS.display)\n\t\t\t\t\t\t\t|| (lastParentCSS.display == 'flex' && lastParentCSS['flex-direction'].indexOf('row') === 0),\n\t\t\t\t\t\tisWide = (target.offsetWidth > dragEl.offsetWidth),\n\t\t\t\t\t\tisLong = (target.offsetHeight > dragEl.offsetHeight),\n\t\t\t\t\t\thalfway = (floating ? (evt.clientX - targetRect.left) / width : (evt.clientY - targetRect.top) / height) > 0.5,\n\t\t\t\t\t\tnextSibling = target.nextElementSibling,\n\t\t\t\t\t\tafter = false\n\t\t\t\t\t;\n\n\t\t\t\t\tif (floating) {\n\t\t\t\t\t\tvar elTop = dragEl.offsetTop,\n\t\t\t\t\t\t\ttgTop = target.offsetTop;\n\n\t\t\t\t\t\tif (elTop === tgTop) {\n\t\t\t\t\t\t\tafter = (target.previousElementSibling === dragEl) && !isWide || halfway && isWide;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (target.previousElementSibling === dragEl || dragEl.previousElementSibling === target) {\n\t\t\t\t\t\t\tafter = (evt.clientY - targetRect.top) / height > 0.5;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tafter = tgTop > elTop;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (!isMovingBetweenSortable) {\n\t\t\t\t\t\tafter = (nextSibling !== dragEl) && !isLong || halfway && isLong;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);\n\n\t\t\t\t\tif (moveVector !== false) {\n\t\t\t\t\t\tif (moveVector === 1 || moveVector === -1) {\n\t\t\t\t\t\t\tafter = (moveVector === 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_silent = true;\n\t\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t\t_cloneHide(activeSortable, isOwner);\n\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparentEl = dragEl.parentNode; // actualization\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\tthis._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = target.getBoundingClientRect();\n\n\t\t\t\tif (prevRect.nodeType === 1) {\n\t\t\t\t\tprevRect = prevRect.getBoundingClientRect();\n\t\t\t\t}\n\n\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t+ (prevRect.left - currentRect.left) + 'px,'\n\t\t\t\t\t+ (prevRect.top - currentRect.top) + 'px,0)'\n\t\t\t\t);\n\n\t\t\t\ttarget.offsetWidth; // repaint\n\n\t\t\t\t_css(target, 'transition', 'all ' + ms + 'ms');\n\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\n\t\t\t\tclearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\t_css(target, 'transform', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(document, 'pointermove', this._onTouchMove);\n\t\t\t_off(ownerDocument, 'mouseup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchend', this._onDrop);\n\t\t\t_off(ownerDocument, 'pointerup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchcancel', this._onDrop);\n\t\t\t_off(ownerDocument, 'pointercancel', this._onDrop);\n\t\t\t_off(ownerDocument, 'selectstart', this);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\n\t\t\tclearInterval(this._loopId);\n\t\t\tclearInterval(autoScroll.pid);\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\t_cancelNextTick(this._cloneId);\n\t\t\t_cancelNextTick(this._dragStartId);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'mouseover', this);\n\t\t\t_off(document, 'mousemove', this._onTouchMove);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(document, 'drop', this);\n\t\t\t\t_off(el, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tif (moved) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (rootEl === parentEl || Sortable.active.lastPullMode !== 'clone') {\n\t\t\t\t\t// Remove clone\n\t\t\t\t\tcloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);\n\t\t\t\t}\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t\t_off(dragEl, 'dragend', this);\n\t\t\t\t\t}\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\t\t\t\t\tdragEl.style['will-change'] = '';\n\n\t\t\t\t\t// Remove class's\n\t\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, this.options.chosenClass, false);\n\n\t\t\t\t\t// Drag stop event\n\t\t\t\t\t_dispatchEvent(this, rootEl, 'unchoose', dragEl, parentEl, rootEl, oldIndex);\n\n\t\t\t\t\tif (rootEl !== parentEl) {\n\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'add', dragEl, parentEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'remove', dragEl, parentEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'update', dragEl, parentEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, parentEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Sortable.active) {\n\t\t\t\t\t\t/* jshint eqnull:true */\n\t\t\t\t\t\tif (newIndex == null || newIndex === -1) {\n\t\t\t\t\t\t\tnewIndex = oldIndex;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'end', dragEl, parentEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t// Save sorting\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._nulling();\n\t\t},\n\n\t\t_nulling: function() {\n\t\t\trootEl =\n\t\t\tdragEl =\n\t\t\tparentEl =\n\t\t\tghostEl =\n\t\t\tnextEl =\n\t\t\tcloneEl =\n\t\t\tlastDownEl =\n\n\t\t\tscrollEl =\n\t\t\tscrollParentEl =\n\n\t\t\ttapEvt =\n\t\t\ttouchEvt =\n\n\t\t\tmoved =\n\t\t\tnewIndex =\n\n\t\t\tlastEl =\n\t\t\tlastCSS =\n\n\t\t\tputSortable =\n\t\t\tactiveGroup =\n\t\t\tSortable.active = null;\n\n\t\t\tsavedInputChecked.forEach(function (el) {\n\t\t\t\tel.checked = true;\n\t\t\t});\n\t\t\tsavedInputChecked.length = 0;\n\t\t},\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tswitch (evt.type) {\n\t\t\t\tcase 'drop':\n\t\t\t\tcase 'dragend':\n\t\t\t\t\tthis._onDrop(evt);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'dragover':\n\t\t\t\tcase 'dragenter':\n\t\t\t\t\tif (dragEl) {\n\t\t\t\t\t\tthis._onDragOver(evt);\n\t\t\t\t\t\t_globalDragOver(evt);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mouseover':\n\t\t\t\t\tthis._onDrop(evt);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'selectstart':\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length,\n\t\t\t\toptions = this.options;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, options.draggable, this.el)) {\n\t\t\t\t\torder.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\n\t\t\t\tif (name === 'group') {\n\t\t\t\t\t_prepareGroup(options);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el;\n\n\t\t\tel[expando] = null;\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\t\t\t_off(el, 'pointerdown', this._onTapStart);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(el, 'dragover', this);\n\t\t\t\t_off(el, 'dragenter', this);\n\t\t\t}\n\n\t\t\t// Remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\ttouchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver), 1);\n\n\t\t\tthis._onDrop();\n\n\t\t\tthis.el = el = null;\n\t\t}\n\t};\n\n\n\tfunction _cloneHide(sortable, state) {\n\t\tif (sortable.lastPullMode !== 'clone') {\n\t\t\tstate = true;\n\t\t}\n\n\t\tif (cloneEl && (cloneEl.state !== state)) {\n\t\t\t_css(cloneEl, 'display', state ? 'none' : '');\n\n\t\t\tif (!state) {\n\t\t\t\tif (cloneEl.state) {\n\t\t\t\t\tif (sortable.options.group.revertClone) {\n\t\t\t\t\t\trootEl.insertBefore(cloneEl, nextEl);\n\t\t\t\t\t\tsortable._animate(dragEl, cloneEl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcloneEl.state = state;\n\t\t}\n\t}\n\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\n\t\t\tdo {\n\t\t\t\tif ((selector === '>*' && el.parentNode === ctx) || _matches(el, selector)) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\t\t\t\t/* jshint boss:true */\n\t\t\t} while (el = _getParentOrHost(el));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _getParentOrHost(el) {\n\t\tvar parent = el.host;\n\n\t\treturn (parent && parent.nodeType) ? parent : el.parentNode;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tif (evt.dataTransfer) {\n\t\t\tevt.dataTransfer.dropEffect = 'move';\n\t\t}\n\t\tevt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, captureMode);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, captureMode);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(R_SPACE, ' ').replace(' ' + name + ' ', ' ');\n\t\t\t\tel.className = (className + (state ? ' ' + name : '')).replace(R_SPACE, ' ');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style)) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\n\tfunction _dispatchEvent(sortable, rootEl, name, targetEl, toEl, fromEl, startIndex, newIndex) {\n\t\tsortable = (sortable || rootEl[expando]);\n\n\t\tvar evt = document.createEvent('Event'),\n\t\t\toptions = sortable.options,\n\t\t\tonName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n\n\t\tevt.initEvent(name, true, true);\n\n\t\tevt.to = toEl || rootEl;\n\t\tevt.from = fromEl || rootEl;\n\t\tevt.item = targetEl || rootEl;\n\t\tevt.clone = cloneEl;\n\n\t\tevt.oldIndex = startIndex;\n\t\tevt.newIndex = newIndex;\n\n\t\trootEl.dispatchEvent(evt);\n\n\t\tif (options[onName]) {\n\t\t\toptions[onName].call(sortable, evt);\n\t\t}\n\t}\n\n\n\tfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect, originalEvt, willInsertAfter) {\n\t\tvar evt,\n\t\t\tsortable = fromEl[expando],\n\t\t\tonMoveFn = sortable.options.onMove,\n\t\t\tretVal;\n\n\t\tevt = document.createEvent('Event');\n\t\tevt.initEvent('move', true, true);\n\n\t\tevt.to = toEl;\n\t\tevt.from = fromEl;\n\t\tevt.dragged = dragEl;\n\t\tevt.draggedRect = dragRect;\n\t\tevt.related = targetEl || toEl;\n\t\tevt.relatedRect = targetRect || toEl.getBoundingClientRect();\n\t\tevt.willInsertAfter = willInsertAfter;\n\n\t\tfromEl.dispatchEvent(evt);\n\n\t\tif (onMoveFn) {\n\t\t\tretVal = onMoveFn.call(sortable, evt, originalEvt);\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\n\t/** @returns {HTMLElement|false} */\n\tfunction _ghostIsLast(el, evt) {\n\t\tvar lastEl = el.lastElementChild,\n\t\t\trect = lastEl.getBoundingClientRect();\n\n\t\t// 5 — min delta\n\t\t// abs — нельзя добавлять, а то глюки при наведении сверху\n\t\treturn (evt.clientY - (rect.top + rect.height) > 5) ||\n\t\t\t(evt.clientX - (rect.left + rect.width) > 5);\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent for a selected set of\n\t * elements\n\t * @param  {HTMLElement} el\n\t * @param  {selector} selector\n\t * @return {number}\n\t */\n\tfunction _index(el, selector) {\n\t\tvar index = 0;\n\n\t\tif (!el || !el.parentNode) {\n\t\t\treturn -1;\n\t\t}\n\n\t\twhile (el && (el = el.previousElementSibling)) {\n\t\t\tif ((el.nodeName.toUpperCase() !== 'TEMPLATE') && (selector === '>*' || _matches(el, selector))) {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tfunction _matches(/**HTMLElement*/el, /**String*/selector) {\n\t\tif (el) {\n\t\t\tselector = selector.split('.');\n\n\t\t\tvar tag = selector.shift().toUpperCase(),\n\t\t\t\tre = new RegExp('\\\\s(' + selector.join('|') + ')(?=\\\\s)', 'g');\n\n\t\t\treturn (\n\t\t\t\t(tag === '' || el.nodeName.toUpperCase() == tag) &&\n\t\t\t\t(!selector.length || ((' ' + el.className + ' ').match(re) || []).length == selector.length)\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfunction _throttle(callback, ms) {\n\t\tvar args, _this;\n\n\t\treturn function () {\n\t\t\tif (args === void 0) {\n\t\t\t\targs = arguments;\n\t\t\t\t_this = this;\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\targs = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction _extend(dst, src) {\n\t\tif (dst && src) {\n\t\t\tfor (var key in src) {\n\t\t\t\tif (src.hasOwnProperty(key)) {\n\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dst;\n\t}\n\n\tfunction _clone(el) {\n\t\tif (Polymer && Polymer.dom) {\n\t\t\treturn Polymer.dom(el).cloneNode(true);\n\t\t}\n\t\telse if ($) {\n\t\t\treturn $(el).clone(true)[0];\n\t\t}\n\t\telse {\n\t\t\treturn el.cloneNode(true);\n\t\t}\n\t}\n\n\tfunction _saveInputCheckedState(root) {\n\t\tvar inputs = root.getElementsByTagName('input');\n\t\tvar idx = inputs.length;\n\n\t\twhile (idx--) {\n\t\t\tvar el = inputs[idx];\n\t\t\tel.checked && savedInputChecked.push(el);\n\t\t}\n\t}\n\n\tfunction _nextTick(fn) {\n\t\treturn setTimeout(fn, 0);\n\t}\n\n\tfunction _cancelNextTick(id) {\n\t\treturn clearTimeout(id);\n\t}\n\n\t// Fixed #973:\n\t_on(document, 'touchmove', function (evt) {\n\t\tif (Sortable.active) {\n\t\t\tevt.preventDefault();\n\t\t}\n\t});\n\n\t// Export utils\n\tSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el);\n\t\t},\n\t\textend: _extend,\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tclone: _clone,\n\t\tindex: _index,\n\t\tnextTick: _nextTick,\n\t\tcancelNextTick: _cancelNextTick\n\t};\n\n\n\t/**\n\t * Create sortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tSortable.create = function (el, options) {\n\t\treturn new Sortable(el, options);\n\t};\n\n\n\t// Export\n\tSortable.version = '1.7.0';\n\treturn Sortable;\n});\n","'use strict';\n\nfunction _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }\n\nvar Sortable = _interopDefault(require('sortablejs'));\n\nfunction $(expr, con) {\n    return typeof expr === 'string' ?\n        (con || document).querySelector(expr) :\n        expr || null;\n}\n\n$.each = (expr, con) => {\n    return typeof expr === 'string' ?\n        Array.from((con || document).querySelectorAll(expr)) :\n        expr || null;\n};\n\n$.create = (tag, o) => {\n    let element = document.createElement(tag);\n\n    for (let i in o) {\n        let val = o[i];\n\n        if (i === 'inside') {\n            $(val).appendChild(element);\n        } else\n        if (i === 'around') {\n            let ref = $(val);\n            ref.parentNode.insertBefore(element, ref);\n            element.appendChild(ref);\n        } else\n        if (i === 'styles') {\n            if (typeof val === 'object') {\n                Object.keys(val).map(prop => {\n                    element.style[prop] = val[prop];\n                });\n            }\n        } else\n        if (i in element) {\n            element[i] = val;\n        } else {\n            element.setAttribute(i, val);\n        }\n    }\n\n    return element;\n};\n\n$.on = (element, event, selector, callback) => {\n    if (!callback) {\n        callback = selector;\n        $.bind(element, event, callback);\n    } else {\n        $.delegate(element, event, selector, callback);\n    }\n};\n\n$.off = (element, event, handler) => {\n    element.removeEventListener(event, handler);\n};\n\n$.bind = (element, event, callback) => {\n    event.split(/\\s+/).forEach(function (event) {\n        element.addEventListener(event, callback);\n    });\n};\n\n$.delegate = (element, event, selector, callback) => {\n    element.addEventListener(event, function (e) {\n        const delegatedTarget = e.target.closest(selector);\n        if (delegatedTarget) {\n            e.delegatedTarget = delegatedTarget;\n            callback.call(this, e, delegatedTarget);\n        }\n    });\n};\n\n$.unbind = (element, o) => {\n    if (element) {\n        for (let event in o) {\n            let callback = o[event];\n\n            event.split(/\\s+/).forEach(function (event) {\n                element.removeEventListener(event, callback);\n            });\n        }\n    }\n};\n\n$.fire = (target, type, properties) => {\n    let evt = document.createEvent('HTMLEvents');\n\n    evt.initEvent(type, true, true);\n\n    for (let j in properties) {\n        evt[j] = properties[j];\n    }\n\n    return target.dispatchEvent(evt);\n};\n\n$.data = (element, attrs) => { // eslint-disable-line\n    if (!attrs) {\n        return element.dataset;\n    }\n\n    for (const attr in attrs) {\n        element.dataset[attr] = attrs[attr];\n    }\n};\n\n$.style = (elements, styleMap) => { // eslint-disable-line\n\n    if (typeof styleMap === 'string') {\n        return $.getStyle(elements, styleMap);\n    }\n\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    elements.map(element => {\n        for (const prop in styleMap) {\n            element.style[prop] = styleMap[prop];\n        }\n    });\n};\n\n$.removeStyle = (elements, styleProps) => {\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    if (!Array.isArray(styleProps)) {\n        styleProps = [styleProps];\n    }\n\n    elements.map(element => {\n        for (const prop of styleProps) {\n            element.style[prop] = '';\n        }\n    });\n};\n\n$.getStyle = (element, prop) => {\n    if (!prop) {\n        return getComputedStyle(element);\n    }\n\n    let val = getComputedStyle(element)[prop];\n\n    if (['width', 'height'].includes(prop)) {\n        val = parseFloat(val);\n    }\n\n    return val;\n};\n\n$.closest = (selector, element) => {\n    if (!element) return null;\n\n    if (element.matches(selector)) {\n        return element;\n    }\n\n    return $.closest(selector, element.parentNode);\n};\n\n$.inViewport = (el, parentEl) => {\n    const {\n        top,\n        left,\n        bottom,\n        right\n    } = el.getBoundingClientRect();\n    const {\n        top: pTop,\n        left: pLeft,\n        bottom: pBottom,\n        right: pRight\n    } = parentEl.getBoundingClientRect();\n\n    return top >= pTop && left >= pLeft && bottom <= pBottom && right <= pRight;\n};\n\n$.scrollTop = function scrollTop(element, pixels) {\n    requestAnimationFrame(() => {\n        element.scrollTop = pixels;\n    });\n};\n\n$.scrollbarSize = function scrollbarSize() {\n    if (!$.scrollBarSizeValue) {\n        $.scrollBarSizeValue = getScrollBarSize();\n    }\n    return $.scrollBarSizeValue;\n};\n\nfunction getScrollBarSize() {\n    // assume scrollbar width and height would be the same\n\n    // Create the measurement node\n    const scrollDiv = document.createElement('div');\n    $.style(scrollDiv, {\n        width: '100px',\n        height: '100px',\n        overflow: 'scroll',\n        position: 'absolute',\n        top: '-9999px'\n    });\n    document.body.appendChild(scrollDiv);\n\n    // Get the scrollbar width\n    const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n\n    // Delete the DIV\n    document.body.removeChild(scrollDiv);\n\n    return scrollbarWidth;\n}\n\n$.hasVerticalOverflow = function (element) {\n    return element.scrollHeight > element.offsetHeight + 10;\n};\n\n$.hasHorizontalOverflow = function (element) {\n    return element.scrollWidth > element.offsetWidth + 10;\n};\n\n$.measureTextWidth = function (text) {\n    const div = document.createElement('div');\n    div.style.position = 'absolute';\n    div.style.visibility = 'hidden';\n    div.style.height = 'auto';\n    div.style.width = 'auto';\n    div.style.whiteSpace = 'nowrap';\n    div.innerText = text;\n    document.body.appendChild(div);\n    return div.clientWidth + 1;\n};\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nvar isObject_1 = isObject;\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction commonjsRequire () {\n\tthrow new Error('Dynamic requires are not currently supported by rollup-plugin-commonjs');\n}\n\nfunction unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\n\nvar _freeGlobal = freeGlobal;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = _freeGlobal || freeSelf || Function('return this')();\n\nvar _root = root;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return _root.Date.now();\n};\n\nvar now_1 = now;\n\n/** Built-in value references. */\nvar Symbol = _root.Symbol;\n\nvar _Symbol = Symbol;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = _Symbol ? _Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nvar _getRawTag = getRawTag;\n\n/** Used for built-in method references. */\nvar objectProto$1 = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString$1 = objectProto$1.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString$1.call(value);\n}\n\nvar _objectToString = objectToString;\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag$1 = _Symbol ? _Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag$1 && symToStringTag$1 in Object(value))\n    ? _getRawTag(value)\n    : _objectToString(value);\n}\n\nvar _baseGetTag = baseGetTag;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nvar isObjectLike_1 = isObjectLike;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike_1(value) && _baseGetTag(value) == symbolTag);\n}\n\nvar isSymbol_1 = isSymbol;\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol_1(value)) {\n    return NAN;\n  }\n  if (isObject_1(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject_1(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nvar toNumber_1 = toNumber;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber_1(wait) || 0;\n  if (isObject_1(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber_1(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now_1();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now_1());\n  }\n\n  function debounced() {\n    var time = now_1(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nvar debounce_1 = debounce;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT$1 = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT$1);\n  }\n  if (isObject_1(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce_1(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nvar throttle_1 = throttle;\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject_1(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = _baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nvar isFunction_1 = isFunction;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = _root['__core-js_shared__'];\n\nvar _coreJsData = coreJsData;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(_coreJsData && _coreJsData.keys && _coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nvar _isMasked = isMasked;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nvar _toSource = toSource;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto$1 = Function.prototype,\n    objectProto$2 = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString$1 = funcProto$1.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$1 = objectProto$2.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject_1(value) || _isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction_1(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(_toSource(value));\n}\n\nvar _baseIsNative = baseIsNative;\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nvar _getValue = getValue;\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = _getValue(object, key);\n  return _baseIsNative(value) ? value : undefined;\n}\n\nvar _getNative = getNative;\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = _getNative(Object, 'create');\n\nvar _nativeCreate = nativeCreate;\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = _nativeCreate ? _nativeCreate(null) : {};\n  this.size = 0;\n}\n\nvar _hashClear = hashClear;\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nvar _hashDelete = hashDelete;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto$3 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$2 = objectProto$3.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (_nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty$2.call(data, key) ? data[key] : undefined;\n}\n\nvar _hashGet = hashGet;\n\n/** Used for built-in method references. */\nvar objectProto$4 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty$3 = objectProto$4.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return _nativeCreate ? (data[key] !== undefined) : hasOwnProperty$3.call(data, key);\n}\n\nvar _hashHas = hashHas;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED$1 = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (_nativeCreate && value === undefined) ? HASH_UNDEFINED$1 : value;\n  return this;\n}\n\nvar _hashSet = hashSet;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = _hashClear;\nHash.prototype['delete'] = _hashDelete;\nHash.prototype.get = _hashGet;\nHash.prototype.has = _hashHas;\nHash.prototype.set = _hashSet;\n\nvar _Hash = Hash;\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nvar _listCacheClear = listCacheClear;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nvar eq_1 = eq;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq_1(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nvar _assocIndexOf = assocIndexOf;\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nvar _listCacheDelete = listCacheDelete;\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nvar _listCacheGet = listCacheGet;\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return _assocIndexOf(this.__data__, key) > -1;\n}\n\nvar _listCacheHas = listCacheHas;\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = _assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nvar _listCacheSet = listCacheSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = _listCacheClear;\nListCache.prototype['delete'] = _listCacheDelete;\nListCache.prototype.get = _listCacheGet;\nListCache.prototype.has = _listCacheHas;\nListCache.prototype.set = _listCacheSet;\n\nvar _ListCache = ListCache;\n\n/* Built-in method references that are verified to be native. */\nvar Map = _getNative(_root, 'Map');\n\nvar _Map = Map;\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new _Hash,\n    'map': new (_Map || _ListCache),\n    'string': new _Hash\n  };\n}\n\nvar _mapCacheClear = mapCacheClear;\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nvar _isKeyable = isKeyable;\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return _isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nvar _getMapData = getMapData;\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = _getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nvar _mapCacheDelete = mapCacheDelete;\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return _getMapData(this, key).get(key);\n}\n\nvar _mapCacheGet = mapCacheGet;\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return _getMapData(this, key).has(key);\n}\n\nvar _mapCacheHas = mapCacheHas;\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = _getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nvar _mapCacheSet = mapCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = _mapCacheClear;\nMapCache.prototype['delete'] = _mapCacheDelete;\nMapCache.prototype.get = _mapCacheGet;\nMapCache.prototype.has = _mapCacheHas;\nMapCache.prototype.set = _mapCacheSet;\n\nvar _MapCache = MapCache;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED$2 = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED$2);\n  return this;\n}\n\nvar _setCacheAdd = setCacheAdd;\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nvar _setCacheHas = setCacheHas;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new _MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = _setCacheAdd;\nSetCache.prototype.has = _setCacheHas;\n\nvar _SetCache = SetCache;\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nvar _baseFindIndex = baseFindIndex;\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nvar _baseIsNaN = baseIsNaN;\n\n/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nvar _strictIndexOf = strictIndexOf;\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? _strictIndexOf(array, value, fromIndex)\n    : _baseFindIndex(array, _baseIsNaN, fromIndex);\n}\n\nvar _baseIndexOf = baseIndexOf;\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && _baseIndexOf(array, value, 0) > -1;\n}\n\nvar _arrayIncludes = arrayIncludes;\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nvar _arrayIncludesWith = arrayIncludesWith;\n\n/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nvar _cacheHas = cacheHas;\n\n/* Built-in method references that are verified to be native. */\nvar Set = _getNative(_root, 'Set');\n\nvar _Set = Set;\n\n/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nvar noop_1 = noop;\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nvar _setToArray = setToArray;\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(_Set && (1 / _setToArray(new _Set([,-0]))[1]) == INFINITY) ? noop_1 : function(values) {\n  return new _Set(values);\n};\n\nvar _createSet = createSet;\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = _arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = _arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : _createSet(array);\n    if (set) {\n      return _setToArray(set);\n    }\n    isCommon = false;\n    includes = _cacheHas;\n    seen = new _SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nvar _baseUniq = baseUniq;\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? _baseUniq(array) : [];\n}\n\nvar uniq_1 = uniq;\n\nfunction camelCaseToDash(str) {\n    return str.replace(/([A-Z])/g, (g) => `-${g[0].toLowerCase()}`);\n}\n\nfunction makeDataAttributeString(props) {\n    const keys = Object.keys(props);\n\n    return keys\n        .map((key) => {\n            const _key = camelCaseToDash(key);\n            const val = props[key];\n\n            if (val === undefined) return '';\n            return `data-${_key}=\"${val}\" `;\n        })\n        .join('')\n        .trim();\n}\n\nfunction copyTextToClipboard(text) {\n    // https://stackoverflow.com/a/30810322/5353542\n    var textArea = document.createElement('textarea');\n\n    //\n    // *** This styling is an extra step which is likely not required. ***\n    //\n    // Why is it here? To ensure:\n    // 1. the element is able to have focus and selection.\n    // 2. if element was to flash render it has minimal visual impact.\n    // 3. less flakyness with selection and copying which **might** occur if\n    //    the textarea element is not visible.\n    //\n    // The likelihood is the element won't even render, not even a flash,\n    // so some of these are just precautions. However in IE the element\n    // is visible whilst the popup box asking the user for permission for\n    // the web page to copy to the clipboard.\n    //\n\n    // Place in top-left corner of screen regardless of scroll position.\n    textArea.style.position = 'fixed';\n    textArea.style.top = 0;\n    textArea.style.left = 0;\n\n    // Ensure it has a small width and height. Setting to 1px / 1em\n    // doesn't work as this gives a negative w/h on some browsers.\n    textArea.style.width = '2em';\n    textArea.style.height = '2em';\n\n    // We don't need padding, reducing the size if it does flash render.\n    textArea.style.padding = 0;\n\n    // Clean up any borders.\n    textArea.style.border = 'none';\n    textArea.style.outline = 'none';\n    textArea.style.boxShadow = 'none';\n\n    // Avoid flash of white box if rendered for any reason.\n    textArea.style.background = 'transparent';\n\n    textArea.value = text;\n\n    document.body.appendChild(textArea);\n\n    textArea.select();\n\n    try {\n        document.execCommand('copy');\n    } catch (err) {\n        console.log('Oops, unable to copy');\n    }\n\n    document.body.removeChild(textArea);\n}\n\nfunction isNumeric(val) {\n    return !isNaN(val);\n}\n\nlet throttle$1 = throttle_1;\n\nlet debounce$1 = debounce_1;\n\nfunction nextTick(fn, context = null) {\n    return (...args) => {\n        return new Promise(resolve => {\n            const execute = () => {\n                const out = fn.apply(context, args);\n                resolve(out);\n            };\n            setTimeout(execute);\n        });\n    };\n}\nfunction linkProperties(target, source, properties) {\n    const props = properties.reduce((acc, prop) => {\n        acc[prop] = {\n            get() {\n                return source[prop];\n            }\n        };\n        return acc;\n    }, {});\n    Object.defineProperties(target, props);\n}\nfunction isSet(val) {\n    return val !== undefined || val !== null;\n}\n\nfunction notSet(val) {\n    return !isSet(val);\n}\n\nfunction isNumber(val) {\n    return !isNaN(val);\n}\n\nfunction ensureArray(val) {\n    if (!Array.isArray(val)) {\n        return [val];\n    }\n    return val;\n}\n\nfunction uniq$1(arr) {\n    return uniq_1(arr);\n}\n\nfunction numberSortAsc(a, b) {\n    return a - b;\n}\nfunction stripHTML(html) {\n    return html.replace(/<[^>]*>/g, '');\n}\n\nclass DataManager {\n    constructor(options) {\n        this.options = options;\n        this.sortRows = nextTick(this.sortRows, this);\n        this.switchColumn = nextTick(this.switchColumn, this);\n        this.removeColumn = nextTick(this.removeColumn, this);\n        this.options.filterRows = nextTick(this.options.filterRows, this);\n    }\n\n    init(data, columns) {\n        if (!data) {\n            data = this.options.data;\n        }\n        if (columns) {\n            this.options.columns = columns;\n        }\n\n        this.data = data;\n\n        this.rowCount = 0;\n        this.columns = [];\n        this.rows = [];\n\n        this.prepareColumns();\n        this.prepareRows();\n        this.prepareTreeRows();\n        this.prepareRowView();\n        this.prepareNumericColumns();\n    }\n\n    // computed property\n    get currentSort() {\n        const col = this.columns.find(col => col.sortOrder !== 'none');\n        return col || {\n            colIndex: -1,\n            sortOrder: 'none'\n        };\n    }\n\n    prepareColumns() {\n        this.columns = [];\n        this.validateColumns();\n        this.prepareDefaultColumns();\n        this.prepareHeader();\n    }\n\n    prepareDefaultColumns() {\n        if (this.options.checkboxColumn && !this.hasColumnById('_checkbox')) {\n            const cell = {\n                id: '_checkbox',\n                content: this.getCheckboxHTML(),\n                editable: false,\n                resizable: false,\n                sortable: false,\n                focusable: false,\n                dropdown: false,\n                width: 32\n            };\n            this.columns.push(cell);\n        }\n\n        if (this.options.serialNoColumn && !this.hasColumnById('_rowIndex')) {\n            let cell = {\n                id: '_rowIndex',\n                content: '',\n                align: 'center',\n                editable: false,\n                resizable: false,\n                focusable: false,\n                dropdown: false\n            };\n\n            this.columns.push(cell);\n        }\n    }\n\n    prepareHeader() {\n        let columns = this.columns.concat(this.options.columns);\n        const baseCell = {\n            isHeader: 1,\n            editable: true,\n            sortable: true,\n            resizable: true,\n            focusable: true,\n            dropdown: true,\n            width: null,\n            format: (value) => {\n                if (value === null || value === undefined) {\n                    return '';\n                }\n                return value + '';\n            }\n        };\n\n        this.columns = columns\n            .map((cell, i) => this.prepareCell(cell, i))\n            .map(col => Object.assign({}, baseCell, col))\n            .map(col => {\n                col.content = col.content || col.name || '';\n                col.id = col.id || col.content;\n                return col;\n            });\n    }\n\n    prepareCell(content, i) {\n        const cell = {\n            content: '',\n            sortOrder: 'none',\n            colIndex: i,\n            column: this.columns[i]\n        };\n\n        if (content !== null && typeof content === 'object') {\n            // passed as column/header\n            Object.assign(cell, content);\n        } else {\n            cell.content = content;\n        }\n\n        return cell;\n    }\n\n    prepareNumericColumns() {\n        const row0 = this.getRow(0);\n        if (!row0) return;\n        this.columns = this.columns.map((column, i) => {\n\n            const cellValue = row0[i].content;\n            if (!column.align && isNumeric(cellValue)) {\n                column.align = 'right';\n            }\n\n            return column;\n        });\n    }\n\n    prepareRows() {\n        this.validateData(this.data);\n\n        this.rows = this.data.map((d, i) => {\n            const index = this._getNextRowCount();\n\n            let row = [];\n            let meta = {\n                rowIndex: index\n            };\n\n            if (Array.isArray(d)) {\n                // row is an array\n                if (this.options.checkboxColumn) {\n                    row.push(this.getCheckboxHTML());\n                }\n                if (this.options.serialNoColumn) {\n                    row.push((index + 1) + '');\n                }\n                row = row.concat(d);\n\n                while (row.length < this.columns.length) {\n                    row.push('');\n                }\n\n            } else {\n                // row is an object\n                for (let col of this.columns) {\n                    if (col.id === '_checkbox') {\n                        row.push(this.getCheckboxHTML());\n                    } else if (col.id === '_rowIndex') {\n                        row.push((index + 1) + '');\n                    } else {\n                        row.push(d[col.id]);\n                    }\n                }\n\n                meta.indent = d.indent || 0;\n            }\n\n            return this.prepareRow(row, meta);\n        });\n    }\n\n    prepareTreeRows() {\n        this.rows.forEach((row, i) => {\n            if (isNumber(row.meta.indent)) {\n                // if (i === 36) debugger;\n                const nextRow = this.getRow(i + 1);\n                row.meta.isLeaf = !nextRow ||\n                    notSet(nextRow.meta.indent) ||\n                    nextRow.meta.indent <= row.meta.indent;\n                row.meta.isTreeNodeClose = false;\n            }\n        });\n    }\n\n    prepareRowView() {\n        // This is order in which rows will be rendered in the table.\n        // When sorting happens, only this.rowViewOrder will change\n        // and not the original this.rows\n        this.rowViewOrder = this.rows.map(row => row.meta.rowIndex);\n    }\n\n    prepareRow(row, meta) {\n        const baseRowCell = {\n            rowIndex: meta.rowIndex,\n            indent: meta.indent\n        };\n\n        row = row\n            .map((cell, i) => this.prepareCell(cell, i))\n            .map(cell => Object.assign({}, baseRowCell, cell));\n\n        // monkey patched in array object\n        row.meta = meta;\n        return row;\n    }\n\n    validateColumns() {\n        const columns = this.options.columns;\n        if (!Array.isArray(columns)) {\n            throw new DataError('`columns` must be an array');\n        }\n\n        columns.forEach((column, i) => {\n            if (typeof column !== 'string' && typeof column !== 'object') {\n                throw new DataError(`column \"${i}\" must be a string or an object`);\n            }\n        });\n    }\n\n    validateData(data) {\n        if (Array.isArray(data) &&\n            (data.length === 0 || Array.isArray(data[0]) || typeof data[0] === 'object')) {\n            return true;\n        }\n        throw new DataError('`data` must be an array of arrays or objects');\n    }\n\n    appendRows(rows) {\n        this.validateData(rows);\n\n        this.rows.push(...this.prepareRows(rows));\n    }\n\n    sortRows(colIndex, sortOrder = 'none') {\n        colIndex = +colIndex;\n\n        // reset sortOrder and update for colIndex\n        this.getColumns()\n            .map(col => {\n                if (col.colIndex === colIndex) {\n                    col.sortOrder = sortOrder;\n                } else {\n                    col.sortOrder = 'none';\n                }\n            });\n\n        this._sortRows(colIndex, sortOrder);\n    }\n\n    _sortRows(colIndex, sortOrder) {\n\n        if (this.currentSort.colIndex === colIndex) {\n            // reverse the array if only sortOrder changed\n            if (\n                (this.currentSort.sortOrder === 'asc' && sortOrder === 'desc') ||\n                (this.currentSort.sortOrder === 'desc' && sortOrder === 'asc')\n            ) {\n                this.reverseArray(this.rowViewOrder);\n                this.currentSort.sortOrder = sortOrder;\n                return;\n            }\n        }\n\n        this.rowViewOrder.sort((a, b) => {\n            const aIndex = a;\n            const bIndex = b;\n            const aContent = this.getCell(colIndex, a).content;\n            const bContent = this.getCell(colIndex, b).content;\n\n            if (sortOrder === 'none') {\n                return aIndex - bIndex;\n            } else if (sortOrder === 'asc') {\n                if (aContent < bContent) return -1;\n                if (aContent > bContent) return 1;\n                if (aContent === bContent) return 0;\n            } else if (sortOrder === 'desc') {\n                if (aContent < bContent) return 1;\n                if (aContent > bContent) return -1;\n                if (aContent === bContent) return 0;\n            }\n            return 0;\n        });\n\n        if (this.hasColumnById('_rowIndex')) {\n            // update row index\n            const srNoColIndex = this.getColumnIndexById('_rowIndex');\n            this.rows.forEach((row, index) => {\n                const viewIndex = this.rowViewOrder.indexOf(index);\n                const cell = row[srNoColIndex];\n                cell.content = (viewIndex + 1) + '';\n            });\n        }\n    }\n\n    reverseArray(array) {\n        let left = null;\n        let right = null;\n        let length = array.length;\n\n        for (left = 0, right = length - 1; left < right; left += 1, right -= 1) {\n            const temporary = array[left];\n\n            array[left] = array[right];\n            array[right] = temporary;\n        }\n    }\n\n    switchColumn(index1, index2) {\n        // update columns\n        const temp = this.columns[index1];\n        this.columns[index1] = this.columns[index2];\n        this.columns[index2] = temp;\n\n        this.columns[index1].colIndex = index1;\n        this.columns[index2].colIndex = index2;\n\n        // update rows\n        this.rows.forEach(row => {\n            const newCell1 = Object.assign({}, row[index1], {\n                colIndex: index2\n            });\n            const newCell2 = Object.assign({}, row[index2], {\n                colIndex: index1\n            });\n\n            row[index2] = newCell1;\n            row[index1] = newCell2;\n        });\n    }\n\n    removeColumn(index) {\n        index = +index;\n        const filter = cell => cell.colIndex !== index;\n        const map = (cell, i) => Object.assign({}, cell, {\n            colIndex: i\n        });\n        // update columns\n        this.columns = this.columns\n            .filter(filter)\n            .map(map);\n\n        // update rows\n        this.rows.forEach(row => {\n            // remove cell\n            row.splice(index, 1);\n            // update colIndex\n            row.forEach((cell, i) => {\n                cell.colIndex = i;\n            });\n        });\n    }\n\n    updateRow(row, rowIndex) {\n        if (row.length < this.columns.length) {\n            if (this.hasColumnById('_rowIndex')) {\n                const val = (rowIndex + 1) + '';\n\n                row = [val].concat(row);\n            }\n\n            if (this.hasColumnById('_checkbox')) {\n                const val = '<input type=\"checkbox\" />';\n\n                row = [val].concat(row);\n            }\n        }\n\n        const _row = this.prepareRow(row, {rowIndex});\n        const index = this.rows.findIndex(row => row[0].rowIndex === rowIndex);\n        this.rows[index] = _row;\n\n        return _row;\n    }\n\n    updateCell(colIndex, rowIndex, options) {\n        let cell;\n        if (typeof colIndex === 'object') {\n            // cell object was passed,\n            // must have colIndex, rowIndex\n            cell = colIndex;\n            colIndex = cell.colIndex;\n            rowIndex = cell.rowIndex;\n            // the object passed must be merged with original cell\n            options = cell;\n        }\n        cell = this.getCell(colIndex, rowIndex);\n\n        // mutate object directly\n        for (let key in options) {\n            const newVal = options[key];\n            if (newVal !== undefined) {\n                cell[key] = newVal;\n            }\n        }\n\n        return cell;\n    }\n\n    updateColumn(colIndex, keyValPairs) {\n        const column = this.getColumn(colIndex);\n        for (let key in keyValPairs) {\n            const newVal = keyValPairs[key];\n            if (newVal !== undefined) {\n                column[key] = newVal;\n            }\n        }\n        return column;\n    }\n\n    filterRows(filters) {\n        return this.options.filterRows(this.rows, filters)\n            .then(result => {\n                if (!result) {\n                    result = this.getAllRowIndices();\n                }\n\n                if (!result.then) {\n                    result = Promise.resolve(result);\n                }\n\n                return result.then(rowsToShow => {\n                    this._filteredRows = rowsToShow;\n\n                    const rowsToHide = this.getAllRowIndices()\n                        .filter(index => !rowsToShow.includes(index));\n\n                    return {\n                        rowsToHide,\n                        rowsToShow\n                    };\n                });\n            });\n    }\n\n    getFilteredRowIndices() {\n        return this._filteredRows || this.getAllRowIndices();\n    }\n\n    getAllRowIndices() {\n        return this.rows.map(row => row.meta.rowIndex);\n    }\n\n    getRowCount() {\n        return this.rowCount;\n    }\n\n    _getNextRowCount() {\n        const val = this.rowCount;\n\n        this.rowCount++;\n        return val;\n    }\n\n    getRows(start, end) {\n        return this.rows.slice(start, end);\n    }\n\n    getRowsForView(start, end) {\n        const rows = this.rowViewOrder.map(i => this.rows[i]);\n        return rows.slice(start, end);\n    }\n\n    getColumns(skipStandardColumns) {\n        let columns = this.columns;\n\n        if (skipStandardColumns) {\n            columns = columns.slice(this.getStandardColumnCount());\n        }\n\n        return columns;\n    }\n\n    getStandardColumnCount() {\n        if (this.options.checkboxColumn && this.options.serialNoColumn) {\n            return 2;\n        }\n\n        if (this.options.checkboxColumn || this.options.serialNoColumn) {\n            return 1;\n        }\n\n        return 0;\n    }\n\n    getColumnCount(skipStandardColumns) {\n        let val = this.columns.length;\n\n        if (skipStandardColumns) {\n            val = val - this.getStandardColumnCount();\n        }\n\n        return val;\n    }\n\n    getColumn(colIndex) {\n        colIndex = +colIndex;\n\n        if (colIndex < 0) {\n            // negative indexes\n            colIndex = this.columns.length + colIndex;\n        }\n\n        return this.columns.find(col => col.colIndex === colIndex);\n    }\n\n    getColumnById(id) {\n        return this.columns.find(col => col.id === id);\n    }\n\n    getRow(rowIndex) {\n        rowIndex = +rowIndex;\n        return this.rows[rowIndex];\n    }\n\n    getCell(colIndex, rowIndex) {\n        rowIndex = +rowIndex;\n        colIndex = +colIndex;\n        return this.getRow(rowIndex)[colIndex];\n    }\n\n    getChildren(parentRowIndex) {\n        parentRowIndex = +parentRowIndex;\n        const parentIndent = this.getRow(parentRowIndex).meta.indent;\n        const out = [];\n\n        for (let i = parentRowIndex + 1; i < this.rowCount; i++) {\n            const row = this.getRow(i);\n            if (isNaN(row.meta.indent)) continue;\n\n            if (row.meta.indent > parentIndent) {\n                out.push(i);\n            }\n\n            if (row.meta.indent === parentIndent) {\n                break;\n            }\n        }\n\n        return out;\n    }\n\n    getImmediateChildren(parentRowIndex) {\n        parentRowIndex = +parentRowIndex;\n        const parentIndent = this.getRow(parentRowIndex).meta.indent;\n        const out = [];\n        const childIndent = parentIndent + 1;\n\n        for (let i = parentRowIndex + 1; i < this.rowCount; i++) {\n            const row = this.getRow(i);\n            if (isNaN(row.meta.indent) || row.meta.indent > childIndent) continue;\n\n            if (row.meta.indent === childIndent) {\n                out.push(i);\n            }\n\n            if (row.meta.indent === parentIndent) {\n                break;\n            }\n        }\n\n        return out;\n    }\n\n    get() {\n        return {\n            columns: this.columns,\n            rows: this.rows\n        };\n    }\n\n    /**\n     * Returns the original data which was passed\n     * based on rowIndex\n     * @param {Number} rowIndex\n     * @returns Array|Object\n     * @memberof DataManager\n     */\n    getData(rowIndex) {\n        return this.data[rowIndex];\n    }\n\n    hasColumn(name) {\n        return Boolean(this.columns.find(col => col.content === name));\n    }\n\n    hasColumnById(id) {\n        return Boolean(this.columns.find(col => col.id === id));\n    }\n\n    getColumnIndex(name) {\n        return this.columns.findIndex(col => col.content === name);\n    }\n\n    getColumnIndexById(id) {\n        return this.columns.findIndex(col => col.id === id);\n    }\n\n    getCheckboxHTML() {\n        return '<input type=\"checkbox\" />';\n    }\n}\n\n// Custom Errors\nclass DataError extends TypeError {}\n\n/* eslint-disable max-len */\n\n// Icons from https://feathericons.com/\n\nlet icons = {\n    chevronDown: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-down\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>',\n    chevronRight: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-chevron-right\"><polyline points=\"9 18 15 12 9 6\"></polyline></svg>'\n};\n\nclass CellManager {\n    constructor(instance) {\n        this.instance = instance;\n        linkProperties(this, this.instance, [\n            'wrapper',\n            'options',\n            'style',\n            'header',\n            'bodyScrollable',\n            'columnmanager',\n            'rowmanager',\n            'datamanager',\n            'keyboard'\n        ]);\n\n        this.bindEvents();\n    }\n\n    bindEvents() {\n        this.bindFocusCell();\n        this.bindEditCell();\n        this.bindKeyboardSelection();\n        this.bindCopyCellContents();\n        this.bindMouseEvents();\n        this.bindTreeEvents();\n    }\n\n    bindFocusCell() {\n        this.bindKeyboardNav();\n    }\n\n    bindEditCell() {\n        this.$editingCell = null;\n\n        $.on(this.bodyScrollable, 'dblclick', '.dt-cell', (e, cell) => {\n            this.activateEditing(cell);\n        });\n\n        this.keyboard.on('enter', () => {\n            if (this.$focusedCell && !this.$editingCell) {\n                // enter keypress on focused cell\n                this.activateEditing(this.$focusedCell);\n            } else if (this.$editingCell) {\n                // enter keypress on editing cell\n                this.submitEditing();\n                this.deactivateEditing();\n            }\n        });\n    }\n\n    bindKeyboardNav() {\n        const focusCell = (direction) => {\n            if (!this.$focusedCell || this.$editingCell) {\n                return false;\n            }\n\n            let $cell = this.$focusedCell;\n\n            if (direction === 'left' || direction === 'shift+tab') {\n                $cell = this.getLeftCell$($cell);\n            } else if (direction === 'right' || direction === 'tab') {\n                $cell = this.getRightCell$($cell);\n            } else if (direction === 'up') {\n                $cell = this.getAboveCell$($cell);\n            } else if (direction === 'down') {\n                $cell = this.getBelowCell$($cell);\n            }\n\n            this.focusCell($cell);\n            return true;\n        };\n\n        const focusLastCell = (direction) => {\n            if (!this.$focusedCell || this.$editingCell) {\n                return false;\n            }\n\n            let $cell = this.$focusedCell;\n            const {\n                rowIndex,\n                colIndex\n            } = $.data($cell);\n\n            if (direction === 'left') {\n                $cell = this.getLeftMostCell$(rowIndex);\n            } else if (direction === 'right') {\n                $cell = this.getRightMostCell$(rowIndex);\n            } else if (direction === 'up') {\n                $cell = this.getTopMostCell$(colIndex);\n            } else if (direction === 'down') {\n                $cell = this.getBottomMostCell$(colIndex);\n            }\n\n            this.focusCell($cell);\n            return true;\n        };\n\n        ['left', 'right', 'up', 'down', 'tab', 'shift+tab']\n            .map(direction => this.keyboard.on(direction, () => focusCell(direction)));\n\n        ['left', 'right', 'up', 'down']\n            .map(direction => this.keyboard.on(`ctrl+${direction}`, () => focusLastCell(direction)));\n\n        this.keyboard.on('esc', () => {\n            this.deactivateEditing();\n            this.columnmanager.toggleFilter(false);\n        });\n\n        if (this.options.inlineFilters) {\n            this.keyboard.on('ctrl+f', (e) => {\n                const $cell = $.closest('.dt-cell', e.target);\n                const { colIndex } = $.data($cell);\n\n                this.activateFilter(colIndex);\n                return true;\n            });\n\n            $.on(this.header, 'focusin', '.dt-filter', () => {\n                this.unfocusCell(this.$focusedCell);\n            });\n        }\n    }\n\n    bindKeyboardSelection() {\n        const getNextSelectionCursor = (direction) => {\n            let $selectionCursor = this.getSelectionCursor();\n\n            if (direction === 'left') {\n                $selectionCursor = this.getLeftCell$($selectionCursor);\n            } else if (direction === 'right') {\n                $selectionCursor = this.getRightCell$($selectionCursor);\n            } else if (direction === 'up') {\n                $selectionCursor = this.getAboveCell$($selectionCursor);\n            } else if (direction === 'down') {\n                $selectionCursor = this.getBelowCell$($selectionCursor);\n            }\n\n            return $selectionCursor;\n        };\n\n        ['left', 'right', 'up', 'down']\n            .map(direction =>\n                this.keyboard.on(`shift+${direction}`, () => this.selectArea(getNextSelectionCursor(direction))));\n    }\n\n    bindCopyCellContents() {\n        this.keyboard.on('ctrl+c', () => {\n            const noOfCellsCopied = this.copyCellContents(this.$focusedCell, this.$selectionCursor);\n            const message = `${noOfCellsCopied} cell${noOfCellsCopied > 1 ? 's' : ''} copied`;\n            if (noOfCellsCopied) {\n                this.instance.showToastMessage(message, 2);\n            }\n        });\n\n        if (this.options.pasteFromClipboard) {\n            this.keyboard.on('ctrl+v', (e) => {\n                // hack\n                // https://stackoverflow.com/a/2177059/5353542\n                this.instance.pasteTarget.focus();\n\n                setTimeout(() => {\n                    const data = this.instance.pasteTarget.value;\n                    this.instance.pasteTarget.value = '';\n                    this.pasteContentInCell(data);\n                }, 10);\n\n                return false;\n            });\n        }\n    }\n\n    bindMouseEvents() {\n        let mouseDown = null;\n\n        $.on(this.bodyScrollable, 'mousedown', '.dt-cell', (e) => {\n            mouseDown = true;\n            this.focusCell($(e.delegatedTarget));\n        });\n\n        $.on(this.bodyScrollable, 'mouseup', () => {\n            mouseDown = false;\n        });\n\n        const selectArea = (e) => {\n            if (!mouseDown) return;\n            this.selectArea($(e.delegatedTarget));\n        };\n\n        $.on(this.bodyScrollable, 'mousemove', '.dt-cell', throttle$1(selectArea, 50));\n    }\n\n    bindTreeEvents() {\n        $.on(this.bodyScrollable, 'click', '.dt-tree-node__toggle', (e, $toggle) => {\n            const $cell = $.closest('.dt-cell', $toggle);\n            const { rowIndex } = $.data($cell);\n\n            if ($cell.classList.contains('dt-cell--tree-close')) {\n                this.rowmanager.openSingleNode(rowIndex);\n            } else {\n                this.rowmanager.closeSingleNode(rowIndex);\n            }\n        });\n    }\n\n    focusCell($cell, {\n        skipClearSelection = 0,\n        skipDOMFocus = 0,\n        skipScrollToCell = 0\n    } = {}) {\n        if (!$cell) return;\n\n        // don't focus if already editing cell\n        if ($cell === this.$editingCell) return;\n\n        const {\n            colIndex,\n            isHeader\n        } = $.data($cell);\n        if (isHeader) {\n            return;\n        }\n\n        const column = this.columnmanager.getColumn(colIndex);\n        if (column.focusable === false) {\n            return;\n        }\n\n        if (!skipScrollToCell) {\n            this.scrollToCell($cell);\n        }\n\n        this.deactivateEditing();\n        if (!skipClearSelection) {\n            this.clearSelection();\n        }\n\n        if (this.$focusedCell) {\n            this.$focusedCell.classList.remove('dt-cell--focus');\n        }\n\n        this.$focusedCell = $cell;\n        $cell.classList.add('dt-cell--focus');\n\n        if (!skipDOMFocus) {\n            // so that keyboard nav works\n            $cell.focus();\n        }\n\n        this.highlightRowColumnHeader($cell);\n    }\n\n    unfocusCell($cell) {\n        if (!$cell) return;\n\n        // remove cell border\n        $cell.classList.remove('dt-cell--focus');\n        this.$focusedCell = null;\n\n        // reset header background\n        if (this.lastHeaders) {\n            this.lastHeaders.forEach(header => header.classList.remove('dt-cell--highlight'));\n        }\n    }\n\n    highlightRowColumnHeader($cell) {\n        const {\n            colIndex,\n            rowIndex\n        } = $.data($cell);\n\n        const srNoColIndex = this.datamanager.getColumnIndexById('_rowIndex');\n        const colHeaderSelector = `.dt-cell--header-${colIndex}`;\n        const rowHeaderSelector = `.dt-cell--${srNoColIndex}-${rowIndex}`;\n\n        if (this.lastHeaders) {\n            this.lastHeaders.forEach(header => header.classList.remove('dt-cell--highlight'));\n        }\n\n        const colHeader = $(colHeaderSelector, this.wrapper);\n        const rowHeader = $(rowHeaderSelector, this.wrapper);\n\n        this.lastHeaders = [colHeader, rowHeader];\n        this.lastHeaders.forEach(header => header.classList.add('dt-cell--highlight'));\n    }\n\n    selectAreaOnClusterChanged() {\n        if (!(this.$focusedCell && this.$selectionCursor)) return;\n        const {\n            colIndex,\n            rowIndex\n        } = $.data(this.$selectionCursor);\n        const $cell = this.getCell$(colIndex, rowIndex);\n\n        if (!$cell || $cell === this.$selectionCursor) return;\n\n        // selectArea needs $focusedCell\n        const fCell = $.data(this.$focusedCell);\n        this.$focusedCell = this.getCell$(fCell.colIndex, fCell.rowIndex);\n\n        this.selectArea($cell);\n    }\n\n    focusCellOnClusterChanged() {\n        if (!this.$focusedCell) return;\n\n        const {\n            colIndex,\n            rowIndex\n        } = $.data(this.$focusedCell);\n        const $cell = this.getCell$(colIndex, rowIndex);\n\n        if (!$cell) return;\n        // this function is called after hyperlist renders the rows after scroll,\n        // focusCell calls clearSelection which resets the area selection\n        // so a flag to skip it\n        // we also skip DOM focus and scroll to cell\n        // because it fights with the user scroll\n        this.focusCell($cell, {\n            skipClearSelection: 1,\n            skipDOMFocus: 1,\n            skipScrollToCell: 1\n        });\n    }\n\n    selectArea($selectionCursor) {\n        if (!this.$focusedCell) return;\n\n        if (this._selectArea(this.$focusedCell, $selectionCursor)) {\n            // valid selection\n            this.$selectionCursor = $selectionCursor;\n        }\n    }\n\n    _selectArea($cell1, $cell2) {\n        if ($cell1 === $cell2) return false;\n\n        const cells = this.getCellsInRange($cell1, $cell2);\n        if (!cells) return false;\n\n        this.clearSelection();\n        this._selectedCells = cells.map(index => this.getCell$(...index));\n        requestAnimationFrame(() => {\n            this._selectedCells.map($cell => $cell.classList.add('dt-cell--highlight'));\n        });\n        return true;\n    }\n\n    getCellsInRange($cell1, $cell2) {\n        let colIndex1, rowIndex1, colIndex2, rowIndex2;\n\n        if (typeof $cell1 === 'number') {\n            [colIndex1, rowIndex1, colIndex2, rowIndex2] = arguments;\n        } else\n        if (typeof $cell1 === 'object') {\n            if (!($cell1 && $cell2)) {\n                return false;\n            }\n\n            const cell1 = $.data($cell1);\n            const cell2 = $.data($cell2);\n\n            colIndex1 = +cell1.colIndex;\n            rowIndex1 = +cell1.rowIndex;\n            colIndex2 = +cell2.colIndex;\n            rowIndex2 = +cell2.rowIndex;\n        }\n\n        if (rowIndex1 > rowIndex2) {\n            [rowIndex1, rowIndex2] = [rowIndex2, rowIndex1];\n        }\n\n        if (colIndex1 > colIndex2) {\n            [colIndex1, colIndex2] = [colIndex2, colIndex1];\n        }\n\n        if (this.isStandardCell(colIndex1) || this.isStandardCell(colIndex2)) {\n            return false;\n        }\n\n        const cells = [];\n        let colIndex = colIndex1;\n        let rowIndex = rowIndex1;\n        const rowIndices = [];\n\n        while (rowIndex <= rowIndex2) {\n            rowIndices.push(rowIndex);\n            rowIndex += 1;\n        }\n\n        rowIndices.map((rowIndex) => {\n            while (colIndex <= colIndex2) {\n                cells.push([colIndex, rowIndex]);\n                colIndex++;\n            }\n            colIndex = colIndex1;\n        });\n\n        return cells;\n    }\n\n    clearSelection() {\n        (this._selectedCells || [])\n            .forEach($cell => $cell.classList.remove('dt-cell--highlight'));\n\n        this._selectedCells = [];\n        this.$selectionCursor = null;\n    }\n\n    getSelectionCursor() {\n        return this.$selectionCursor || this.$focusedCell;\n    }\n\n    activateEditing($cell) {\n        this.focusCell($cell);\n        const {\n            rowIndex,\n            colIndex\n        } = $.data($cell);\n\n        const col = this.columnmanager.getColumn(colIndex);\n        if (col && (col.editable === false || col.focusable === false)) {\n            return;\n        }\n\n        const cell = this.getCell(colIndex, rowIndex);\n        if (cell && cell.editable === false) {\n            return;\n        }\n\n        if (this.$editingCell) {\n            const {\n                _rowIndex,\n                _colIndex\n            } = $.data(this.$editingCell);\n\n            if (rowIndex === _rowIndex && colIndex === _colIndex) {\n                // editing the same cell\n                return;\n            }\n        }\n\n        this.$editingCell = $cell;\n        $cell.classList.add('dt-cell--editing');\n\n        const $editCell = $('.dt-cell__edit', $cell);\n        $editCell.innerHTML = '';\n\n        const editor = this.getEditor(colIndex, rowIndex, cell.content, $editCell);\n\n        if (editor) {\n            this.currentCellEditor = editor;\n            // initialize editing input with cell value\n            editor.initValue(cell.content, rowIndex, col);\n        }\n    }\n\n    deactivateEditing() {\n        // keep focus on the cell so that keyboard navigation works\n        if (this.$focusedCell) this.$focusedCell.focus();\n\n        if (!this.$editingCell) return;\n        this.$editingCell.classList.remove('dt-cell--editing');\n        this.$editingCell = null;\n    }\n\n    getEditor(colIndex, rowIndex, value, parent) {\n        const column = this.datamanager.getColumn(colIndex);\n        const row = this.datamanager.getRow(rowIndex);\n        const data = this.datamanager.getData(rowIndex);\n        let editor = this.options.getEditor ?\n            this.options.getEditor(colIndex, rowIndex, value, parent, column, row, data) :\n            this.getDefaultEditor(parent);\n\n        if (editor === false) {\n            // explicitly returned false\n            return false;\n        }\n        if (editor === undefined) {\n            // didn't return editor, fallback to default\n            editor = this.getDefaultEditor(parent);\n        }\n\n        return editor;\n    }\n\n    getDefaultEditor(parent) {\n        const $input = $.create('input', {\n            class: 'dt-input',\n            type: 'text',\n            inside: parent\n        });\n\n        return {\n            initValue(value) {\n                $input.focus();\n                $input.value = value;\n            },\n            getValue() {\n                return $input.value;\n            },\n            setValue(value) {\n                $input.value = value;\n            }\n        };\n    }\n\n    submitEditing() {\n        if (!this.$editingCell) return;\n        const $cell = this.$editingCell;\n        const {\n            rowIndex,\n            colIndex\n        } = $.data($cell);\n        const col = this.datamanager.getColumn(colIndex);\n\n        if ($cell) {\n            const editor = this.currentCellEditor;\n\n            if (editor) {\n                let valuePromise = editor.getValue();\n\n                // convert to stubbed Promise\n                if (!valuePromise.then) {\n                    valuePromise = Promise.resolve(valuePromise);\n                }\n\n                valuePromise.then((value) => {\n                    const done = editor.setValue(value, rowIndex, col);\n                    const oldValue = this.getCell(colIndex, rowIndex).content;\n\n                    // update cell immediately\n                    this.updateCell(colIndex, rowIndex, value);\n                    $cell.focus();\n\n                    if (done && done.then) {\n                        // revert to oldValue if promise fails\n                        done.catch((e) => {\n                            console.log(e);\n                            this.updateCell(colIndex, rowIndex, oldValue);\n                        });\n                    }\n                });\n            }\n        }\n\n        this.currentCellEditor = null;\n    }\n\n    copyCellContents($cell1, $cell2) {\n        if (!$cell2 && $cell1) {\n            // copy only focusedCell\n            const {\n                colIndex,\n                rowIndex\n            } = $.data($cell1);\n            const cell = this.getCell(colIndex, rowIndex);\n            copyTextToClipboard(cell.content);\n            return 1;\n        }\n        const cells = this.getCellsInRange($cell1, $cell2);\n\n        if (!cells) return 0;\n\n        const rows = cells\n            // get cell objects\n            .map(index => this.getCell(...index))\n            // convert to array of rows\n            .reduce((acc, curr) => {\n                const rowIndex = curr.rowIndex;\n\n                acc[rowIndex] = acc[rowIndex] || [];\n                acc[rowIndex].push(curr.content);\n\n                return acc;\n            }, []);\n\n        const values = rows\n            // join values by tab\n            .map(row => row.join('\\t'))\n            // join rows by newline\n            .join('\\n');\n\n        copyTextToClipboard(values);\n\n        // return no of cells copied\n        return rows.reduce((total, row) => total + row.length, 0);\n    }\n\n    pasteContentInCell(data) {\n        if (!this.$focusedCell) return;\n\n        const matrix = data\n            .split('\\n')\n            .map(row => row.split('\\t'))\n            .filter(row => row.length && row.every(it => it));\n\n        let { colIndex, rowIndex } = $.data(this.$focusedCell);\n\n        let focusedCell = {\n            colIndex: +colIndex,\n            rowIndex: +rowIndex\n        };\n\n        matrix.forEach((row, i) => {\n            let rowIndex = i + focusedCell.rowIndex;\n            row.forEach((cell, j) => {\n                let colIndex = j + focusedCell.colIndex;\n                this.updateCell(colIndex, rowIndex, cell);\n            });\n        });\n    }\n\n    activateFilter(colIndex) {\n        this.columnmanager.toggleFilter();\n        this.columnmanager.focusFilter(colIndex);\n\n        if (!this.columnmanager.isFilterShown) {\n            // put focus back on cell\n            this.$focusedCell && this.$focusedCell.focus();\n        }\n    }\n\n    updateCell(colIndex, rowIndex, value) {\n        const cell = this.datamanager.updateCell(colIndex, rowIndex, {\n            content: value\n        });\n        this.refreshCell(cell);\n    }\n\n    refreshCell(cell) {\n        const $cell = $(this.selector(cell.colIndex, cell.rowIndex), this.bodyScrollable);\n        $cell.innerHTML = this.getCellContent(cell);\n    }\n\n    toggleTreeButton(rowIndex, flag) {\n        const colIndex = this.columnmanager.getFirstColumnIndex();\n        const $cell = this.getCell$(colIndex, rowIndex);\n        if ($cell) {\n            $cell.classList[flag ? 'remove' : 'add']('dt-cell--tree-close');\n        }\n    }\n\n    isStandardCell(colIndex) {\n        // Standard cells are in Sr. No and Checkbox column\n        return colIndex < this.columnmanager.getFirstColumnIndex();\n    }\n\n    getCell$(colIndex, rowIndex) {\n        return $(this.selector(colIndex, rowIndex), this.bodyScrollable);\n    }\n\n    getAboveCell$($cell) {\n        const {\n            colIndex\n        } = $.data($cell);\n\n        let $aboveRow = $cell.parentElement.previousElementSibling;\n        while ($aboveRow && $aboveRow.classList.contains('dt-row--hide')) {\n            $aboveRow = $aboveRow.previousElementSibling;\n        }\n\n        if (!$aboveRow) return $cell;\n        return $(`.dt-cell--col-${colIndex}`, $aboveRow);\n    }\n\n    getBelowCell$($cell) {\n        const {\n            colIndex\n        } = $.data($cell);\n\n        let $belowRow = $cell.parentElement.nextElementSibling;\n        while ($belowRow && $belowRow.classList.contains('dt-row--hide')) {\n            $belowRow = $belowRow.nextElementSibling;\n        }\n\n        if (!$belowRow) return $cell;\n        return $(`.dt-cell--col-${colIndex}`, $belowRow);\n    }\n\n    getLeftCell$($cell) {\n        return $cell.previousElementSibling;\n    }\n\n    getRightCell$($cell) {\n        return $cell.nextElementSibling;\n    }\n\n    getLeftMostCell$(rowIndex) {\n        return this.getCell$(this.columnmanager.getFirstColumnIndex(), rowIndex);\n    }\n\n    getRightMostCell$(rowIndex) {\n        return this.getCell$(this.columnmanager.getLastColumnIndex(), rowIndex);\n    }\n\n    getTopMostCell$(colIndex) {\n        return this.getCell$(colIndex, this.rowmanager.getFirstRowIndex());\n    }\n\n    getBottomMostCell$(colIndex) {\n        return this.getCell$(colIndex, this.rowmanager.getLastRowIndex());\n    }\n\n    getCell(colIndex, rowIndex) {\n        return this.instance.datamanager.getCell(colIndex, rowIndex);\n    }\n\n    getRowHeight() {\n        return $.style($('.dt-row', this.bodyScrollable), 'height');\n    }\n\n    scrollToCell($cell) {\n        if ($.inViewport($cell, this.bodyScrollable)) return false;\n\n        const {\n            rowIndex\n        } = $.data($cell);\n        this.rowmanager.scrollToRow(rowIndex);\n        return false;\n    }\n\n    getRowCountPerPage() {\n        return Math.ceil(this.instance.getViewportHeight() / this.getRowHeight());\n    }\n\n    getCellHTML(cell) {\n        const {\n            rowIndex,\n            colIndex,\n            isHeader,\n            isFilter,\n            isTotalRow\n        } = cell;\n        const dataAttr = makeDataAttributeString({\n            rowIndex,\n            colIndex,\n            isHeader,\n            isFilter,\n            isTotalRow\n        });\n\n        const row = this.datamanager.getRow(rowIndex);\n\n        const isBodyCell = !(isHeader || isFilter || isTotalRow);\n\n        const className = [\n            'dt-cell',\n            'dt-cell--col-' + colIndex,\n            isBodyCell ? `dt-cell--${colIndex}-${rowIndex}` : '',\n            isBodyCell ? 'dt-cell--row-' + rowIndex : '',\n            isHeader ? 'dt-cell--header' : '',\n            isHeader ? `dt-cell--header-${colIndex}` : '',\n            isFilter ? 'dt-cell--filter' : '',\n            isBodyCell && row.meta.isTreeNodeClose ? 'dt-cell--tree-close' : ''\n        ].join(' ');\n\n        return `\n            <div class=\"${className}\" ${dataAttr} tabindex=\"0\">\n                ${this.getCellContent(cell)}\n            </div>\n        `;\n    }\n\n    getCellContent(cell) {\n        const {\n            isHeader,\n            isFilter,\n            colIndex\n        } = cell;\n\n        const editable = !isHeader && cell.editable !== false;\n        const editCellHTML = editable ? this.getEditCellHTML(colIndex) : '';\n\n        const sortable = isHeader && cell.sortable !== false;\n        const sortIndicator = sortable ?\n            `<span class=\"sort-indicator\">\n                ${this.options.sortIndicator[cell.sortOrder]}\n            </span>` :\n            '';\n\n        const resizable = isHeader && cell.resizable !== false;\n        const resizeColumn = resizable ? '<span class=\"dt-cell__resize-handle\"></span>' : '';\n\n        const hasDropdown = isHeader && cell.dropdown !== false;\n        const dropdown = hasDropdown ? this.columnmanager.getDropdownHTML() : '';\n\n        const customFormatter = cell.format || (cell.column && cell.column.format) || null;\n\n        let contentHTML;\n        if (isHeader || isFilter || !customFormatter) {\n            contentHTML = cell.content;\n        } else {\n            const row = this.datamanager.getRow(cell.rowIndex);\n            const data = this.datamanager.getData(cell.rowIndex);\n            contentHTML = customFormatter(cell.content, row, cell.column, data);\n        }\n\n        cell.html = contentHTML;\n\n        if (this.options.treeView && !(isHeader || isFilter) && cell.indent !== undefined) {\n            const nextRow = this.datamanager.getRow(cell.rowIndex + 1);\n            const addToggle = nextRow && nextRow.meta.indent > cell.indent;\n            const leftPadding = 20;\n            const unit = 'px';\n\n            // Add toggle and indent in the first column\n            const firstColumnIndex = this.datamanager.getColumnIndexById('_rowIndex') + 1;\n            if (firstColumnIndex === cell.colIndex) {\n                const padding = ((cell.indent || 0)) * leftPadding;\n                const toggleHTML = addToggle ?\n                    `<span class=\"dt-tree-node__toggle\" style=\"left: ${padding - leftPadding}${unit}\">\n                        <span class=\"icon-open\">${icons.chevronDown}</span>\n                        <span class=\"icon-close\">${icons.chevronRight}</span>\n                    </span>` : '';\n                contentHTML = `<span class=\"dt-tree-node\" style=\"padding-left: ${padding}${unit}\">\n                    ${toggleHTML}\n                    <span>${contentHTML}</span>\n                </span>`;\n            }\n        }\n\n        const className = [\n            'dt-cell__content',\n            isHeader ? `dt-cell__content--header-${colIndex}` : `dt-cell__content--col-${colIndex}`\n        ].join(' ');\n\n        return `\n            <div class=\"${className}\">\n                ${contentHTML}\n                ${sortIndicator}\n                ${resizeColumn}\n                ${dropdown}\n            </div>\n            ${editCellHTML}\n        `;\n    }\n\n    getEditCellHTML(colIndex) {\n        return `<div class=\"dt-cell__edit dt-cell__edit--col-${colIndex}\"></div>`;\n    }\n\n    selector(colIndex, rowIndex) {\n        return `.dt-cell--${colIndex}-${rowIndex}`;\n    }\n}\n\nclass ColumnManager {\n    constructor(instance) {\n        this.instance = instance;\n\n        linkProperties(this, this.instance, [\n            'options',\n            'fireEvent',\n            'header',\n            'datamanager',\n            'cellmanager',\n            'style',\n            'wrapper',\n            'rowmanager',\n            'bodyScrollable',\n            'bodyRenderer'\n        ]);\n\n        this.bindEvents();\n    }\n\n    renderHeader() {\n        this.header.innerHTML = '<div></div>';\n        this.refreshHeader();\n    }\n\n    refreshHeader() {\n        const columns = this.datamanager.getColumns();\n\n        // refresh html\n        $('div', this.header).innerHTML = this.getHeaderHTML(columns);\n\n        this.$filterRow = $('.dt-row-filter', this.header);\n        if (this.$filterRow) {\n            $.style(this.$filterRow, { display: 'none' });\n        }\n        // reset columnMap\n        this.$columnMap = [];\n        this.bindMoveColumn();\n    }\n\n    getHeaderHTML(columns) {\n        let html = this.rowmanager.getRowHTML(columns, {\n            isHeader: 1\n        });\n        if (this.options.inlineFilters) {\n            html += this.rowmanager.getRowHTML(columns, {\n                isFilter: 1\n            });\n        }\n        return html;\n    }\n\n    bindEvents() {\n        this.bindDropdown();\n        this.bindResizeColumn();\n        this.bindPerfectColumnWidth();\n        this.bindFilter();\n    }\n\n    bindDropdown() {\n        let toggleClass = '.dt-dropdown__toggle';\n        let dropdownClass = '.dt-dropdown__list';\n\n        // attach the dropdown list to container\n        this.instance.dropdownContainer.innerHTML = this.getDropdownListHTML();\n        this.$dropdownList = this.instance.dropdownContainer.firstElementChild;\n\n        $.on(this.header, 'click', toggleClass, e => {\n            this.openDropdown(e);\n        });\n\n        const deactivateDropdownOnBodyClick = (e) => {\n            const selector = [\n                toggleClass, toggleClass + ' *',\n                dropdownClass, dropdownClass + ' *'\n            ].join(',');\n            if (e.target.matches(selector)) return;\n            deactivateDropdown();\n        };\n        $.on(document.body, 'click', deactivateDropdownOnBodyClick);\n        document.addEventListener('scroll', deactivateDropdown, true);\n\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'click', deactivateDropdownOnBodyClick);\n            $.off(document, 'scroll', deactivateDropdown);\n        });\n\n        $.on(this.$dropdownList, 'click', '.dt-dropdown__list-item', (e, $item) => {\n            if (!this._dropdownActiveColIndex) return;\n            const dropdownItems = this.options.headerDropdown;\n            const { index } = $.data($item);\n            const colIndex = this._dropdownActiveColIndex;\n            let callback = dropdownItems[index].action;\n\n            callback && callback.call(this.instance, this.getColumn(colIndex));\n            this.hideDropdown();\n        });\n\n        const _this = this;\n        function deactivateDropdown(e) {\n            _this.hideDropdown();\n        }\n\n        this.hideDropdown();\n    }\n\n    openDropdown(e) {\n        if (!this._dropdownWidth) {\n            $.style(this.$dropdownList, { display: '' });\n            this._dropdownWidth = $.style(this.$dropdownList, 'width');\n        }\n        $.style(this.$dropdownList, {\n            display: '',\n            left: (e.clientX - this._dropdownWidth + 4) + 'px',\n            top: (e.clientY + 4) + 'px'\n        });\n        const $cell = $.closest('.dt-cell', e.target);\n        const { colIndex } = $.data($cell);\n        this._dropdownActiveColIndex = colIndex;\n    }\n\n    hideDropdown() {\n        $.style(this.$dropdownList, {\n            display: 'none'\n        });\n        this._dropdownActiveColIndex = null;\n    }\n\n    bindResizeColumn() {\n        let isDragging = false;\n        let $resizingCell, startWidth, startX;\n\n        $.on(this.header, 'mousedown', '.dt-cell .dt-cell__resize-handle', (e, $handle) => {\n            document.body.classList.add('dt-resize');\n            const $cell = $handle.parentNode.parentNode;\n            $resizingCell = $cell;\n            const {\n                colIndex\n            } = $.data($resizingCell);\n            const col = this.getColumn(colIndex);\n\n            if (col && col.resizable === false) {\n                return;\n            }\n\n            isDragging = true;\n            startWidth = $.style($('.dt-cell__content', $resizingCell), 'width');\n            startX = e.pageX;\n        });\n\n        const onMouseup = (e) => {\n            document.body.classList.remove('dt-resize');\n            if (!$resizingCell) return;\n            isDragging = false;\n\n            const {\n                colIndex\n            } = $.data($resizingCell);\n            this.setColumnWidth(colIndex);\n            this.style.setBodyStyle();\n            $resizingCell = null;\n        };\n        $.on(document.body, 'mouseup', onMouseup);\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'mouseup', onMouseup);\n        });\n\n        const onMouseMove = (e) => {\n            if (!isDragging) return;\n            const finalWidth = startWidth + (e.pageX - startX);\n            const {\n                colIndex\n            } = $.data($resizingCell);\n\n            let columnMinWidth = 30;\n            if (columnMinWidth > finalWidth) {\n                // don't resize past 30 pixels\n                return;\n            }\n            this.datamanager.updateColumn(colIndex, {\n                width: finalWidth\n            });\n            this.setColumnHeaderWidth(colIndex);\n        };\n        $.on(document.body, 'mousemove', onMouseMove);\n        this.instance.on('onDestroy', () => {\n            $.off(document.body, 'mousemove', onMouseMove);\n        });\n    }\n\n    bindPerfectColumnWidth() {\n        $.on(this.header, 'dblclick', '.dt-cell .dt-cell__resize-handle', (e, $handle) => {\n            const $cell = $handle.parentNode.parentNode;\n            const { colIndex } = $.data($cell);\n\n            let longestCell = this.bodyRenderer.visibleRows\n                .map(d => d[colIndex])\n                .reduce((acc, curr) => acc.content.length > curr.content.length ? acc : curr);\n\n            let $longestCellHTML = this.cellmanager.getCellHTML(longestCell);\n            let $div = document.createElement('div');\n            $div.innerHTML = $longestCellHTML;\n            let cellText = $div.querySelector('.dt-cell__content').textContent;\n\n            let {\n                borderLeftWidth,\n                borderRightWidth,\n                paddingLeft,\n                paddingRight\n            } = $.getStyle(this.bodyScrollable.querySelector('.dt-cell__content'));\n\n            let padding = [borderLeftWidth, borderRightWidth, paddingLeft, paddingRight]\n                .map(parseFloat)\n                .reduce((sum, val) => sum + val);\n\n            let width = $.measureTextWidth(cellText) + padding;\n            this.datamanager.updateColumn(colIndex, { width });\n            this.setColumnHeaderWidth(colIndex);\n            this.setColumnWidth(colIndex);\n        });\n    }\n\n    bindMoveColumn() {\n        const $parent = $('.dt-row', this.header);\n\n        this.sortable = Sortable.create($parent, {\n            onEnd: (e) => {\n                const {\n                    oldIndex,\n                    newIndex\n                } = e;\n                const $draggedCell = e.item;\n                const {\n                    colIndex\n                } = $.data($draggedCell);\n                if (+colIndex === newIndex) return;\n\n                this.switchColumn(oldIndex, newIndex);\n            },\n            preventOnFilter: false,\n            filter: '.dt-cell__resize-handle, .dt-dropdown',\n            chosenClass: 'dt-cell--dragging',\n            animation: 150\n        });\n    }\n\n    sortColumn(colIndex, nextSortOrder) {\n        this.instance.freeze();\n        this.sortRows(colIndex, nextSortOrder)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => this.instance.unfreeze())\n            .then(() => {\n                this.fireEvent('onSortColumn', this.getColumn(colIndex));\n            });\n    }\n\n    removeColumn(colIndex) {\n        const removedCol = this.getColumn(colIndex);\n        this.instance.freeze();\n        this.datamanager.removeColumn(colIndex)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => this.instance.unfreeze())\n            .then(() => {\n                this.fireEvent('onRemoveColumn', removedCol);\n            });\n    }\n\n    switchColumn(oldIndex, newIndex) {\n        this.instance.freeze();\n        this.datamanager.switchColumn(oldIndex, newIndex)\n            .then(() => {\n                this.refreshHeader();\n                return this.rowmanager.refreshRows();\n            })\n            .then(() => {\n                this.setColumnWidth(oldIndex);\n                this.setColumnWidth(newIndex);\n                this.instance.unfreeze();\n            })\n            .then(() => {\n                this.fireEvent('onSwitchColumn',\n                    this.getColumn(oldIndex), this.getColumn(newIndex)\n                );\n            });\n    }\n\n    toggleFilter(flag) {\n        if (!this.options.inlineFilters) return;\n\n        let showFilter;\n        if (flag === undefined) {\n            showFilter = !this.isFilterShown;\n        } else {\n            showFilter = flag;\n        }\n\n        if (showFilter) {\n            $.style(this.$filterRow, { display: '' });\n        } else {\n            $.style(this.$filterRow, { display: 'none' });\n        }\n\n        this.isFilterShown = showFilter;\n        this.style.setBodyStyle();\n    }\n\n    focusFilter(colIndex) {\n        if (!this.isFilterShown) return;\n\n        const $filterInput = $(`.dt-cell--col-${colIndex} .dt-filter`, this.$filterRow);\n        $filterInput.focus();\n    }\n\n    bindFilter() {\n        if (!this.options.inlineFilters) return;\n        const handler = e => {\n            this.applyFilter(this.getAppliedFilters());\n        };\n        $.on(this.header, 'keydown', '.dt-filter', debounce$1(handler, 300));\n    }\n\n    applyFilter(filters) {\n        this.datamanager.filterRows(filters)\n            .then(({\n                rowsToShow\n            }) => {\n                this.rowmanager.showRows(rowsToShow);\n            });\n    }\n\n    getAppliedFilters() {\n        const filters = {};\n        $.each('.dt-filter', this.header).map((input) => {\n            const value = input.value;\n            if (value) {\n                filters[input.dataset.colIndex] = value;\n            }\n        });\n        return filters;\n    }\n\n    applyDefaultSortOrder() {\n        // sort rows if any 1 column has a default sortOrder set\n        const columnsToSort = this.getColumns().filter(col => col.sortOrder !== 'none');\n\n        if (columnsToSort.length === 1) {\n            const column = columnsToSort[0];\n            this.sortColumn(column.colIndex, column.sortOrder);\n        }\n    }\n\n    sortRows(colIndex, sortOrder) {\n        return this.datamanager.sortRows(colIndex, sortOrder);\n    }\n\n    getColumn(colIndex) {\n        return this.datamanager.getColumn(colIndex);\n    }\n\n    getColumns() {\n        return this.datamanager.getColumns();\n    }\n\n    setColumnWidth(colIndex, width) {\n        colIndex = +colIndex;\n\n        let columnWidth = width || this.getColumn(colIndex).width;\n\n        const selector = [\n            `.dt-cell__content--col-${colIndex}`,\n            `.dt-cell__edit--col-${colIndex}`\n        ].join(', ');\n\n        const styles = {\n            width: columnWidth + 'px'\n        };\n\n        this.style.setStyle(selector, styles);\n    }\n\n    setColumnHeaderWidth(colIndex) {\n        colIndex = +colIndex;\n        this.$columnMap = this.$columnMap || [];\n        const selector = `.dt-cell__content--header-${colIndex}`;\n        const {\n            width\n        } = this.getColumn(colIndex);\n\n        let $column = this.$columnMap[colIndex];\n        if (!$column) {\n            $column = this.header.querySelector(selector);\n            this.$columnMap[colIndex] = $column;\n        }\n\n        $column.style.width = width + 'px';\n    }\n\n    getColumnMinWidth(colIndex) {\n        colIndex = +colIndex;\n        return this.getColumn(colIndex).minWidth || 24;\n    }\n\n    getFirstColumnIndex() {\n        return this.datamanager.getColumnIndexById('_rowIndex') + 1;\n    }\n\n    getHeaderCell$(colIndex) {\n        return $(`.dt-cell--header-${colIndex}`, this.header);\n    }\n\n    getLastColumnIndex() {\n        return this.datamanager.getColumnCount() - 1;\n    }\n\n    getDropdownHTML() {\n        const { dropdownButton } = this.options;\n\n        return `\n            <div class=\"dt-dropdown\">\n                <div class=\"dt-dropdown__toggle\">${dropdownButton}</div>\n            </div>\n      `;\n    }\n\n    getDropdownListHTML() {\n        const { headerDropdown: dropdownItems } = this.options;\n\n        return `\n            <div class=\"dt-dropdown__list\">\n            ${dropdownItems.map((d, i) => `\n                <div class=\"dt-dropdown__list-item\" data-index=\"${i}\">${d.label}</div>\n            `).join('')}\n            </div>\n        `;\n    }\n}\n\nclass RowManager {\n    constructor(instance) {\n        this.instance = instance;\n        linkProperties(this, this.instance, [\n            'options',\n            'fireEvent',\n            'wrapper',\n            'bodyScrollable',\n            'bodyRenderer',\n            'style'\n        ]);\n\n        this.bindEvents();\n        this.refreshRows = nextTick(this.refreshRows, this);\n    }\n\n    get datamanager() {\n        return this.instance.datamanager;\n    }\n\n    get cellmanager() {\n        return this.instance.cellmanager;\n    }\n\n    bindEvents() {\n        this.bindCheckbox();\n    }\n\n    bindCheckbox() {\n        if (!this.options.checkboxColumn) return;\n\n        // map of checked rows\n        this.checkMap = [];\n\n        $.on(this.wrapper, 'click', '.dt-cell--col-0 [type=\"checkbox\"]', (e, $checkbox) => {\n            const $cell = $checkbox.closest('.dt-cell');\n            const {\n                rowIndex,\n                isHeader\n            } = $.data($cell);\n            const checked = $checkbox.checked;\n\n            if (isHeader) {\n                this.checkAll(checked);\n            } else {\n                this.checkRow(rowIndex, checked);\n            }\n        });\n    }\n\n    refreshRows() {\n        this.instance.renderBody();\n        this.instance.setDimensions();\n    }\n\n    refreshRow(row, rowIndex) {\n        const _row = this.datamanager.updateRow(row, rowIndex);\n\n        _row.forEach(cell => {\n            this.cellmanager.refreshCell(cell);\n        });\n    }\n\n    getCheckedRows() {\n        if (!this.checkMap) {\n            return [];\n        }\n\n        let out = [];\n        for (let rowIndex in this.checkMap) {\n            const checked = this.checkMap[rowIndex];\n            if (checked === 1) {\n                out.push(rowIndex);\n            }\n        }\n\n        return out;\n    }\n\n    highlightCheckedRows() {\n        this.getCheckedRows()\n            .map(rowIndex => this.checkRow(rowIndex, true));\n    }\n\n    checkRow(rowIndex, toggle) {\n        const value = toggle ? 1 : 0;\n        const selector = rowIndex => `.dt-cell--0-${rowIndex} [type=\"checkbox\"]`;\n        // update internal map\n        this.checkMap[rowIndex] = value;\n        // set checkbox value explicitly\n        $.each(selector(rowIndex), this.bodyScrollable)\n            .map(input => {\n                input.checked = toggle;\n            });\n        // highlight row\n        this.highlightRow(rowIndex, toggle);\n        this.showCheckStatus();\n        this.fireEvent('onCheckRow', this.datamanager.getRow(rowIndex));\n    }\n\n    checkAll(toggle) {\n        const value = toggle ? 1 : 0;\n\n        // update internal map\n        if (toggle) {\n            this.checkMap = Array.from(Array(this.getTotalRows())).map(c => value);\n        } else {\n            this.checkMap = [];\n        }\n        // set checkbox value\n        $.each('.dt-cell--col-0 [type=\"checkbox\"]', this.bodyScrollable)\n            .map(input => {\n                input.checked = toggle;\n            });\n        // highlight all\n        this.highlightAll(toggle);\n        this.showCheckStatus();\n        this.fireEvent('onCheckRow');\n    }\n\n    showCheckStatus() {\n        if (!this.options.checkedRowStatus) return;\n        const checkedRows = this.getCheckedRows();\n        const count = checkedRows.length;\n        if (count > 0) {\n            this.bodyRenderer.showToastMessage(`${count} row${count > 1 ? 's' : ''} selected`);\n        } else {\n            this.bodyRenderer.clearToastMessage();\n        }\n    }\n\n    highlightRow(rowIndex, toggle = true) {\n        const $row = this.getRow$(rowIndex);\n        if (!$row) return;\n\n        if (!toggle && this.bodyScrollable.classList.contains('dt-scrollable--highlight-all')) {\n            $row.classList.add('dt-row--unhighlight');\n            return;\n        }\n\n        if (toggle && $row.classList.contains('dt-row--unhighlight')) {\n            $row.classList.remove('dt-row--unhighlight');\n        }\n\n        this._highlightedRows = this._highlightedRows || {};\n\n        if (toggle) {\n            $row.classList.add('dt-row--highlight');\n            this._highlightedRows[rowIndex] = $row;\n        } else {\n            $row.classList.remove('dt-row--highlight');\n            delete this._highlightedRows[rowIndex];\n        }\n    }\n\n    highlightAll(toggle = true) {\n        if (toggle) {\n            this.bodyScrollable.classList.add('dt-scrollable--highlight-all');\n        } else {\n            this.bodyScrollable.classList.remove('dt-scrollable--highlight-all');\n            for (const rowIndex in this._highlightedRows) {\n                const $row = this._highlightedRows[rowIndex];\n                $row.classList.remove('dt-row--highlight');\n            }\n            this._highlightedRows = {};\n        }\n    }\n\n    showRows(rowIndices) {\n        rowIndices = ensureArray(rowIndices);\n        const rows = rowIndices.map(rowIndex => this.datamanager.getRow(rowIndex));\n        this.bodyRenderer.renderRows(rows);\n    }\n\n    showAllRows() {\n        const rowIndices = this.datamanager.getAllRowIndices();\n        this.showRows(rowIndices);\n    }\n\n    openSingleNode(rowIndex) {\n        const row = this.datamanager.getRow(rowIndex);\n        row.meta.isTreeNodeClose = false;\n\n        const childrenToShow = this.datamanager.getImmediateChildren(rowIndex);\n        const visibleRowIndices = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = uniq$1([...childrenToShow, ...visibleRowIndices]).sort(numberSortAsc);\n\n        this.showRows(rowsToShow);\n    }\n\n    closeSingleNode(rowIndex) {\n        const row = this.datamanager.getRow(rowIndex);\n        row.meta.isTreeNodeClose = true;\n\n        const rowsToHide = this.datamanager.getChildren(rowIndex);\n        const visibleRows = this.bodyRenderer.visibleRowIndices;\n        const rowsToShow = visibleRows\n            .filter(rowIndex => !rowsToHide.includes(rowIndex))\n            .sort(numberSortAsc);\n\n        rowsToHide.forEach(rowIndex => {\n            const row = this.datamanager.getRow(rowIndex);\n            if (!row.meta.isLeaf) {\n                row.meta.isTreeNodeClose = true;\n            }\n        });\n\n        this.showRows(rowsToShow);\n    }\n\n    expandAllNodes() {\n        let rows = this.datamanager.getRows();\n        let rootNodes = rows.filter(row => !row.meta.isLeaf);\n        rootNodes.map(row => {\n            this.openSingleNode(row.meta.rowIndex);\n        });\n    }\n\n    collapseAllNodes() {\n        let rows = this.datamanager.getRows();\n        let rootNodes = rows.filter(row => row.meta.indent === 0);\n        rootNodes.map(row => {\n            this.closeSingleNode(row.meta.rowIndex);\n        });\n    }\n\n    getRow$(rowIndex) {\n        return $(this.selector(rowIndex), this.bodyScrollable);\n    }\n\n    getTotalRows() {\n        return this.datamanager.getRowCount();\n    }\n\n    getFirstRowIndex() {\n        return 0;\n    }\n\n    getLastRowIndex() {\n        return this.datamanager.getRowCount() - 1;\n    }\n\n    scrollToRow(rowIndex) {\n        rowIndex = +rowIndex;\n        this._lastScrollTo = this._lastScrollTo || 0;\n        const $row = this.getRow$(rowIndex);\n        if ($.inViewport($row, this.bodyScrollable)) return;\n\n        const {\n            height\n        } = $row.getBoundingClientRect();\n        const {\n            top,\n            bottom\n        } = this.bodyScrollable.getBoundingClientRect();\n        const rowsInView = Math.floor((bottom - top) / height);\n\n        let offset = 0;\n        if (rowIndex > this._lastScrollTo) {\n            offset = height * ((rowIndex + 1) - rowsInView);\n        } else {\n            offset = height * ((rowIndex + 1) - 1);\n        }\n\n        this._lastScrollTo = rowIndex;\n        $.scrollTop(this.bodyScrollable, offset);\n    }\n\n    getRowHTML(row, props) {\n        const dataAttr = makeDataAttributeString(props);\n        let rowIdentifier = props.rowIndex;\n\n        if (props.isFilter) {\n            row = row.map(cell => (Object.assign({}, cell, {\n                content: this.getFilterInput({\n                    colIndex: cell.colIndex\n                }),\n                isFilter: 1,\n                isHeader: undefined,\n                editable: false\n            })));\n\n            rowIdentifier = 'filter';\n        }\n\n        if (props.isHeader) {\n            rowIdentifier = 'header';\n        }\n\n        return `\n            <div class=\"dt-row dt-row-${rowIdentifier}\" ${dataAttr}>\n                ${row.map(cell => this.cellmanager.getCellHTML(cell)).join('')}\n            </div>\n        `;\n    }\n\n    getFilterInput(props) {\n        const dataAttr = makeDataAttributeString(props);\n        return `<input class=\"dt-filter dt-input\" type=\"text\" ${dataAttr} tabindex=\"1\" />`;\n    }\n\n    selector(rowIndex) {\n        return `.dt-row-${rowIndex}`;\n    }\n}\n\nvar hyperlist = createCommonjsModule(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof commonjsRequire==\"function\"&&commonjsRequire;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r);}return n[o].exports}var i=typeof commonjsRequire==\"function\"&&commonjsRequire;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n\n// Default configuration.\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar defaultConfig = {\n  width: '100%',\n  height: '100%'\n};\n\n// Check for valid number.\nvar isNumber = function isNumber(input) {\n  return Number(input) === Number(input);\n};\n\n/**\n * Creates a HyperList instance that virtually scrolls very large amounts of\n * data effortlessly.\n */\n\nvar HyperList = function () {\n  _createClass(HyperList, null, [{\n    key: 'create',\n    value: function create(element, userProvidedConfig) {\n      return new HyperList(element, userProvidedConfig);\n    }\n\n    /**\n     * Merge given css style on an element\n     * @param {DOMElement} element\n     * @param {Object} style\n     */\n\n  }, {\n    key: 'mergeStyle',\n    value: function mergeStyle(element, style) {\n      for (var i in style) {\n        if (element.style[i] !== style[i]) {\n          element.style[i] = style[i];\n        }\n      }\n    }\n  }, {\n    key: 'getMaxBrowserHeight',\n    value: function getMaxBrowserHeight() {\n      // Create two elements, the wrapper is `1px` tall and is transparent and\n      // positioned at the top of the page. Inside that is an element that gets\n      // set to 1 billion pixels. Then reads the max height the browser can\n      // calculate.\n      var wrapper = document.createElement('div');\n      var fixture = document.createElement('div');\n\n      // As said above, these values get set to put the fixture elements into the\n      // right visual state.\n      HyperList.mergeStyle(wrapper, { position: 'absolute', height: '1px', opacity: 0 });\n      HyperList.mergeStyle(fixture, { height: '1e7px' });\n\n      // Add the fixture into the wrapper element.\n      wrapper.appendChild(fixture);\n\n      // Apply to the page, the values won't kick in unless this is attached.\n      document.body.appendChild(wrapper);\n\n      // Get the maximum element height in pixels.\n      var maxElementHeight = fixture.offsetHeight;\n\n      // Remove the element immediately after reading the value.\n      document.body.removeChild(wrapper);\n\n      return maxElementHeight;\n    }\n  }]);\n\n  function HyperList(element, userProvidedConfig) {\n    var _this = this;\n\n    _classCallCheck(this, HyperList);\n\n    this._config = {};\n    this._lastRepaint = null;\n    this._maxElementHeight = HyperList.getMaxBrowserHeight();\n\n    this.refresh(element, userProvidedConfig);\n\n    var config = this._config;\n\n    // Create internal render loop.\n    var render = function render() {\n      var scrollTop = _this._getScrollPosition();\n      var lastRepaint = _this._lastRepaint;\n\n      _this._renderAnimationFrame = window.requestAnimationFrame(render);\n\n      if (scrollTop === lastRepaint) {\n        return;\n      }\n\n      if (!lastRepaint || Math.abs(scrollTop - lastRepaint) > _this._averageHeight) {\n        var rendered = _this._renderChunk();\n\n        _this._lastRepaint = scrollTop;\n\n        if (rendered !== false && typeof config.afterRender === 'function') {\n          config.afterRender();\n        }\n      }\n    };\n\n    render();\n  }\n\n  _createClass(HyperList, [{\n    key: 'destroy',\n    value: function destroy() {\n      window.cancelAnimationFrame(this._renderAnimationFrame);\n    }\n  }, {\n    key: 'refresh',\n    value: function refresh(element, userProvidedConfig) {\n      var _this2 = this;\n\n      Object.assign(this._config, defaultConfig, userProvidedConfig);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('HyperList requires a valid DOM Node container');\n      }\n\n      this._element = element;\n\n      var config = this._config;\n\n      var scroller = this._scroller || config.scroller || document.createElement(config.scrollerTagName || 'tr');\n\n      // Default configuration option `useFragment` to `true`.\n      if (typeof config.useFragment !== 'boolean') {\n        this._config.useFragment = true;\n      }\n\n      if (!config.generate) {\n        throw new Error('Missing required `generate` function');\n      }\n\n      if (!isNumber(config.total)) {\n        throw new Error('Invalid required `total` value, expected number');\n      }\n\n      if (!Array.isArray(config.itemHeight) && !isNumber(config.itemHeight)) {\n        throw new Error('\\n        Invalid required `itemHeight` value, expected number or array\\n      '.trim());\n      } else if (isNumber(config.itemHeight)) {\n        this._itemHeights = Array(config.total).fill(config.itemHeight);\n      } else {\n        this._itemHeights = config.itemHeight;\n      }\n\n      // Width and height should be coerced to string representations. Either in\n      // `%` or `px`.\n      Object.keys(defaultConfig).filter(function (prop) {\n        return prop in config;\n      }).forEach(function (prop) {\n        var value = config[prop];\n        var isValueNumber = isNumber(value);\n        var isValuePercent = isValueNumber ? false : value.slice(-1) === '%';\n\n        if (value && typeof value !== 'string' && typeof value !== 'number') {\n          var msg = 'Invalid optional `' + prop + '`, expected string or number';\n          throw new Error(msg);\n        } else if (isValueNumber) {\n          config[prop] = value + 'px';\n        }\n\n        if (prop !== 'height') {\n          return;\n        }\n\n        // Compute the containerHeight as number\n        var numberValue = isValueNumber ? value : parseInt(value.replace(/px|%/, ''), 10);\n\n        if (isValuePercent) {\n          _this2._containerHeight = window.innerHeight * numberValue / 100;\n        } else {\n          _this2._containerHeight = isNumber(value) ? value : numberValue;\n        }\n      });\n\n      // Decorate the container element with styles that will match\n      // the user supplied configuration.\n      var elementStyle = {\n        width: '' + config.width,\n        height: '' + config.height,\n        overflow: 'auto',\n        position: 'relative'\n      };\n\n      HyperList.mergeStyle(element, elementStyle);\n\n      var scrollerHeight = config.itemHeight * config.total;\n      var maxElementHeight = this._maxElementHeight;\n\n      if (scrollerHeight > maxElementHeight) {\n        console.warn(['HyperList: The maximum element height', maxElementHeight + 'px has', 'been exceeded; please reduce your item height.'].join(' '));\n      }\n\n      var scrollerStyle = {\n        opacity: '0',\n        position: 'absolute',\n        width: '1px',\n        height: scrollerHeight + 'px'\n      };\n\n      HyperList.mergeStyle(scroller, scrollerStyle);\n\n      // Only append the scroller element once.\n      if (!this._scroller) {\n        element.appendChild(scroller);\n      }\n\n      // Set the scroller instance.\n      this._scroller = scroller;\n      this._scrollHeight = this._computeScrollHeight();\n\n      // Reuse the item positions if refreshed, otherwise set to empty array.\n      this._itemPositions = this._itemPositions || Array(config.total).fill(0);\n\n      // Each index in the array should represent the position in the DOM.\n      this._computePositions(0);\n\n      // Render after refreshing. Force render if we're calling refresh manually.\n      this._renderChunk(this._lastRepaint !== null);\n\n      if (typeof config.afterRender === 'function') {\n        config.afterRender();\n      }\n    }\n  }, {\n    key: '_getRow',\n    value: function _getRow(i) {\n      var config = this._config;\n      var item = config.generate(i);\n      var height = item.height;\n\n      if (height !== undefined && isNumber(height)) {\n        item = item.element;\n\n        // The height isn't the same as predicted, compute positions again\n        if (height !== this._itemHeights) {\n          this._itemHeights[i] = height;\n          this._computePositions(i);\n          this._scrollHeight = this._computeScrollHeight(i);\n        }\n      } else {\n        height = this._itemHeights[i];\n      }\n\n      if (!item || item.nodeType !== 1) {\n        throw new Error('Generator did not return a DOM Node for index: ' + i);\n      }\n\n      var oldClass = item.getAttribute('class') || '';\n      item.setAttribute('class', oldClass + ' ' + (config.rowClassName || 'vrow'));\n\n      var top = this._itemPositions[i];\n\n      HyperList.mergeStyle(item, {\n        position: 'absolute',\n        top: top + 'px'\n      });\n\n      return item;\n    }\n  }, {\n    key: '_getScrollPosition',\n    value: function _getScrollPosition() {\n      var config = this._config;\n\n      if (typeof config.overrideScrollPosition === 'function') {\n        return config.overrideScrollPosition();\n      }\n\n      return this._element.scrollTop;\n    }\n  }, {\n    key: '_renderChunk',\n    value: function _renderChunk(force) {\n      var config = this._config;\n      var element = this._element;\n      var scrollTop = this._getScrollPosition();\n      var total = config.total;\n\n      var from = config.reverse ? this._getReverseFrom(scrollTop) : this._getFrom(scrollTop) - 1;\n\n      if (from < 0 || from - this._screenItemsLen < 0) {\n        from = 0;\n      }\n\n      if (!force && this._lastFrom === from) {\n        return false;\n      }\n\n      this._lastFrom = from;\n\n      var to = from + this._cachedItemsLen;\n\n      if (to > total || to + this._cachedItemsLen > total) {\n        to = total;\n      }\n\n      // Append all the new rows in a document fragment that we will later append\n      // to the parent node\n      var fragment = config.useFragment ? document.createDocumentFragment() : []\n      // Sometimes you'll pass fake elements to this tool and Fragments require\n      // real elements.\n\n\n      // The element that forces the container to scroll.\n      ;var scroller = this._scroller;\n\n      // Keep the scroller in the list of children.\n      fragment[config.useFragment ? 'appendChild' : 'push'](scroller);\n\n      for (var i = from; i < to; i++) {\n        var row = this._getRow(i);\n\n        fragment[config.useFragment ? 'appendChild' : 'push'](row);\n      }\n\n      if (config.applyPatch) {\n        return config.applyPatch(element, fragment);\n      }\n\n      element.innerHTML = '';\n      element.appendChild(fragment);\n    }\n  }, {\n    key: '_computePositions',\n    value: function _computePositions() {\n      var from = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];\n\n      var config = this._config;\n      var total = config.total;\n      var reverse = config.reverse;\n\n      if (from < 1 && !reverse) {\n        from = 1;\n      }\n\n      for (var i = from; i < total; i++) {\n        if (reverse) {\n          if (i === 0) {\n            this._itemPositions[0] = this._scrollHeight - this._itemHeights[0];\n          } else {\n            this._itemPositions[i] = this._itemPositions[i - 1] - this._itemHeights[i];\n          }\n        } else {\n          this._itemPositions[i] = this._itemHeights[i - 1] + this._itemPositions[i - 1];\n        }\n      }\n    }\n  }, {\n    key: '_computeScrollHeight',\n    value: function _computeScrollHeight() {\n      var _this3 = this;\n\n      var config = this._config;\n      var total = config.total;\n      var scrollHeight = this._itemHeights.reduce(function (a, b) {\n        return a + b;\n      }, 0);\n\n      HyperList.mergeStyle(this._scroller, {\n        opacity: 0,\n        position: 'absolute',\n        width: '1px',\n        height: scrollHeight + 'px'\n      });\n\n      // Calculate the height median\n      var sortedItemHeights = this._itemHeights.slice(0).sort(function (a, b) {\n        return a - b;\n      });\n      var middle = Math.floor(total / 2);\n      var averageHeight = total % 2 === 0 ? (sortedItemHeights[middle] + sortedItemHeights[middle - 1]) / 2 : sortedItemHeights[middle];\n\n      var containerHeight = this._element.clientHeight ? this._element.clientHeight : this._containerHeight;\n      this._screenItemsLen = Math.ceil(containerHeight / averageHeight);\n      this._containerHeight = containerHeight;\n\n      // Cache 3 times the number of items that fit in the container viewport.\n      this._cachedItemsLen = Math.max(this._cachedItemsLen || 0, this._screenItemsLen * 3);\n      this._averageHeight = averageHeight;\n\n      if (config.reverse) {\n        window.requestAnimationFrame(function () {\n          _this3._element.scrollTop = scrollHeight;\n        });\n      }\n\n      return scrollHeight;\n    }\n  }, {\n    key: '_getFrom',\n    value: function _getFrom(scrollTop) {\n      var i = 0;\n\n      while (this._itemPositions[i] < scrollTop) {\n        i++;\n      }\n\n      return i;\n    }\n  }, {\n    key: '_getReverseFrom',\n    value: function _getReverseFrom(scrollTop) {\n      var i = this._config.total - 1;\n\n      while (i > 0 && this._itemPositions[i] < scrollTop + this._containerHeight) {\n        i--;\n      }\n\n      return i;\n    }\n  }]);\n\n  return HyperList;\n}();\n\nexports.default = HyperList;\nmodule.exports = exports['default'];\n\n},{}]},{},[1])(1)\n});\n});\n\nvar HyperList = unwrapExports(hyperlist);\n\nclass BodyRenderer {\n    constructor(instance) {\n        this.instance = instance;\n        this.options = instance.options;\n        this.datamanager = instance.datamanager;\n        this.rowmanager = instance.rowmanager;\n        this.cellmanager = instance.cellmanager;\n        this.bodyScrollable = instance.bodyScrollable;\n        this.footer = this.instance.footer;\n        this.log = instance.log;\n    }\n\n    renderRows(rows) {\n        this.visibleRows = rows;\n        this.visibleRowIndices = rows.map(row => row.meta.rowIndex);\n\n        const rowViewOrder = this.datamanager.rowViewOrder.map(index => {\n            if (this.visibleRowIndices.includes(index)) {\n                return index;\n            }\n            return null;\n        }).filter(index => index !== null);\n\n        const computedStyle = getComputedStyle(this.bodyScrollable);\n\n        let config = {\n            width: computedStyle.width,\n            height: computedStyle.height,\n            itemHeight: this.options.cellHeight,\n            total: rows.length,\n            generate: (index) => {\n                const el = document.createElement('div');\n                const rowIndex = rowViewOrder[index];\n                const row = this.datamanager.getRow(rowIndex);\n                const rowHTML = this.rowmanager.getRowHTML(row, row.meta);\n                el.innerHTML = rowHTML;\n                return el.children[0];\n            },\n            afterRender: () => {\n                this.restoreState();\n            }\n        };\n\n        if (!this.hyperlist) {\n            this.hyperlist = new HyperList(this.bodyScrollable, config);\n        } else {\n            this.hyperlist.refresh(this.bodyScrollable, config);\n        }\n\n        this.renderFooter();\n    }\n\n    render() {\n        const rows = this.datamanager.getRowsForView();\n        this.renderRows(rows);\n        // setDimensions requires atleast 1 row to exist in dom\n        this.instance.setDimensions();\n    }\n\n    renderFooter() {\n        if (!this.options.showTotalRow) return;\n\n        const totalRow = this.getTotalRow();\n        let html = this.rowmanager.getRowHTML(totalRow, { isTotalRow: 1, rowIndex: 'totalRow' });\n\n        this.footer.innerHTML = html;\n    }\n\n    getTotalRow() {\n        const columns = this.datamanager.getColumns();\n        const totalRowTemplate = columns.map(col => {\n            let content = null;\n            if (['_rowIndex', '_checkbox'].includes(col.id)) {\n                content = '';\n            }\n            return {\n                content,\n                isTotalRow: 1,\n                colIndex: col.colIndex,\n                column: col\n            };\n        });\n\n        const totalRow = totalRowTemplate.map((cell, i) => {\n            if (cell.content === '') return cell;\n\n            if (this.options.hooks.columnTotal) {\n                const columnValues = this.visibleRows.map(row => row[i].content);\n                const result = this.options.hooks.columnTotal.call(this.instance, columnValues, cell);\n                if (result != null) {\n                    cell.content = result;\n                    return cell;\n                }\n            }\n\n            cell.content = this.visibleRows.reduce((acc, prevRow) => {\n                const prevCell = prevRow[i];\n                if (typeof prevCell.content === 'number') {\n                    if (acc == null) acc = 0;\n                    return acc + prevCell.content;\n                }\n                return acc;\n            }, cell.content);\n\n            return cell;\n        });\n\n        return totalRow;\n    }\n\n    restoreState() {\n        this.rowmanager.highlightCheckedRows();\n        this.cellmanager.selectAreaOnClusterChanged();\n        this.cellmanager.focusCellOnClusterChanged();\n    }\n\n    showToastMessage(message, hideAfter) {\n        this.instance.toastMessage.innerHTML = this.getToastMessageHTML(message);\n\n        if (hideAfter) {\n            setTimeout(() => {\n                this.clearToastMessage();\n            }, hideAfter * 1000);\n        }\n    }\n\n    clearToastMessage() {\n        this.instance.toastMessage.innerHTML = '';\n    }\n\n    getNoDataHTML() {\n        return `<div class=\"dt-scrollable__no-data\">${this.options.noDataMessage}</div>`;\n    }\n\n    getToastMessageHTML(message) {\n        return `<span class=\"dt-toast__message\">${message}</span>`;\n    }\n}\n\nclass Style {\n    constructor(instance) {\n        this.instance = instance;\n\n        linkProperties(this, this.instance, [\n            'options', 'datamanager', 'columnmanager',\n            'header', 'footer', 'bodyScrollable', 'datatableWrapper',\n            'getColumn', 'bodyRenderer'\n        ]);\n\n        this.scopeClass = 'dt-instance-' + instance.constructor.instances;\n        instance.datatableWrapper.classList.add(this.scopeClass);\n\n        const styleEl = document.createElement('style');\n        instance.wrapper.insertBefore(styleEl, instance.datatableWrapper);\n        this.styleEl = styleEl;\n\n        this.bindResizeWindow();\n        this.bindScrollHeader();\n    }\n\n    get stylesheet() {\n        return this.styleEl.sheet;\n    }\n\n    bindResizeWindow() {\n        this.onWindowResize = this.onWindowResize.bind(this);\n        this.onWindowResize = throttle$1(this.onWindowResize, 300);\n\n        if (this.options.layout === 'fluid') {\n            $.on(window, 'resize', this.onWindowResize);\n        }\n    }\n\n    bindScrollHeader() {\n        this._settingHeaderPosition = false;\n\n        $.on(this.bodyScrollable, 'scroll', (e) => {\n            if (this._settingHeaderPosition) return;\n\n            this._settingHeaderPosition = true;\n\n            requestAnimationFrame(() => {\n                const scrollLeft = e.target.scrollLeft;\n                $.style(this.header, {\n                    transform: `translateX(-${scrollLeft}px)`\n                });\n                $.style(this.footer, {\n                    transform: `translateX(-${scrollLeft}px)`\n                });\n                this._settingHeaderPosition = false;\n            });\n        });\n    }\n\n    onWindowResize() {\n        this.distributeRemainingWidth();\n        this.refreshColumnWidth();\n        this.setBodyStyle();\n    }\n\n    destroy() {\n        this.styleEl.remove();\n        $.off(window, 'resize', this.onWindowResize);\n    }\n\n    setStyle(selector, styleObject) {\n        if (selector.includes(',')) {\n            selector.split(',')\n                .map(s => s.trim())\n                .forEach(selector => {\n                    this.setStyle(selector, styleObject);\n                });\n            return;\n        }\n\n        selector = selector.trim();\n        if (!selector) return;\n\n        this._styleRulesMap = this._styleRulesMap || {};\n        const prefixedSelector = this._getPrefixedSelector(selector);\n\n        if (this._styleRulesMap[prefixedSelector]) {\n            this.removeStyle(selector);\n\n            // merge with old styleobject\n            styleObject = Object.assign({}, this._styleRulesMap[prefixedSelector], styleObject);\n        }\n\n        const styleString = this._getRuleString(styleObject);\n        const ruleString = `${prefixedSelector} { ${styleString} }`;\n\n        this._styleRulesMap[prefixedSelector] = styleObject;\n        this.stylesheet.insertRule(ruleString);\n    }\n\n    removeStyle(selector) {\n        if (selector.includes(',')) {\n            selector.split(',')\n                .map(s => s.trim())\n                .forEach(selector => {\n                    this.removeStyle(selector);\n                });\n            return;\n        }\n\n        selector = selector.trim();\n        if (!selector) return;\n\n        // find and remove\n        const prefixedSelector = this._getPrefixedSelector(selector);\n        const index = Array.from(this.stylesheet.cssRules)\n            .findIndex(rule => rule.selectorText === prefixedSelector);\n\n        if (index === -1) return;\n        this.stylesheet.deleteRule(index);\n    }\n\n    _getPrefixedSelector(selector) {\n        return `.${this.scopeClass} ${selector}`;\n    }\n\n    _getRuleString(styleObject) {\n        return Object.keys(styleObject)\n            .map(prop => {\n                let dashed = prop;\n                if (!prop.includes('-')) {\n                    dashed = camelCaseToDash(prop);\n                }\n                return `${dashed}:${styleObject[prop]};`;\n            })\n            .join('');\n    }\n\n    setDimensions() {\n        this.setupMinWidth();\n        this.setupNaturalColumnWidth();\n        this.setupColumnWidth();\n        this.distributeRemainingWidth();\n        this.setColumnStyle();\n        this.setBodyStyle();\n    }\n\n    setupMinWidth() {\n        $.each('.dt-cell--header', this.header).map(col => {\n            const { colIndex } = $.data(col);\n            const column = this.getColumn(colIndex);\n\n            if (!column.minWidth) {\n                const width = $.style($('.dt-cell__content', col), 'width');\n                // only set this once\n                column.minWidth = width;\n            }\n        });\n    }\n\n    setupNaturalColumnWidth() {\n        if (!$('.dt-row')) return;\n\n        $.each('.dt-row-header .dt-cell', this.header).map($headerCell => {\n            const { colIndex } = $.data($headerCell);\n            const column = this.datamanager.getColumn(colIndex);\n            let width = $.style($('.dt-cell__content', $headerCell), 'width');\n            if (typeof width === 'number' && width >= this.options.minimumColumnWidth) {\n                column.naturalWidth = width;\n            } else {\n                column.naturalWidth = this.options.minimumColumnWidth;\n            }\n        });\n\n        // set initial width as naturally calculated by table's first row\n        $.each('.dt-row-0 .dt-cell', this.bodyScrollable).map($cell => {\n            const {\n                colIndex\n            } = $.data($cell);\n            const column = this.datamanager.getColumn(colIndex);\n\n            let naturalWidth = $.style($('.dt-cell__content', $cell), 'width');\n\n            if (column.id === '_rowIndex') {\n                naturalWidth = this.getRowIndexColumnWidth();\n                column.width = naturalWidth;\n            }\n\n            if (typeof naturalWidth === 'number' && naturalWidth >= this.options.minimumColumnWidth) {\n                column.naturalWidth = naturalWidth;\n            } else {\n                column.naturalWidth = this.options.minimumColumnWidth;\n            }\n        });\n    }\n\n    setupColumnWidth() {\n        if (this.options.layout === 'ratio') {\n            let totalWidth = $.style(this.datatableWrapper, 'width');\n\n            if (this.options.serialNoColumn) {\n                const rowIndexColumn = this.datamanager.getColumnById('_rowIndex');\n                totalWidth = totalWidth - rowIndexColumn.width - 1;\n            }\n\n            if (this.options.checkboxColumn) {\n                const rowIndexColumn = this.datamanager.getColumnById('_checkbox');\n                totalWidth = totalWidth - rowIndexColumn.width - 1;\n            }\n\n            const totalParts = this.datamanager.getColumns()\n                .map(column => {\n                    if (column.id === '_rowIndex' || column.id === '_checkbox') {\n                        return 0;\n                    }\n                    if (!column.width) {\n                        column.width = 1;\n                    }\n                    column.ratioWidth = parseInt(column.width, 10);\n                    return column.ratioWidth;\n                })\n                .reduce((a, c) => a + c);\n\n            const onePart = totalWidth / totalParts;\n\n            this.datamanager.getColumns()\n                .map(column => {\n                    if (column.id === '_rowIndex' || column.id === '_checkbox') return;\n                    column.width = Math.floor(onePart * column.ratioWidth) - 1;\n                });\n        } else {\n            this.datamanager.getColumns()\n                .map(column => {\n                    if (!column.width) {\n                        column.width = column.naturalWidth;\n                    }\n                    if (column.width < column.minWidth) {\n                        column.width = column.minWidth;\n                    }\n                });\n        }\n    }\n\n    distributeRemainingWidth() {\n        if (this.options.layout !== 'fluid') return;\n\n        const wrapperWidth = $.style(this.instance.datatableWrapper, 'width');\n        const firstRowWidth = $.style($('.dt-row', this.bodyScrollable), 'width');\n        const resizableColumns = this.datamanager.getColumns().filter(col => col.resizable);\n        const deltaWidth = (wrapperWidth - firstRowWidth) / resizableColumns.length;\n\n        resizableColumns.map(col => {\n            const width = $.style(this.getColumnHeaderElement(col.colIndex), 'width');\n            let finalWidth = Math.floor(width + deltaWidth) - 2;\n\n            this.datamanager.updateColumn(col.colIndex, {\n                width: finalWidth\n            });\n        });\n    }\n\n    setColumnStyle() {\n        // align columns\n        this.datamanager.getColumns()\n            .map(column => {\n                // alignment\n                if (!column.align) {\n                    column.align = 'left';\n                }\n                if (!['left', 'center', 'right'].includes(column.align)) {\n                    column.align = 'left';\n                }\n                this.setStyle(`.dt-cell--col-${column.colIndex}`, {\n                    'text-align': column.align\n                });\n\n                // width\n                this.columnmanager.setColumnHeaderWidth(column.colIndex);\n                this.columnmanager.setColumnWidth(column.colIndex);\n            });\n    }\n\n    refreshColumnWidth() {\n        this.datamanager.getColumns()\n            .map(column => {\n                this.columnmanager.setColumnHeaderWidth(column.colIndex);\n                this.columnmanager.setColumnWidth(column.colIndex);\n            });\n    }\n\n    setBodyStyle() {\n        const bodyWidth = $.style(this.datatableWrapper, 'width');\n        const firstRow = $('.dt-row', this.bodyScrollable);\n        const rowWidth = $.style(firstRow, 'width');\n\n        let width = bodyWidth > rowWidth ? rowWidth : bodyWidth;\n        $.style(this.bodyScrollable, {\n            width: width + 'px'\n        });\n\n        // remove the body height, so that it resets to it's original\n        $.removeStyle(this.bodyScrollable, 'height');\n\n        // when there are less rows than the container\n        // adapt the container height\n        let bodyHeight = $.getStyle(this.bodyScrollable, 'height');\n        const scrollHeight = (this.bodyRenderer.hyperlist || {})._scrollHeight || Infinity;\n        const hasHorizontalOverflow = $.hasHorizontalOverflow(this.bodyScrollable);\n\n        let height;\n\n        if (scrollHeight < bodyHeight) {\n            height = scrollHeight;\n\n            // account for scrollbar size when\n            // there is horizontal overflow\n            if (hasHorizontalOverflow) {\n                height += $.scrollbarSize();\n            }\n\n            $.style(this.bodyScrollable, {\n                height: height + 'px'\n            });\n        }\n\n        const verticalOverflow = this.bodyScrollable.scrollHeight - this.bodyScrollable.offsetHeight;\n        if (verticalOverflow < $.scrollbarSize()) {\n            // if verticalOverflow is less than scrollbar size\n            // then most likely scrollbar is causing the scroll\n            // which is not needed\n            $.style(this.bodyScrollable, {\n                overflowY: 'hidden'\n            });\n        }\n\n        if (this.options.layout === 'fluid') {\n            $.style(this.bodyScrollable, {\n                overflowX: 'hidden'\n            });\n        }\n    }\n\n    getColumnHeaderElement(colIndex) {\n        colIndex = +colIndex;\n        if (colIndex < 0) return null;\n        return $(`.dt-cell--col-${colIndex}`, this.header);\n    }\n\n    getRowIndexColumnWidth() {\n        const rowCount = this.datamanager.getRowCount();\n        const padding = 22;\n        return $.measureTextWidth(rowCount + '') + padding;\n    }\n}\n\nconst KEYCODES = {\n    13: 'enter',\n    91: 'meta',\n    16: 'shift',\n    17: 'ctrl',\n    18: 'alt',\n    37: 'left',\n    38: 'up',\n    39: 'right',\n    40: 'down',\n    9: 'tab',\n    27: 'esc',\n    67: 'c',\n    70: 'f',\n    86: 'v'\n};\n\nclass Keyboard {\n    constructor(element) {\n        this.listeners = {};\n        $.on(element, 'keydown', this.handler.bind(this));\n    }\n\n    handler(e) {\n        let key = KEYCODES[e.keyCode];\n\n        if (e.shiftKey && key !== 'shift') {\n            key = 'shift+' + key;\n        }\n\n        if ((e.ctrlKey && key !== 'ctrl') || (e.metaKey && key !== 'meta')) {\n            key = 'ctrl+' + key;\n        }\n\n        const listeners = this.listeners[key];\n\n        if (listeners && listeners.length > 0) {\n            for (let listener of listeners) {\n                const preventBubbling = listener(e);\n                if (preventBubbling === undefined || preventBubbling === true) {\n                    e.preventDefault();\n                }\n            }\n        }\n    }\n\n    on(key, listener) {\n        const keys = key.split(',').map(k => k.trim());\n\n        keys.map(key => {\n            this.listeners[key] = this.listeners[key] || [];\n            this.listeners[key].push(listener);\n        });\n    }\n}\n\nfunction filterRows(rows, filters) {\n    let filteredRowIndices = [];\n\n    if (Object.keys(filters).length === 0) {\n        return rows.map(row => row.meta.rowIndex);\n    }\n\n    for (let colIndex in filters) {\n        const keyword = filters[colIndex];\n\n        const filteredRows = filteredRowIndices.length ?\n            filteredRowIndices.map(i => rows[i]) :\n            rows;\n\n        const cells = filteredRows.map(row => row[colIndex]);\n\n        let filter = guessFilter(keyword);\n        let filterMethod = getFilterMethod(filter);\n\n        if (filterMethod) {\n            filteredRowIndices = filterMethod(filter.text, cells);\n        } else {\n            filteredRowIndices = cells.map(cell => cell.rowIndex);\n        }\n    }\n\n    return filteredRowIndices;\n}\nfunction getFilterMethod(filter) {\n    const stringCompareValue = cell =>\n        String(stripHTML(cell.html || '') || cell.content || '').toLowerCase();\n\n    const numberCompareValue = cell => parseFloat(cell.content);\n\n    const getCompareValues = (cell, keyword) => {\n        if (cell.column.compareValue) {\n            const compareValues = cell.column.compareValue(cell, keyword);\n            if (compareValues && Array.isArray(compareValues)) return compareValues;\n        }\n\n        // check if it can be converted to number\n        const float = numberCompareValue(cell);\n        if (!isNaN(float)) {\n            return [float, keyword];\n        }\n\n        return [stringCompareValue(cell), keyword];\n    };\n\n    let filterMethodMap = {\n        contains(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const hay = stringCompareValue(cell);\n                    const needle = (keyword || '').toLowerCase();\n                    return !needle || hay.includes(needle);\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        greaterThan(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const [compareValue, keywordValue] = getCompareValues(cell, keyword);\n                    return compareValue > keywordValue;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        lessThan(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const [compareValue, keywordValue] = getCompareValues(cell, keyword);\n                    return compareValue < keywordValue;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        equals(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const value = parseFloat(cell.content);\n                    return value === keyword;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        notEquals(keyword, cells) {\n            return cells\n                .filter(cell => {\n                    const value = parseFloat(cell.content);\n                    return value !== keyword;\n                })\n                .map(cell => cell.rowIndex);\n        },\n\n        range(rangeValues, cells) {\n            return cells\n                .filter(cell => {\n                    const values1 = getCompareValues(cell, rangeValues[0]);\n                    const values2 = getCompareValues(cell, rangeValues[1]);\n                    const value = values1[0];\n                    return value >= values1[1] && value <= values2[1];\n                })\n                .map(cell => cell.rowIndex);\n        }\n    };\n\n    return filterMethodMap[filter.type];\n}\n\nfunction guessFilter(keyword = '') {\n    if (keyword.length === 0) return {};\n\n    let compareString = keyword;\n\n    if (['>', '<', '='].includes(compareString[0])) {\n        compareString = keyword.slice(1);\n    } else if (compareString.startsWith('!=')) {\n        compareString = keyword.slice(2);\n    }\n\n    if (keyword.startsWith('>')) {\n        if (compareString) {\n            return {\n                type: 'greaterThan',\n                text: compareString.trim()\n            };\n        }\n    }\n\n    if (keyword.startsWith('<')) {\n        if (compareString) {\n            return {\n                type: 'lessThan',\n                text: compareString.trim()\n            };\n        }\n    }\n\n    if (keyword.startsWith('=')) {\n        if (isNumber(compareString)) {\n            return {\n                type: 'equals',\n                text: Number(keyword.slice(1).trim())\n            };\n        }\n    }\n\n    if (keyword.startsWith('!=')) {\n        if (isNumber(compareString)) {\n            return {\n                type: 'notEquals',\n                text: Number(keyword.slice(2).trim())\n            };\n        }\n    }\n\n    if (keyword.split(':').length === 2) {\n        compareString = keyword.split(':');\n        return {\n            type: 'range',\n            text: compareString.map(v => v.trim())\n        };\n    }\n\n    return {\n        type: 'contains',\n        text: compareString.toLowerCase()\n    };\n}\n\nvar DEFAULT_OPTIONS = {\n    columns: [],\n    data: [],\n    dropdownButton: icons.chevronDown,\n    headerDropdown: [\n        {\n            label: 'Sort Ascending',\n            action: function (column) {\n                this.sortColumn(column.colIndex, 'asc');\n            }\n        },\n        {\n            label: 'Sort Descending',\n            action: function (column) {\n                this.sortColumn(column.colIndex, 'desc');\n            }\n        },\n        {\n            label: 'Reset sorting',\n            action: function (column) {\n                this.sortColumn(column.colIndex, 'none');\n            }\n        },\n        {\n            label: 'Remove column',\n            action: function (column) {\n                this.removeColumn(column.colIndex);\n            }\n        }\n    ],\n    events: {\n        onRemoveColumn(column) {},\n        onSwitchColumn(column1, column2) {},\n        onSortColumn(column) {},\n        onCheckRow(row) {},\n        onDestroy() {}\n    },\n    hooks: {\n        columnTotal: null\n    },\n    sortIndicator: {\n        asc: '↑',\n        desc: '↓',\n        none: ''\n    },\n    filterRows: filterRows,\n    freezeMessage: '',\n    getEditor: null,\n    serialNoColumn: true,\n    checkboxColumn: false,\n    clusterize: true,\n    logs: false,\n    layout: 'fixed', // fixed, fluid, ratio\n    noDataMessage: 'No Data',\n    cellHeight: 40,\n    minimumColumnWidth: 70,\n    inlineFilters: false,\n    treeView: false,\n    checkedRowStatus: true,\n    dynamicRowHeight: false,\n    pasteFromClipboard: false,\n    showTotalRow: false\n};\n\nclass DataTable {\n    constructor(wrapper, options) {\n        DataTable.instances++;\n\n        if (typeof wrapper === 'string') {\n            // css selector\n            wrapper = document.querySelector(wrapper);\n        }\n        this.wrapper = wrapper;\n        if (!(this.wrapper instanceof HTMLElement)) {\n            throw new Error('Invalid argument given for `wrapper`');\n        }\n\n        this.buildOptions(options);\n        this.prepare();\n\n        this.style = new Style(this);\n        this.keyboard = new Keyboard(this.wrapper);\n        this.datamanager = new DataManager(this.options);\n        this.rowmanager = new RowManager(this);\n        this.columnmanager = new ColumnManager(this);\n        this.cellmanager = new CellManager(this);\n        this.bodyRenderer = new BodyRenderer(this);\n\n        if (this.options.data) {\n            this.refresh();\n            this.columnmanager.applyDefaultSortOrder();\n        }\n    }\n\n    buildOptions(options) {\n        this.options = this.options || {};\n\n        this.options = Object.assign(\n            {}, DEFAULT_OPTIONS,\n            this.options || {}, options\n        );\n\n        options.headerDropdown = options.headerDropdown || [];\n        this.options.headerDropdown = [\n            ...DEFAULT_OPTIONS.headerDropdown,\n            ...options.headerDropdown\n        ];\n\n        // custom user events\n        this.events = Object.assign(\n            {}, DEFAULT_OPTIONS.events,\n            this.options.events || {},\n            options.events || {}\n        );\n        this.fireEvent = this.fireEvent.bind(this);\n    }\n\n    prepare() {\n        this.prepareDom();\n        this.unfreeze();\n    }\n\n    prepareDom() {\n        this.wrapper.innerHTML = `\n            <div class=\"datatable\">\n                <div class=\"dt-header\"></div>\n                <div class=\"dt-scrollable\"></div>\n                <div class=\"dt-footer\"></div>\n                <div class=\"dt-freeze\">\n                    <span class=\"dt-freeze__message\">\n                        ${this.options.freezeMessage}\n                    </span>\n                </div>\n                <div class=\"dt-toast\"></div>\n                <div class=\"dt-dropdown-container\"></div>\n                <textarea class=\"dt-paste-target\"></textarea>\n            </div>\n        `;\n\n        this.datatableWrapper = $('.datatable', this.wrapper);\n        this.header = $('.dt-header', this.wrapper);\n        this.footer = $('.dt-footer', this.wrapper);\n        this.bodyScrollable = $('.dt-scrollable', this.wrapper);\n        this.freezeContainer = $('.dt-freeze', this.wrapper);\n        this.toastMessage = $('.dt-toast', this.wrapper);\n        this.pasteTarget = $('.dt-paste-target', this.wrapper);\n        this.dropdownContainer = $('.dt-dropdown-container', this.wrapper);\n    }\n\n    refresh(data, columns) {\n        this.datamanager.init(data, columns);\n        this.render();\n        this.setDimensions();\n    }\n\n    destroy() {\n        this.wrapper.innerHTML = '';\n        this.style.destroy();\n        this.fireEvent('onDestroy');\n    }\n\n    appendRows(rows) {\n        this.datamanager.appendRows(rows);\n        this.rowmanager.refreshRows();\n    }\n\n    refreshRow(row, rowIndex) {\n        this.rowmanager.refreshRow(row, rowIndex);\n    }\n\n    render() {\n        this.renderHeader();\n        this.renderBody();\n    }\n\n    renderHeader() {\n        this.columnmanager.renderHeader();\n    }\n\n    renderBody() {\n        this.bodyRenderer.render();\n    }\n\n    setDimensions() {\n        this.style.setDimensions();\n    }\n\n    showToastMessage(message, hideAfter) {\n        this.bodyRenderer.showToastMessage(message, hideAfter);\n    }\n\n    clearToastMessage() {\n        this.bodyRenderer.clearToastMessage();\n    }\n\n    getColumn(colIndex) {\n        return this.datamanager.getColumn(colIndex);\n    }\n\n    getColumns() {\n        return this.datamanager.getColumns();\n    }\n\n    getRows() {\n        return this.datamanager.getRows();\n    }\n\n    getCell(colIndex, rowIndex) {\n        return this.datamanager.getCell(colIndex, rowIndex);\n    }\n\n    getColumnHeaderElement(colIndex) {\n        return this.columnmanager.getColumnHeaderElement(colIndex);\n    }\n\n    getViewportHeight() {\n        if (!this.viewportHeight) {\n            this.viewportHeight = $.style(this.bodyScrollable, 'height');\n        }\n\n        return this.viewportHeight;\n    }\n\n    sortColumn(colIndex, sortOrder) {\n        this.columnmanager.sortColumn(colIndex, sortOrder);\n    }\n\n    removeColumn(colIndex) {\n        this.columnmanager.removeColumn(colIndex);\n    }\n\n    scrollToLastColumn() {\n        this.datatableWrapper.scrollLeft = 9999;\n    }\n\n    freeze() {\n        $.style(this.freezeContainer, {\n            display: ''\n        });\n    }\n\n    unfreeze() {\n        $.style(this.freezeContainer, {\n            display: 'none'\n        });\n    }\n\n    updateOptions(options) {\n        this.buildOptions(options);\n    }\n\n    fireEvent(eventName, ...args) {\n        // fire internalEventHandlers if any\n        // and then user events\n        const handlers = [\n            ...(this._internalEventHandlers[eventName] || []),\n            this.events[eventName]\n        ].filter(Boolean);\n\n        for (let handler of handlers) {\n            handler.apply(this, args);\n        }\n    }\n\n    on(event, handler) {\n        this._internalEventHandlers = this._internalEventHandlers || {};\n        this._internalEventHandlers[event] = this._internalEventHandlers[event] || [];\n        this._internalEventHandlers[event].push(handler);\n    }\n\n    log() {\n        if (this.options.logs) {\n            console.log.apply(console, arguments);\n        }\n    }\n}\n\nDataTable.instances = 0;\n\nvar name = \"frappe-datatable\";\nvar version = \"0.0.0-development\";\nvar description = \"A modern datatable library for the web\";\nvar main = \"dist/frappe-datatable.cjs.js\";\nvar unpkg = \"dist/frappe-datatable.min.js\";\nvar jsdelivr = \"dist/frappe-datatable.min.js\";\nvar scripts = {\"start\":\"yarn run dev\",\"build\":\"rollup -c && NODE_ENV=production rollup -c\",\"dev\":\"rollup -c -w\",\"cy:server\":\"http-server -p 8989\",\"cy:open\":\"cypress open\",\"cy:run\":\"cypress run\",\"test\":\"start-server-and-test cy:server http://localhost:8989 cy:run\",\"test-local\":\"start-server-and-test cy:server http://localhost:8989 cy:open\",\"travis-deploy-once\":\"travis-deploy-once\",\"semantic-release\":\"semantic-release\",\"lint\":\"eslint src\",\"commit\":\"npx git-cz\"};\nvar files = [\"dist\",\"src\"];\nvar devDependencies = {\"autoprefixer\":\"^9.0.0\",\"chai\":\"3.5.0\",\"cypress\":\"3.0.1\",\"cz-conventional-changelog\":\"^2.1.0\",\"deepmerge\":\"^2.0.1\",\"eslint\":\"^5.0.1\",\"eslint-config-airbnb\":\"^16.1.0\",\"eslint-config-airbnb-base\":\"^12.1.0\",\"eslint-plugin-import\":\"^2.11.0\",\"http-server\":\"^0.11.1\",\"mocha\":\"3.3.0\",\"postcss-custom-properties\":\"^7.0.0\",\"postcss-nested\":\"^3.0.0\",\"rollup\":\"^0.59.4\",\"rollup-plugin-commonjs\":\"^8.3.0\",\"rollup-plugin-eslint\":\"^4.0.0\",\"rollup-plugin-json\":\"^2.3.0\",\"rollup-plugin-node-resolve\":\"^3.0.3\",\"rollup-plugin-postcss\":\"^1.2.8\",\"rollup-plugin-uglify-es\":\"^0.0.1\",\"semantic-release\":\"^15.6.3\",\"start-server-and-test\":\"^1.4.1\",\"travis-deploy-once\":\"^5.0.1\"};\nvar repository = {\"type\":\"git\",\"url\":\"https://github.com/frappe/datatable.git\"};\nvar keywords = [\"datatable\",\"data\",\"grid\",\"table\"];\nvar author = \"Faris Ansari\";\nvar license = \"MIT\";\nvar bugs = {\"url\":\"https://github.com/frappe/datatable/issues\"};\nvar homepage = \"https://frappe.github.io/datatable\";\nvar dependencies = {\"hyperlist\":\"^1.0.0-beta\",\"lodash\":\"^4.17.5\",\"sortablejs\":\"^1.7.0\"};\nvar config = {\"commitizen\":{\"path\":\"cz-conventional-changelog\"}};\nvar packageJson = {\n\tname: name,\n\tversion: version,\n\tdescription: description,\n\tmain: main,\n\tunpkg: unpkg,\n\tjsdelivr: jsdelivr,\n\tscripts: scripts,\n\tfiles: files,\n\tdevDependencies: devDependencies,\n\trepository: repository,\n\tkeywords: keywords,\n\tauthor: author,\n\tlicense: license,\n\tbugs: bugs,\n\thomepage: homepage,\n\tdependencies: dependencies,\n\tconfig: config\n};\n\nDataTable.__version__ = packageJson.version;\n\nmodule.exports = DataTable;\n","/**\n * frappe.views.ReportView\n */\nimport DataTable from 'frappe-datatable';\n\nfrappe.provide('frappe.views');\n\nfrappe.views.ReportView = class ReportView extends frappe.views.ListView {\n\tget view_name() {\n\t\treturn 'Report';\n\t}\n\n\tsetup_defaults() {\n\t\tsuper.setup_defaults();\n\t\tthis.page_title = __('Report:') + ' ' + this.page_title;\n\t\tthis.menu_items = this.report_menu_items();\n\n\t\tconst route = frappe.get_route();\n\t\tif (route.length === 4) {\n\t\t\tthis.report_name = route[3];\n\t\t}\n\n\t\tthis.add_totals_row = this.view_user_settings.add_totals_row || 0;\n\n\t\tif (this.report_name) {\n\t\t\treturn this.get_report_doc()\n\t\t\t\t.then(doc => {\n\t\t\t\t\tthis.report_doc = doc;\n\t\t\t\t\tthis.report_doc.json = JSON.parse(this.report_doc.json);\n\n\t\t\t\t\tthis.filters = this.report_doc.json.filters;\n\t\t\t\t\tthis.order_by = this.report_doc.json.order_by;\n\t\t\t\t\tthis.add_totals_row = this.report_doc.json.add_totals_row;\n\t\t\t\t\tthis.page_title = this.report_name;\n\t\t\t\t\tthis.page_length = this.report_doc.json.page_length || 20;\n\t\t\t\t\tthis.order_by = this.report_doc.json.order_by || 'modified desc';\n\t\t\t\t});\n\t\t}\n\t}\n\n\tsetup_view() {\n\t\tthis.setup_columns();\n\t\tthis.bind_charts_button();\n\t}\n\n\tsetup_result_area() {\n\t\tsuper.setup_result_area();\n\t\tthis.$datatable_wrapper = $('<div class=\"datatable-wrapper\">');\n\t\tthis.$charts_wrapper = $('<div class=\"charts-wrapper\">');\n\t\tthis.$result.append(this.$charts_wrapper);\n\t\tthis.$result.append(this.$datatable_wrapper);\n\t}\n\n\tsetup_paging_area() {\n\t\tsuper.setup_paging_area();\n\t\tconst message = __('For comparison, use >5, <10 or =324. For ranges, use 5:10 (for values between 5 & 10).');\n\t\tthis.$paging_area.find('.level-left').append(\n\t\t\t`<p class=\"text-muted text-medium margin-left\">${message}</p>`\n\t\t)\n\t}\n\n\tsetup_sort_selector() {\n\t\tthis.sort_selector = new frappe.ui.SortSelector({\n\t\t\tparent: this.filter_area.$filter_list_wrapper,\n\t\t\tdoctype: this.doctype,\n\t\t\targs: this.order_by,\n\t\t\tonchange: this.on_sort_change.bind(this)\n\t\t});\n\t}\n\n\tbefore_refresh() {\n\t\tif (this.report_doc) {\n\t\t\t// don't parse frappe.route_options if this is a Custom Report\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn super.before_refresh();\n\t}\n\n\tafter_render() {\n\t\tif (this.report_doc) {\n\t\t\tthis.set_dirty_state_for_custom_report();\n\t\t} else {\n\t\t\tthis.save_report_settings();\n\t\t}\n\t}\n\n\tset_dirty_state_for_custom_report() {\n\t\tlet current_settings = {\n\t\t\tfilters: this.filter_area.get(),\n\t\t\tfields: this.fields,\n\t\t\torder_by: this.sort_selector.get_sql_string(),\n\t\t\tadd_totals_row: this.add_totals_row,\n\t\t\tpage_length: this.page_length,\n\t\t\tcolumn_widths: this.get_column_widths()\n\t\t}\n\n\t\tlet report_settings = {\n\t\t\tfilters: this.report_doc.json.filters,\n\t\t\tfields: this.report_doc.json.fields,\n\t\t\torder_by: this.report_doc.json.order_by,\n\t\t\tadd_totals_row: this.report_doc.json.add_totals_row,\n\t\t\tpage_length: this.report_doc.json.page_length,\n\t\t\tcolumn_widths: this.report_doc.json.column_widths\n\t\t}\n\n\t\tif (!frappe.utils.deep_equal(current_settings, report_settings)) {\n\t\t\tthis.page.set_indicator(__('Not Saved'), 'orange');\n\t\t} else {\n\t\t\tthis.page.clear_indicator();\n\t\t}\n\t}\n\n\tsave_report_settings() {\n\t\tfrappe.model.user_settings.save(this.doctype, 'last_view', this.view_name);\n\n\t\tif (!this.report_name) {\n\t\t\tthis.save_view_user_settings({\n\t\t\t\tfields: this.fields,\n\t\t\t\tfilters: this.filter_area.get(),\n\t\t\t\torder_by: this.sort_selector.get_sql_string(),\n\t\t\t\tadd_totals_row: this.add_totals_row\n\t\t\t});\n\t\t}\n\t}\n\n\tprepare_data(r) {\n\t\tlet data = r.message || {};\n\t\tdata = frappe.utils.dict(data.keys, data.values);\n\n\t\tif (this.start === 0) {\n\t\t\tthis.data = data;\n\t\t} else {\n\t\t\tthis.data = this.data.concat(data);\n\t\t}\n\t}\n\n\trender(force) {\n\t\tif (this.data.length === 0) return;\n\t\tthis.render_count();\n\t\tthis.setup_columns();\n\n\t\tif (this.chart) {\n\t\t\tthis.refresh_charts();\n\t\t}\n\t\tif (this.datatable && !force) {\n\t\t\tthis.datatable.refresh(this.get_data(this.data), this.columns);\n\t\t\treturn;\n\t\t}\n\t\tthis.setup_datatable(this.data);\n\t}\n\n\trender_count() {\n\t\tlet $list_count = this.$paging_area.find('.list-count');\n\t\tif (!$list_count.length) {\n\t\t\tthis.$paging_area.find('.btn-more').addClass('margin-left');\n\t\t\t$list_count = $('<span>')\n\t\t\t\t.addClass('text-muted text-medium list-count')\n\t\t\t\t.prependTo(this.$paging_area.find('.level-right'));\n\t\t}\n\t\tthis.get_count_str()\n\t\t\t.then(str => {\n\t\t\t\t$list_count.text(str);\n\t\t\t});\n\t}\n\n\ton_update(data) {\n\t\tif (this.doctype === data.doctype && data.name) {\n\t\t\t// flash row when doc is updated by some other user\n\t\t\tconst flash_row = data.user !== frappe.session.user;\n\t\t\tif (this.data.find(d => d.name === data.name)) {\n\t\t\t\t// update existing\n\t\t\t\tfrappe.db.get_doc(data.doctype, data.name)\n\t\t\t\t\t.then(doc => this.update_row(doc, flash_row));\n\t\t\t} else {\n\t\t\t\t// refresh\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdate_row(doc, flash_row) {\n\t\tconst to_refresh = [];\n\n\t\tthis.data = this.data.map((d, i) => {\n\t\t\tif (d.name === doc.name) {\n\t\t\t\tfor (let fieldname in d) {\n\t\t\t\t\tif (fieldname.includes(':')) {\n\t\t\t\t\t\t// child table field\n\t\t\t\t\t\tconst [cdt, _field] = fieldname.split(':');\n\t\t\t\t\t\tconst cdt_row = Object.keys(doc)\n\t\t\t\t\t\t\t.filter(key => Array.isArray(doc[key]) && doc[key][0].doctype === cdt)\n\t\t\t\t\t\t\t.map(key => doc[key])\n\t\t\t\t\t\t\t.map(a => a[0])\n\t\t\t\t\t\t\t.filter(cdoc => cdoc.name === d[cdt + ':name'])[0];\n\t\t\t\t\t\tif (cdt_row) {\n\t\t\t\t\t\t\td[fieldname] = cdt_row[_field];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\td[fieldname] = doc[fieldname];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tto_refresh.push([d, i]);\n\t\t\t}\n\t\t\treturn d;\n\t\t});\n\n\t\t// indicate row update\n\t\tconst _flash_row = (rowIndex) => {\n\t\t\tif (!flash_row) return;\n\t\t\tconst $row = this.$result.find(`.dt-row[data-row-index=\"${rowIndex}\"]`);\n\t\t\t$row.addClass('row-update');\n\t\t\tsetTimeout(() => $row.removeClass('row-update'), 500);\n\t\t};\n\n\t\tto_refresh.forEach(([data, rowIndex]) => {\n\t\t\tconst new_row = this.build_row(data);\n\t\t\tthis.datatable.refreshRow(new_row, rowIndex);\n\t\t\t_flash_row(rowIndex);\n\t\t});\n\t}\n\n\tsetup_datatable(values) {\n\t\tthis.$datatable_wrapper.empty();\n\t\tthis.datatable = new DataTable(this.$datatable_wrapper[0], {\n\t\t\tcolumns: this.columns,\n\t\t\tdata: this.get_data(values),\n\t\t\tgetEditor: this.get_editing_object.bind(this),\n\t\t\tcheckboxColumn: true,\n\t\t\tinlineFilters: true,\n\t\t\tcellHeight: 35,\n\t\t\tevents: {\n\t\t\t\tonRemoveColumn: (column) => {\n\t\t\t\t\tthis.remove_column_from_datatable(column);\n\t\t\t\t},\n\t\t\t\tonSwitchColumn: (column1, column2) => {\n\t\t\t\t\tthis.switch_column(column1, column2);\n\t\t\t\t},\n\t\t\t\tonCheckRow: () => {\n\t\t\t\t\tconst checked_items = this.get_checked_items();\n\t\t\t\t\tthis.toggle_actions_menu_button(checked_items.length > 0);\n\t\t\t\t}\n\t\t\t},\n\t\t\thooks: {\n\t\t\t\tcolumnTotal: frappe.utils.report_column_total\n\t\t\t},\n\t\t\theaderDropdown: [{\n\t\t\t\tlabel: __('Add Column'),\n\t\t\t\taction: (datatabe_col) => {\n\t\t\t\t\tlet columns_in_picker = [];\n\t\t\t\t\tconst columns = this.get_columns_for_picker();\n\n\t\t\t\t\tcolumns_in_picker = columns[this.doctype]\n\t\t\t\t\t\t.filter(df => !this.is_column_added(df))\n\t\t\t\t\t\t.map(df => ({\n\t\t\t\t\t\t\tlabel: __(df.label),\n\t\t\t\t\t\t\tvalue: df.fieldname\n\t\t\t\t\t\t}));\n\n\t\t\t\t\tdelete columns[this.doctype];\n\n\t\t\t\t\tfor (let cdt in columns) {\n\t\t\t\t\t\tcolumns[cdt]\n\t\t\t\t\t\t\t.filter(df => !this.is_column_added(df))\n\t\t\t\t\t\t\t.map(df => ({\n\t\t\t\t\t\t\t\tlabel: __(df.label) + ` (${cdt})`,\n\t\t\t\t\t\t\t\tvalue: df.fieldname + ',' + cdt\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t.forEach(df => columns_in_picker.push(df));\n\t\t\t\t\t}\n\n\t\t\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __('Add Column'),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __('Select Column'),\n\t\t\t\t\t\t\t\tfieldname: 'column',\n\t\t\t\t\t\t\t\tfieldtype: 'Autocomplete',\n\t\t\t\t\t\t\t\toptions: columns_in_picker\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __('Insert Column Before {0}', [datatabe_col.docfield.label.bold()]),\n\t\t\t\t\t\t\t\tfieldname: 'insert_before',\n\t\t\t\t\t\t\t\tfieldtype: 'Check'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action: ({ column, insert_before }) => {\n\t\t\t\t\t\t\tif (!columns_in_picker.map(col => col.value).includes(column)) {\n\t\t\t\t\t\t\t\tfrappe.show_alert(__('Invalid column'));\n\t\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet doctype = this.doctype;\n\t\t\t\t\t\t\tif (column.includes(',')) {\n\t\t\t\t\t\t\t\t[column, doctype] = column.split(',');\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tlet index = datatabe_col.colIndex;\n\t\t\t\t\t\t\tif (insert_before) {\n\t\t\t\t\t\t\t\tindex = index - 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.add_column_to_datatable(column, doctype, index);\n\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\td.show();\n\t\t\t\t}\n\t\t\t}]\n\t\t});\n\t}\n\n\tbind_charts_button() {\n\t\tthis.list_sidebar.sidebar.find('.charts-menu').removeClass('hide');\n\t\tthis.list_sidebar.sidebar.on('click', '.toggle-charts', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.toggle_charts();\n\t\t});\n\t\tthis.list_sidebar.sidebar.on('click', '.configure-charts', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.get_chart_data().then(() => this.refresh_charts());\n\t\t});\n\t\tthis.refresh_charts_sidebar_button();\n\t}\n\n\trefresh_charts_sidebar_button() {\n\t\t// show configure charts button if charts is shown\n\t\tconst $configure_btn = this.list_sidebar.sidebar.find('.configure-charts');\n\t\tconst charts_visible = this.chart && !this.$charts_wrapper.hasClass('hidden');\n\n\t\tif (charts_visible) {\n\t\t\t$configure_btn.removeClass('hidden');\n\t\t} else {\n\t\t\t$configure_btn.addClass('hidden');\n\t\t}\n\t}\n\n\ttoggle_charts() {\n\t\tif (!this.chart) {\n\t\t\tthis.setup_charts();\n\t\t\treturn;\n\t\t}\n\t\tthis.$charts_wrapper.toggleClass('hidden');\n\n\t\tif (!this.$charts_wrapper.hasClass('hidden')) {\n\t\t\tthis.chart.refresh();\n\t\t}\n\n\t\tthis.refresh_charts_sidebar_button();\n\t}\n\n\tsetup_charts() {\n\t\tthis.get_chart_data()\n\t\t\t.then(args => {\n\t\t\t\tlet data = {\n\t\t\t\t\tlabels: args.labels,\n\t\t\t\t\tdatasets: args.datasets\n\t\t\t\t};\n\n\t\t\t\tthis.last_chart_type = args.chart_type;\n\n\t\t\t\tconst get_df = (field) => frappe.meta.get_docfield(this.doctype, field);\n\t\t\t\tconst get_doc = (value, field) => this.data.find(d => d[field] === value);\n\n\t\t\t\tthis.chart = new Chart(this.$charts_wrapper[0], {\n\t\t\t\t\ttitle: __(\"{0} Chart\", [this.doctype]),\n\t\t\t\t\tdata: data,\n\t\t\t\t\ttype: args.chart_type,\n\t\t\t\t\theight: 150,\n\t\t\t\t\tcolors: ['violet', 'light-blue', 'orange', 'red'],\n\n\t\t\t\t\tformat_tooltip_x: value => value.doc.name,\n\t\t\t\t\tformat_tooltip_y:\n\t\t\t\t\t\tvalue => frappe.format(value, get_df(value.field), { always_show_decimals: true, inline: true }, get_doc(value.doc))\n\t\t\t\t});\n\n\t\t\t\tthis.refresh_charts_sidebar_button();\n\t\t\t});\n\t}\n\n\trefresh_charts() {\n\t\tif (!this.chart) return;\n\t\tconst { x_field, y_fields, chart_type } = this.chart_args;\n\t\tconst args = this.get_chart_args(x_field, y_fields, chart_type);\n\t\tthis.chart.update_values(args.datasets, args.labels);\n\t\tthis.chart.refresh();\n\n\t\tif (args.chart_type !== this.last_chart_type) {\n\t\t\tthis.chart.get_different_chart(args.chart_type);\n\t\t}\n\t}\n\n\tget_chart_data() {\n\t\treturn new Promise(resolve => {\n\t\t\tconst cur_list_fields = this.fields.map(f => f[0]);\n\t\t\tconst x_fields = this.meta.fields.filter(df =>\n\t\t\t\t!df.hidden && cur_list_fields.includes(df.fieldname)\n\t\t\t).map(df => df.fieldname);\n\t\t\tconst y_fields = this.meta.fields.filter(df =>\n\t\t\t\t!df.hidden && frappe.model.is_numeric_field(df)\n\t\t\t\t&& cur_list_fields.includes(df.fieldname)\n\t\t\t).map(df => df.fieldname);\n\n\t\t\tconst defaults = this.chart_args || {};\n\n\t\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\t\ttitle: __('Configure Chart'),\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('X Axis Field'),\n\t\t\t\t\t\tfieldtype: 'Autocomplete',\n\t\t\t\t\t\tfieldname: 'x_axis',\n\t\t\t\t\t\toptions: x_fields,\n\t\t\t\t\t\tdefault: defaults.x_field\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('Y Axis Fields'),\n\t\t\t\t\t\tfieldtype: 'MultiSelect',\n\t\t\t\t\t\tfieldname: 'y_axes',\n\t\t\t\t\t\toptions: y_fields,\n\t\t\t\t\t\tdescription: __('Showing only Numeric fields from Report'),\n\t\t\t\t\t\tdefault: defaults.y_fields\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('Chart Type'),\n\t\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\t\toptions: ['Bar', 'Line', 'Pie', 'Percentage'],\n\t\t\t\t\t\tfieldname: 'chart_type',\n\t\t\t\t\t\tdefault: toTitle(defaults.chart_type || 'Bar')\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tprimary_action: ({ x_axis, y_axes, chart_type }) => {\n\t\t\t\t\ty_axes = y_axes.split(',').map(d => d.trim()).filter(Boolean);\n\n\t\t\t\t\tif (!(\n\t\t\t\t\t\ty_axes.every(d => y_fields.includes(d))\n\t\t\t\t\t\t&& x_fields.includes(x_axis)\n\t\t\t\t\t)) return;\n\n\t\t\t\t\tconst args = this.get_chart_args(x_axis, y_axes, chart_type);\n\t\t\t\t\tthis.chart_args = args;\n\t\t\t\t\tresolve(args);\n\t\t\t\t\tdialog.hide();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tget_chart_args(x_axis, y_axes, chart_type) {\n\t\tconst labels = this.data.map(d => {\n\t\t\t// HACK: labels need strings,\n\t\t\t// so we return objects that\n\t\t\t// look like strings and also\n\t\t\t// monkey patch the doc\n\t\t\t// javascript is awesome\n\n\t\t\t// O.o\n\n\t\t\treturn {\n\t\t\t\tdoc: d,\n\t\t\t\ttoString() {\n\t\t\t\t\treturn d[x_axis];\n\t\t\t\t},\n\t\t\t\tslice: String.prototype.slice\n\t\t\t};\n\t\t});\n\n\t\treturn {\n\t\t\tchart_type: chart_type.toLowerCase(),\n\t\t\tx_field: x_axis,\n\t\t\ty_fields: y_axes,\n\t\t\tlabels: labels,\n\t\t\tdatasets: y_axes.map(y_axis => ({\n\t\t\t\tname: frappe.meta.get_docfield(this.doctype, y_axis).label,\n\t\t\t\tvalues: this.data.map(d => ({\n\t\t\t\t\tdoc: d,\n\t\t\t\t\tfield: y_axis,\n\t\t\t\t\ttoString() {\n\t\t\t\t\t\treturn d[y_axis];\n\t\t\t\t\t},\n\t\t\t\t\tslice: String.prototype.slice\n\t\t\t\t}))\n\t\t\t}))\n\t\t};\n\t}\n\n\tget_editing_object(colIndex, rowIndex, value, parent) {\n\t\tconst control = this.render_editing_input(colIndex, value, parent);\n\t\tif (!control) return false;\n\n\t\tcontrol.df.change = () => control.set_focus();\n\n\t\treturn {\n\t\t\tinitValue: (value) => {\n\t\t\t\treturn control.set_value(value);\n\t\t\t},\n\t\t\tsetValue: (value) => {\n\t\t\t\tconst cell = this.datatable.getCell(colIndex, rowIndex);\n\t\t\t\tlet fieldname = this.datatable.getColumn(colIndex).docfield.fieldname;\n\t\t\t\tlet docname = cell.name;\n\t\t\t\tlet doctype = cell.doctype;\n\n\t\t\t\tcontrol.set_value(value);\n\t\t\t\treturn this.set_control_value(doctype, docname, fieldname, value)\n\t\t\t\t\t.then((updated_doc) => {\n\t\t\t\t\t\tconst _data = this.data.find(d => d.name === updated_doc.name);\n\t\t\t\t\t\tfor (let field in _data) {\n\t\t\t\t\t\t\t_data[field] = updated_doc[field];\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => this.refresh_charts());\n\t\t\t},\n\t\t\tgetValue: () => {\n\t\t\t\treturn control.get_value();\n\t\t\t}\n\t\t};\n\t}\n\n\tset_control_value(doctype, docname, fieldname, value) {\n\t\tthis.last_updated_doc = docname;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tfrappe.db.set_value(doctype, docname, {[fieldname]: value})\n\t\t\t\t.then(r => {\n\t\t\t\t\tif (r.message) {\n\t\t\t\t\t\tresolve(r.message);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.fail(reject);\n\t\t});\n\t}\n\n\trender_editing_input(colIndex, value, parent) {\n\t\tconst col = this.datatable.getColumn(colIndex);\n\t\tlet control = null;\n\n\t\tif (col.docfield.fieldtype === 'Text Editor') {\n\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\ttitle: __('Edit {0}', [col.docfield.label]),\n\t\t\t\tfields: [col.docfield],\n\t\t\t\tprimary_action: () => {\n\t\t\t\t\tthis.datatable.cellmanager.submitEditing();\n\t\t\t\t\tthis.datatable.cellmanager.deactivateEditing();\n\t\t\t\t\td.hide();\n\t\t\t\t}\n\t\t\t});\n\t\t\td.show();\n\t\t\tcontrol = d.fields_dict[col.docfield.fieldname];\n\t\t} else {\n\t\t\t// make control\n\t\t\tcontrol = frappe.ui.form.make_control({\n\t\t\t\tdf: col.docfield,\n\t\t\t\tparent: parent,\n\t\t\t\trender_input: true\n\t\t\t});\n\t\t\tcontrol.set_value(value);\n\t\t\tcontrol.toggle_label(false);\n\t\t\tcontrol.toggle_description(false);\n\t\t}\n\n\t\treturn control;\n\t}\n\n\tis_editable(df, data) {\n\t\tif (!df || data.docstatus !== 0) return false;\n\t\tconst is_standard_field = frappe.model.std_fields_list.includes(df.fieldname);\n\t\tconst can_edit = !(\n\t\t\tis_standard_field\n\t\t\t|| df.read_only\n\t\t\t|| df.hidden\n\t\t\t|| !frappe.model.can_write(this.doctype)\n\t\t);\n\t\treturn can_edit;\n\t}\n\n\tget_data(values) {\n\t\treturn this.build_rows(values);\n\t}\n\n\tset_fields() {\n\t\tif (this.report_name && this.report_doc.json.fields) {\n\t\t\tthis.fields = this.report_doc.json.fields.slice();\n\t\t\treturn;\n\t\t} else if (this.view_user_settings.fields) {\n\t\t\t// get from user_settings\n\t\t\tthis.fields = this.view_user_settings.fields;\n\t\t\treturn;\n\t\t}\n\n\t\t// get fields from meta\n\t\tthis.fields = [];\n\t\tconst add_field = f => this._add_field(f);\n\n\t\t// default fields\n\t\t[\n\t\t\t'name', 'docstatus',\n\t\t\tthis.meta.title_field,\n\t\t\tthis.meta.image_field\n\t\t].map(add_field);\n\n\t\t// fields in_list_view or in_standard_filter\n\t\tconst fields = this.meta.fields.filter(df => {\n\t\t\treturn (df.in_list_view || df.in_standard_filter)\n\t\t\t\t&& frappe.perm.has_perm(this.doctype, df.permlevel, 'read')\n\t\t\t\t&& frappe.model.is_value_type(df.fieldtype)\n\t\t\t\t&& !df.report_hide;\n\t\t});\n\n\t\tfields.map(add_field);\n\n\t\t// currency fields\n\t\tfields.filter(\n\t\t\tdf => df.fieldtype === 'Currency' && df.options\n\t\t).map(df => {\n\t\t\tif (df.options.includes(':')) {\n\t\t\t\tadd_field(df.options.split(':')[1]);\n\t\t\t} else {\n\t\t\t\tadd_field(df.options);\n\t\t\t}\n\t\t});\n\n\t\t// fields in listview_settings\n\t\t(this.settings.add_fields || []).map(add_field);\n\t}\n\n\tbuild_fields() {\n\t\tthis.fields.push(['docstatus', this.doctype]);\n\t\tsuper.build_fields();\n\t}\n\n\tget_fields() {\n\t\tlet fields = this.fields.map(f => {\n\t\t\tlet column_name = frappe.model.get_full_column_name(f[0], f[1]);\n\t\t\tif (f[1] !== this.doctype) {\n\t\t\t\t// child table field\n\t\t\t\tcolumn_name = column_name + ' as ' + `'${f[1]}:${f[0]}'`;\n\t\t\t}\n\t\t\treturn column_name;\n\t\t});\n\t\tconst cdt_name_fields =\n\t\t\tthis.get_unique_cdt_in_view()\n\t\t\t\t.map(cdt => frappe.model.get_full_column_name('name', cdt) + ' as ' + `'${cdt}:name'`);\n\t\tfields = fields.concat(cdt_name_fields);\n\n\t\treturn fields;\n\t}\n\n\tget_unique_cdt_in_view() {\n\t\treturn this.fields\n\t\t\t.filter(f => f[1] !== this.doctype)\n\t\t\t.map(f => f[1])\n\t\t\t.uniqBy(d => d);\n\t}\n\n\tadd_column_to_datatable(fieldname, doctype, col_index) {\n\t\tconst field = [fieldname, doctype];\n\t\tthis.fields.splice(col_index, 0, field);\n\n\t\tthis.add_currency_column(fieldname, doctype, col_index);\n\n\t\tthis.build_fields();\n\t\tthis.setup_columns();\n\n\t\tthis.datatable.destroy();\n\t\tthis.datatable = null;\n\t\tthis.refresh();\n\t}\n\n\tadd_currency_column(fieldname, doctype, col_index) {\n\t\t// Adds dependent currency field if required\n\t\tconst df = frappe.meta.get_docfield(doctype, fieldname);\n\t\tif (df && df.fieldtype === 'Currency' && df.options &&\n\t\t\t!df.options.includes(':') && frappe.meta.has_field(doctype, df.options)\n\t\t) {\n\t\t\tconst field = [df.options, doctype];\n\t\t\tif (col_index === undefined) {\n\t\t\t\tthis.fields.push(field);\n\t\t\t} else {\n\t\t\t\tthis.fields.splice(col_index, 0, field);\n\t\t\t}\n\t\t\tfrappe.show_alert(__('Also adding the dependent currency field {0}', [field[0].bold()]));\n\t\t}\n\t}\n\n\tremove_column_from_datatable(column) {\n\t\tconst index = this.fields.findIndex(f => column.field === f[0]);\n\t\tif (index === -1) return;\n\t\tconst field = this.fields[index];\n\t\tif (field[0] === 'name') {\n\t\t\tthis.refresh();\n\t\t\tfrappe.throw(__('Cannot remove ID field'));\n\t\t}\n\t\tthis.fields.splice(index, 1);\n\t\tthis.build_fields();\n\t\tthis.setup_columns();\n\t\tthis.refresh();\n\t}\n\n\tswitch_column(col1, col2) {\n\t\tconst index1 = this.fields.findIndex(f => col1.field === f[0]);\n\t\tconst index2 = this.fields.findIndex(f => col2.field === f[0]);\n\t\tconst _fields = this.fields.slice();\n\n\t\tlet temp = _fields[index1];\n\t\t_fields[index1] = _fields[index2];\n\t\t_fields[index2] = temp;\n\n\t\tthis.fields = _fields;\n\t\tthis.build_fields();\n\t\tthis.setup_columns();\n\t\tthis.refresh();\n\t}\n\n\tget_columns_for_picker() {\n\t\tlet out = {};\n\n\t\tconst standard_fields_filter = df =>\n\t\t\t!in_list(frappe.model.no_value_type, df.fieldtype) &&\n\t\t\t!df.report_hide && df.fieldname !== 'naming_series' &&\n\t\t\t!df.hidden;\n\n\t\tlet doctype_fields = frappe.meta.get_docfields(this.doctype).filter(standard_fields_filter);\n\n\t\tdoctype_fields = [{\n\t\t\tlabel: __('ID'),\n\t\t\tfieldname: 'name',\n\t\t\tfieldtype: 'Data'\n\t\t}].concat(doctype_fields, frappe.model.std_fields);\n\n\t\tout[this.doctype] = doctype_fields;\n\n\t\tconst table_fields = frappe.meta.get_table_fields(this.doctype)\n\t\t\t.filter(df => !df.hidden);\n\n\t\ttable_fields.forEach(df => {\n\t\t\tconst cdt = df.options;\n\t\t\tconst child_table_fields = frappe.meta.get_docfields(cdt).filter(standard_fields_filter);\n\n\t\t\tout[cdt] = child_table_fields;\n\t\t});\n\n\t\treturn out;\n\t}\n\n\tget_dialog_fields() {\n\t\tconst dialog_fields = [];\n\t\tconst columns = this.get_columns_for_picker();\n\n\t\tdialog_fields.push({\n\t\t\tlabel: __(this.doctype),\n\t\t\tfieldname: this.doctype,\n\t\t\tfieldtype: 'MultiCheck',\n\t\t\tcolumns: 2,\n\t\t\toptions: columns[this.doctype]\n\t\t\t\t.map(df => ({\n\t\t\t\t\tlabel: __(df.label),\n\t\t\t\t\tvalue: df.fieldname,\n\t\t\t\t\tchecked: this.fields.find(f => f[0] === df.fieldname)\n\t\t\t\t}))\n\t\t});\n\n\t\tdelete columns[this.doctype];\n\n\t\tconst table_fields = frappe.meta.get_table_fields(this.doctype)\n\t\t\t.filter(df => !df.hidden);\n\n\t\ttable_fields.forEach(df => {\n\t\t\tconst cdt = df.options;\n\n\t\t\tdialog_fields.push({\n\t\t\t\tlabel: __(df.label) + ` (${__(cdt)})`,\n\t\t\t\tfieldname: df.options,\n\t\t\t\tfieldtype: 'MultiCheck',\n\t\t\t\tcolumns: 2,\n\t\t\t\toptions: columns[cdt]\n\t\t\t\t\t.map(df => ({\n\t\t\t\t\t\tlabel: __(df.label),\n\t\t\t\t\t\tvalue: df.fieldname,\n\t\t\t\t\t\tchecked: this.fields.find(f => f[0] === df.fieldname && f[1] === cdt)\n\t\t\t\t\t}))\n\t\t\t});\n\t\t});\n\n\t\treturn dialog_fields;\n\t}\n\n\tis_column_added(df) {\n\t\treturn Boolean(\n\t\t\tthis.fields.find(f => f[0] === df.fieldname && df.parent === f[1])\n\t\t);\n\t}\n\n\tsetup_columns() {\n\t\tconst hide_columns = ['docstatus'];\n\t\tconst fields = this.fields.filter(f => !hide_columns.includes(f[0]));\n\t\tthis.columns = fields.map(f => this.build_column(f)).filter(Boolean);\n\t}\n\n\tbuild_column(c) {\n\t\tlet [fieldname, doctype] = c;\n\t\tlet docfield = frappe.meta.docfield_map[doctype || this.doctype][fieldname];\n\n\t\tif (!docfield) {\n\t\t\tdocfield = frappe.model.get_std_field(fieldname);\n\n\t\t\tif (docfield) {\n\t\t\t\tdocfield.parent = this.doctype;\n\t\t\t\tif (fieldname == \"name\") {\n\t\t\t\t\tdocfield.options = this.doctype;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!docfield) return;\n\n\t\tlet title = __(docfield ? docfield.label : toTitle(fieldname));\n\t\tif (doctype !== this.doctype) {\n\t\t\ttitle += ` (${__(doctype)})`;\n\t\t}\n\n\t\tconst editable = frappe.model.is_non_std_field(fieldname) && !docfield.read_only;\n\n\t\tconst align = (() => {\n\t\t\tconst is_numeric = frappe.model.is_numeric_field(docfield);\n\t\t\tif (is_numeric) {\n\t\t\t\treturn 'right';\n\t\t\t}\n\t\t\treturn docfield.fieldtype === 'Date' ? 'right' : 'left';\n\t\t})();\n\n\t\t// child table column\n\t\tconst id = doctype !== this.doctype ? `${doctype}:${fieldname}` : fieldname;\n\n\t\tlet width = (docfield ? cint(docfield.width) : null) || null;\n\t\tif (this.report_doc) {\n\t\t\t// load the user saved column width\n\t\t\tlet saved_column_widths = this.report_doc.json.column_widths || {};\n\t\t\twidth = saved_column_widths[id] || width;\n\t\t}\n\n\t\tlet compareFn = null;\n\t\tif (docfield.fieldtype === 'Date') {\n\t\t\tcompareFn = (cell, keyword) => {\n\t\t\t\tif (!cell.content) return null;\n\t\t\t\tif (keyword.length !== 'YYYY-MM-DD'.length) return null;\n\n\t\t\t\tconst keywordValue = frappe.datetime.user_to_obj(keyword);\n\t\t\t\tconst cellValue = frappe.datetime.str_to_obj(cell.content);\n\t\t\t\treturn [+cellValue, +keywordValue];\n\t\t\t}\n\t\t}\n\n\n\t\treturn {\n\t\t\tid: id,\n\t\t\tfield: fieldname,\n\t\t\tname: title,\n\t\t\tcontent: title,\n\t\t\tdocfield,\n\t\t\twidth,\n\t\t\teditable,\n\t\t\talign,\n\t\t\tcompareValue: compareFn,\n\t\t\tformat: (value, row, column, data) => {\n\t\t\t\tlet doc = null;\n\t\t\t\tif (Array.isArray(row)) {\n\t\t\t\t\tdoc = row.reduce((acc, curr) => {\n\t\t\t\t\t\tif (!curr.column.docfield) return acc;\n\t\t\t\t\t\tacc[curr.column.docfield.fieldname] = curr.content;\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t}, {});\n\t\t\t\t} else {\n\t\t\t\t\tdoc = row;\n\t\t\t\t}\n\n\t\t\t\treturn frappe.format(value, column.docfield, { always_show_decimals: true }, doc);\n\t\t\t}\n\t\t};\n\t}\n\n\tbuild_rows(data) {\n\t\tconst out = data.map(d => this.build_row(d));\n\n\t\tif (this.add_totals_row) {\n\t\t\tconst totals = this.get_columns_totals(data);\n\t\t\tconst totals_row = this.columns.map((col, i) => {\n\t\t\t\treturn {\n\t\t\t\t\tname: __('Totals Row'),\n\t\t\t\t\tcontent: totals[col.id],\n\t\t\t\t\tformat: value => {\n\t\t\t\t\t\treturn frappe.format(value, col.docfield, { always_show_decimals: true });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t\ttotals_row[0].content = __('Totals').bold();\n\t\t\tout.push(totals_row);\n\t\t}\n\n\t\treturn out;\n\t}\n\n\tbuild_row(d) {\n\t\treturn this.columns.map(col => {\n\t\t\tif (col.docfield.parent !== this.doctype) {\n\t\t\t\t// child table field\n\t\t\t\tconst cdt_field = f => `${col.docfield.parent}:${f}`;\n\t\t\t\tconst name = d[cdt_field('name')];\n\n\t\t\t\treturn {\n\t\t\t\t\tname: name,\n\t\t\t\t\tdoctype: col.docfield.parent,\n\t\t\t\t\tcontent: d[cdt_field(col.field)],\n\t\t\t\t\teditable: Boolean(name && this.is_editable(col.docfield, d)),\n\t\t\t\t\tformat: value => {\n\t\t\t\t\t\treturn frappe.format(value, col.docfield, { always_show_decimals: true });\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (col.field in d) {\n\t\t\t\tconst value = d[col.field];\n\t\t\t\treturn {\n\t\t\t\t\tname: d.name,\n\t\t\t\t\tdoctype: col.docfield.parent,\n\t\t\t\t\tcontent: value,\n\t\t\t\t\teditable: this.is_editable(col.docfield, d)\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcontent: ''\n\t\t\t};\n\t\t});\n\t}\n\n\tget_checked_items(only_docnames) {\n\t\tconst indexes = this.datatable.rowmanager.getCheckedRows();\n\t\tconst items = indexes.filter(i => i != undefined)\n\t\t\t.map(i => this.data[i]);\n\n\t\tif (only_docnames) {\n\t\t\treturn items.map(d => d.name);\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tsave_report(save_type) {\n\t\tconst _save_report = (name) => {\n\t\t\t// callback\n\t\t\tconst report_settings = {\n\t\t\t\tfilters: this.filter_area.get(),\n\t\t\t\tfields: this.fields,\n\t\t\t\torder_by: this.sort_selector.get_sql_string(),\n\t\t\t\tadd_totals_row: this.add_totals_row,\n\t\t\t\tpage_length: this.page_length,\n\t\t\t\tcolumn_widths: this.get_column_widths()\n\t\t\t}\n\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: 'frappe.desk.reportview.save_report',\n\t\t\t\targs: {\n\t\t\t\t\tname: name,\n\t\t\t\t\tdoctype: this.doctype,\n\t\t\t\t\tjson: JSON.stringify(report_settings)\n\t\t\t\t},\n\t\t\t\tcallback:(r) => {\n\t\t\t\t\tif(r.exc) {\n\t\t\t\t\t\tfrappe.msgprint(__(\"Report was not saved (there were errors)\"));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif(r.message != this.report_name) {\n\t\t\t\t\t\t// Rerender the reports dropdown,\n\t\t\t\t\t\t// so that this report is included in the dropdown as well.\n\t\t\t\t\t\tfrappe.boot.user.all_reports[r.message] = {\n\t\t\t\t\t\t\tref_doctype: \"Item\",\n\t\t\t\t\t\t\treport_type: \"Report Builder\",\n\t\t\t\t\t\t\ttitle: r.message,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.list_sidebar.setup_reports();\n\t\t\t\t\t\tfrappe.set_route('List', this.doctype, 'Report', r.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// update state\n\t\t\t\t\tthis.report_doc.json = report_settings;\n\t\t\t\t\tthis.set_dirty_state_for_custom_report();\n\t\t\t\t}\n\t\t\t});\n\n\t\t};\n\n\t\tif(this.report_name && save_type == \"save\") {\n\t\t\t_save_report(this.report_name);\n\t\t} else {\n\t\t\tfrappe.prompt({fieldname: 'name', label: __('New Report name'), reqd: 1, fieldtype: 'Data'}, (data) => {\n\t\t\t\t_save_report(data.name);\n\t\t\t}, __('Save As'));\n\t\t}\n\t}\n\n\tget_column_widths() {\n\t\tif (this.datatable) {\n\t\t\treturn this.datatable\n\t\t\t\t.datamanager\n\t\t\t\t.getColumns(true)\n\t\t\t\t.reduce((acc, curr) => {\n\t\t\t\t\tacc[curr.id] = parseInt(curr.width);\n\t\t\t\t\treturn acc;\n\t\t\t\t}, {});\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tget_report_doc() {\n\t\treturn new Promise(resolve => {\n\t\t\tfrappe.model.with_doc('Report', this.report_name, () => {\n\t\t\t\tresolve(frappe.get_doc('Report', this.report_name));\n\t\t\t});\n\t\t});\n\t}\n\n\tget_filters_html_for_print() {\n\t\tconst filters = this.filter_area.get();\n\n\t\treturn filters.map(f => {\n\t\t\tconst [doctype, fieldname, condition, value] = f;\n\t\t\tif (condition !== '=') return '';\n\n\t\t\tconst label = frappe.meta.get_label(doctype, fieldname);\n\t\t\treturn `<h6>${__(label)}: ${value}</h6>`;\n\t\t}).join('');\n\t}\n\n\tget_columns_totals(data) {\n\t\tif (!this.add_totals_row) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst row_totals = {};\n\n\t\tthis.columns.forEach((col, i) => {\n\t\t\tconst totals = data.reduce((totals, d) => {\n\t\t\t\tif (col.id in d && frappe.model.is_numeric_field(col.docfield)) {\n\t\t\t\t\ttotals += flt(d[col.id]);\n\t\t\t\t\treturn totals;\n\t\t\t\t}\n\t\t\t}, 0);\n\n\t\t\trow_totals[col.id] = totals;\n\t\t});\n\n\t\treturn row_totals;\n\t}\n\n\treport_menu_items() {\n\t\tlet items = [\n\t\t\t{\n\t\t\t\tlabel: __('Show Totals'),\n\t\t\t\taction: () => {\n\t\t\t\t\tthis.add_totals_row = !this.add_totals_row;\n\t\t\t\t\tthis.save_view_user_settings({ add_totals_row: this.add_totals_row });\n\t\t\t\t\tthis.datatable.refresh(this.get_data(this.data));\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Print'),\n\t\t\t\taction: () => {\n\t\t\t\t\t// prepare rows in their current state, sorted and filtered\n\t\t\t\t\tconst rows_in_order = this.datatable.datamanager.rowViewOrder.map(index => {\n\t\t\t\t\t\tif (this.datatable.bodyRenderer.visibleRowIndices.includes(index)) {\n\t\t\t\t\t\t\treturn this.data[index];\n\t\t\t\t\t\t}\n\t\t\t\t\t}).filter(Boolean);\n\n\t\t\t\t\tif (this.add_totals_row) {\n\t\t\t\t\t\tconst total_data = this.get_columns_totals(this.data);\n\n\t\t\t\t\t\ttotal_data['name'] = __('Totals').bold();\n\t\t\t\t\t\trows_in_order.push(total_data);\n\t\t\t\t\t}\n\n\t\t\t\t\tfrappe.ui.get_print_settings(false, (print_settings) => {\n\t\t\t\t\t\tvar title =  __(this.doctype);\n\t\t\t\t\t\tfrappe.render_grid({\n\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\tsubtitle: this.get_filters_html_for_print(),\n\t\t\t\t\t\t\tprint_settings: print_settings,\n\t\t\t\t\t\t\tcolumns: this.columns,\n\t\t\t\t\t\t\tdata: rows_in_order\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Toggle Chart'),\n\t\t\t\taction: () => this.toggle_charts()\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Toggle Sidebar'),\n\t\t\t\taction: () => this.toggle_side_bar()\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Pick Columns'),\n\t\t\t\taction: () => {\n\t\t\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __('Pick Columns'),\n\t\t\t\t\t\tfields: this.get_dialog_fields(),\n\t\t\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\t\t\t// doctype fields\n\t\t\t\t\t\t\tlet fields = values[this.doctype].map(f => [f, this.doctype]);\n\t\t\t\t\t\t\tdelete values[this.doctype];\n\n\t\t\t\t\t\t\t// child table fields\n\t\t\t\t\t\t\tfor (let cdt in values) {\n\t\t\t\t\t\t\t\tfields = fields.concat(values[cdt].map(f => [f, cdt]));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// always keep name (ID) column\n\t\t\t\t\t\t\tthis.fields = [[\"name\", this.doctype], ...fields];\n\n\t\t\t\t\t\t\tthis.fields.map(f => this.add_currency_column(f[0], f[1]));\n\n\t\t\t\t\t\t\tthis.build_fields();\n\t\t\t\t\t\t\tthis.setup_columns();\n\n\t\t\t\t\t\t\tthis.datatable.destroy();\n\t\t\t\t\t\t\tthis.datatable = null;\n\t\t\t\t\t\t\tthis.refresh();\n\n\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\td.show();\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tif (frappe.model.can_export(this.doctype)) {\n\t\t\titems.push({\n\t\t\t\tlabel: __('Export'),\n\t\t\t\taction: () => {\n\t\t\t\t\tconst args = this.get_args();\n\t\t\t\t\tconst selected_items = this.get_checked_items(true);\n\n\t\t\t\t\tconst d = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __(\"Export Report: {0}\",[__(this.doctype)]),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\t\t\t\tlabel: __('Select File Type'),\n\t\t\t\t\t\t\t\tfieldname:'file_format_type',\n\t\t\t\t\t\t\t\toptions: ['Excel', 'CSV'],\n\t\t\t\t\t\t\t\tdefault: 'Excel'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfieldtype: 'Check',\n\t\t\t\t\t\t\t\tfieldname: 'export_all_rows',\n\t\t\t\t\t\t\t\tlabel: __('Export All {0} rows?', [(this.total_count + \"\").bold()])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action_label: __('Download'),\n\t\t\t\t\t\tprimary_action: (data) => {\n\t\t\t\t\t\t\targs.cmd = 'frappe.desk.reportview.export_query';\n\t\t\t\t\t\t\targs.file_format_type = data.file_format_type;\n\n\t\t\t\t\t\t\tif(this.add_totals_row) {\n\t\t\t\t\t\t\t\targs.add_totals_row = 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(selected_items.length > 0) {\n\t\t\t\t\t\t\t\targs.selected_items = selected_items;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!data.export_all_rows) {\n\t\t\t\t\t\t\t\targs.start = 0;\n\t\t\t\t\t\t\t\targs.page_length = this.data.length;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdelete args.start;\n\t\t\t\t\t\t\t\tdelete args.page_length;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\topen_url_post(frappe.request.url, args);\n\n\t\t\t\t\t\t\td.hide();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\td.show();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\titems.push({\n\t\t\tlabel: __(\"Setup Auto Email\"),\n\t\t\taction: () => {\n\t\t\t\tif(this.report_name) {\n\t\t\t\t\tfrappe.set_route('List', 'Auto Email Report', {'report' : this.report_name});\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.msgprint(__('Please save the report first'));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// save buttons\n\t\tif(frappe.user.is_report_manager()) {\n\t\t\titems = items.concat([\n\t\t\t\t{ label: __('Save'), action: () => this.save_report('save') },\n\t\t\t\t{ label: __('Save As'), action: () => this.save_report('save_as') }\n\t\t\t]);\n\t\t}\n\n\t\t// user permissions\n\t\tif(this.report_name && frappe.model.can_set_user_permissions(\"Report\")) {\n\t\t\titems.push({\n\t\t\t\tlabel: __(\"User Permissions\"),\n\t\t\t\taction: () => {\n\t\t\t\t\tconst args = {\n\t\t\t\t\t\tdoctype: \"Report\",\n\t\t\t\t\t\tname: this.report_name\n\t\t\t\t\t};\n\t\t\t\t\tfrappe.set_route('List', 'User Permission', args);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// add to desktop\n\t\titems.push({\n\t\t\tlabel: __('Add to Desktop'),\n\t\t\taction: () => {\n\t\t\t\tfrappe.add_to_desktop(\n\t\t\t\t\tthis.report_name || __('{0} Report', [this.doctype]),\n\t\t\t\t\tthis.doctype, this.report_name\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\treturn items.map(i => Object.assign(i, { standard: true }));\n\t}\n\n};\n","// Copyright (c) 2018, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\nimport DataTable from 'frappe-datatable';\n\nfrappe.provide('frappe.views');\nfrappe.provide('frappe.query_reports');\n\nfrappe.standard_pages['query-report'] = function() {\n\tvar wrapper = frappe.container.add_page('query-report');\n\n\tfrappe.ui.make_app_page({\n\t\tparent: wrapper,\n\t\ttitle: __('Query Report'),\n\t\tsingle_column: true,\n\t});\n\n\tfrappe.query_report = new frappe.views.QueryReport({\n\t\tparent: wrapper,\n\t});\n\n\t$(wrapper).bind('show', function() {\n\t\tfrappe.query_report.show();\n\t});\n};\n\nfrappe.views.QueryReport = class QueryReport extends frappe.views.BaseList {\n\tshow() {\n\t\tthis.init().then(() => this.load());\n\t}\n\n\tinit() {\n\t\tif (this.init_promise) {\n\t\t\treturn this.init_promise;\n\t\t}\n\n\t\tlet tasks = [\n\t\t\tthis.setup_defaults,\n\t\t\tthis.setup_page,\n\t\t\tthis.setup_report_wrapper,\n\t\t\tthis.setup_events\n\t\t].map(fn => fn.bind(this));\n\t\tthis.init_promise = frappe.run_serially(tasks);\n\t\treturn this.init_promise;\n\t}\n\n\tsetup_defaults() {\n\t\tthis.route = frappe.get_route();\n\t\tthis.page_name = frappe.get_route_str();\n\n\t\t// Setup buttons\n\t\tthis.primary_action = null;\n\t\tthis.secondary_action = {\n\t\t\tlabel: __('Refresh'),\n\t\t\taction: () => {\n\t\t\t\tthis.setup_progress_bar();\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t};\n\n\t\t// throttle refresh for 300ms\n\t\tthis.refresh = frappe.utils.throttle(this.refresh, 300);\n\n\t\tthis.menu_items = [];\n\t}\n\n\tsetup_events() {\n\t\tfrappe.realtime.on(\"report_generated\", (data) => {\n\t\t\tif(data.report_name) {\n\t\t\t\tthis.prepared_report_action = \"Rebuild\";\n\t\t\t\t// If generated report and currently active Prepared Report has same fiters\n\t\t\t\t// then refresh the Prepared Report\n\t\t\t\t// Otherwise show alert with the link to the Prepared Report\n\t\t\t\tif(data.name == this.prepared_report_doc_name) {\n\t\t\t\t\tthis.refresh();\n\t\t\t\t} else {\n\t\t\t\t\tlet alert_message = `Report ${this.report_name} generated.\n\t\t\t\t\t\t<a href=\"#query-report/${this.report_name}/?prepared_report_name=${data.name}\">View</a>`;\n\t\t\t\t\tfrappe.show_alert({message: alert_message, indicator: 'orange'});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.page.wrapper.on('click', '[data-action]', (e) => {\n\t\t\tlet action_name = $(e.currentTarget).data('action');\n\t\t\tlet action = this[action_name];\n\t\t\tif (action.call) {\n\t\t\t\taction.call(this, e);\n\t\t\t}\n\t\t});\n\t}\n\n\tload() {\n\t\tif (frappe.get_route().length < 2) {\n\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\treturn;\n\t\t}\n\t\tif (this.report_name !== frappe.get_route()[1]) {\n\t\t\t// this.toggle_loading(true);\n\t\t\t// different report\n\t\t\tthis.load_report();\n\t\t} else {\n\t\t\t// same report\n\t\t\t// don't do anything to preserve state\n\t\t\t// like filters and datatable column widths\n\t\t}\n\t}\n\n\tload_report() {\n\t\tthis.page.clear_inner_toolbar();\n\t\tthis.route = frappe.get_route();\n\t\tthis.page_name = frappe.get_route_str();\n\t\tthis.report_name = this.route[1];\n\t\tthis.page_title = __(this.report_name);\n\t\tthis.menu_items = this.get_menu_items();\n\t\tthis.datatable = null;\n\t\tthis.prepared_report_action = \"New\";\n\n\t\tfrappe.run_serially([\n\t\t\t() => this.get_report_doc(),\n\t\t\t() => this.get_report_settings(),\n\t\t\t() => this.setup_progress_bar(),\n\t\t\t() => this.setup_page_head(),\n\t\t\t() => this.refresh_report(),\n\t\t\t() => this.add_make_chart_button()\n\t\t]);\n\t}\n\n\tadd_make_chart_button(){\n\t\tthis.page.add_inner_button(__(\"Set Chart\"), () => {\n\t\t\tthis.get_possible_chart_options();\n\t\t});\n\t}\n\n\trefresh_report() {\n\t\tthis.toggle_message(true);\n\n\t\treturn frappe.run_serially([\n\t\t\t() => this.setup_filters(),\n\t\t\t() => this.set_route_filters(),\n\t\t\t() => this.report_settings.onload && this.report_settings.onload(this),\n\t\t\t() => this.get_user_settings(),\n\t\t\t() => this.refresh()\n\t\t]);\n\t}\n\n\tget_report_doc() {\n\t\treturn frappe.model.with_doc('Report', this.report_name)\n\t\t\t.then(doc => {\n\t\t\t\tthis.report_doc = doc;\n\t\t\t})\n\t\t\t.then(() => frappe.model.with_doctype(this.report_doc.ref_doctype));\n\t}\n\n\tget_report_settings() {\n\t\tif (frappe.query_reports[this.report_name]) {\n\t\t\tthis.report_settings = frappe.query_reports[this.report_name];\n\t\t\treturn this._load_script;\n\t\t}\n\n\t\tthis._load_script = (new Promise(resolve => frappe.call({\n\t\t\tmethod: 'frappe.desk.query_report.get_script',\n\t\t\targs: { report_name: this.report_name },\n\t\t\tcallback: resolve\n\t\t}))).then(r => {\n\t\t\tfrappe.dom.eval(r.message.script || '');\n\t\t\treturn r;\n\t\t}).then(r => {\n\t\t\treturn frappe.after_ajax(() => {\n\t\t\t\tthis.report_settings = frappe.query_reports[this.report_name];\n\t\t\t\tthis.report_settings.html_format = r.message.html_format;\n\t\t\t\tthis.report_settings.execution_time = r.message.execution_time || 0;\n\t\t\t});\n\t\t});\n\n\t\treturn this._load_script;\n\t}\n\n\tsetup_progress_bar() {\n\t\tlet seconds_elapsed = 0;\n\t\tconst execution_time = this.report_settings.execution_time || 0;\n\n\t\tif (execution_time < 5) return;\n\n\t\tthis.interval = setInterval(function()  {\n\t\t\tseconds_elapsed += 1;\n\t\t\tfrappe.show_progress(__('Preparing Report'), seconds_elapsed, execution_time);\n\t\t}, 1000);\n\t}\n\n\tsetup_filters() {\n\t\tthis.clear_filters();\n\t\tconst { filters = [] } = this.report_settings;\n\n\t\tthis.filters = filters.map(df => {\n\t\t\tif (df.fieldtype === 'Break') return;\n\n\t\t\tlet f = this.page.add_field(df);\n\n\t\t\tif (df.default) {\n\t\t\t\tf.set_input(df.default);\n\t\t\t}\n\n\t\t\tif (df.get_query) f.get_query = df.get_query;\n\t\t\tif (df.on_change) f.on_change = df.on_change;\n\n\t\t\tdf.onchange = () => {\n\t\t\t\tif (this.previous_filters\n\t\t\t\t\t&& (JSON.stringify(this.previous_filters) == JSON.stringify(this.get_filter_values()))) {\n\t\t\t\t\t// filter values have not changed\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.previous_filters = this.get_filter_values();\n\n\t\t\t\t// clear previous_filters after 3 seconds, to allow refresh for new data\n\t\t\t\tsetTimeout(() => this.previous_filters = null, 10000);\n\n\t\t\t\tif (f.on_change) {\n\t\t\t\t\tf.on_change(this);\n\t\t\t\t} else {\n\t\t\t\t\tif (this.prepared_report) {\n\t\t\t\t\t\tthis.reset_report_view();\n\t\t\t\t\t}\n\t\t\t\t\telse if (!this._no_refresh) {\n\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tf = Object.assign(f, df);\n\n\t\t\treturn f;\n\n\t\t}).filter(Boolean);\n\n\t\tif (this.filters.length === 0) {\n\t\t\t// hide page form if no filters\n\t\t\tthis.page.hide_form();\n\t\t} else {\n\t\t\tthis.page.show_form();\n\t\t}\n\t}\n\n\tset_filters(filters) {\n\t\tthis.filters.map(f => {\n\t\t\tf.set_input(filters[f.fieldname]);\n\t\t});\n\t}\n\n\tset_route_filters() {\n\t\tif(frappe.route_options) {\n\t\t\tconst fields = Object.keys(frappe.route_options);\n\n\t\t\tconst filters_to_set = this.filters.filter(f => fields.includes(f.df.fieldname));\n\n\t\t\tconst promises = filters_to_set.map(f => {\n\t\t\t\treturn () => {\n\t\t\t\t\tconst value = frappe.route_options[f.df.fieldname];\n\t\t\t\t\treturn f.set_value(value);\n\t\t\t\t};\n\t\t\t});\n\t\t\tpromises.push(() => {\n\t\t\t\tfrappe.route_options = null;\n\t\t\t});\n\n\t\t\treturn frappe.run_serially(promises);\n\t\t}\n\t}\n\n\tclear_filters() {\n\t\tthis.page.clear_fields();\n\t}\n\n\trefresh() {\n\t\tthis.toggle_message(true);\n\t\tlet filters = this.get_filter_values(true);\n\t\tlet query = frappe.utils.get_query_string(frappe.get_route_str());\n\n\t\tif(query) {\n\t\t\tlet obj = frappe.utils.get_query_params(query);\n\t\t\tfilters = Object.assign(filters || {}, obj);\n\t\t}\n\n\t\t// only one refresh at a time\n\t\tif (this.last_ajax) {\n\t\t\tthis.last_ajax.abort();\n\t\t}\n\n\t\treturn new Promise(resolve => {\n\t\t\tthis.last_ajax = frappe.call({\n\t\t\t\tmethod: 'frappe.desk.query_report.run',\n\t\t\t\ttype: 'GET',\n\t\t\t\targs: {\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\tfilters: filters,\n\t\t\t\t},\n\t\t\t\tcallback: resolve,\n\t\t\t\talways: () => this.page.btn_secondary.prop('disabled', false)\n\t\t\t})\n\t\t}).then(r => {\n\t\t\tlet data = r.message;\n\t\t\tthis.hide_status();\n\t\t\tclearInterval(this.interval);\n\n\t\t\tthis.execution_time = data.execution_time || 0.1;\n\n\t\t\tif (data.prepared_report) {\n\t\t\t\tthis.prepared_report = true;\n\t\t\t\tconst query_string = frappe.utils.get_query_string(frappe.get_route_str());\n\t\t\t\tconst query_params = frappe.utils.get_query_params(query_string);\n\t\t\t\t// If query_string contains prepared_report_name then set filters\n\t\t\t\t// to match the mentioned prepared report doc and disable editing\n\t\t\t\tif(query_params.prepared_report_name) {\n\t\t\t\t\tthis.prepared_report_action = \"Edit\";\n\t\t\t\t\tconst filters_from_report = JSON.parse(data.doc.filters);\n\t\t\t\t\tObject.values(this.filters).forEach(function(field) {\n\t\t\t\t\t\tif (filters_from_report[field.fieldname]) {\n\t\t\t\t\t\t\tfield.set_input(filters_from_report[field.fieldname]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfield.input.disabled = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.add_prepared_report_buttons(data.doc);\n\t\t\t}\n\t\t\tthis.toggle_message(false);\n\n\t\t\tif (data.result && data.result.length) {\n\t\t\t\tthis.prepare_report_data(data);\n\n\t\t\t\tconst chart_options = this.get_chart_options(data);\n\t\t\t\tthis.$chart.empty();\n\t\t\t\tif(chart_options) {\n\t\t\t\t\tthis.render_chart(chart_options);\n\t\t\t\t}\n\n\t\t\t\tthis.render_datatable();\n\t\t\t} else {\n\t\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\t}\n\n\t\t\tthis.show_footer_message();\n\t\t\tfrappe.hide_progress();\n\t\t});\n\t}\n\n\tadd_prepared_report_buttons(doc) {\n\t\tif(doc){\n\t\t\tthis.page.add_inner_button(__(\"Download Report\"), function (){\n\t\t\t\twindow.open(\n\t\t\t\t\tfrappe.urllib.get_full_url(\n\t\t\t\t\t\t\"/api/method/frappe.core.doctype.prepared_report.prepared_report.download_attachment?\"\n\t\t\t\t\t\t+\"dn=\"+encodeURIComponent(doc.name)));\n\t\t\t});\n\n\t\t\tconst part1 = __('This report was generated {0}.', [frappe.datetime.comment_when(doc.report_end_time)]);\n\t\t\tconst part2 = __('To get the updated report, click on {0}.', [__('Rebuild')]);\n\t\t\tconst part3 = __('See all past reports.');\n\n\t\t\tthis.show_status(`\n\t\t\t\t<span class=\"indicator orange\">\n\t\t\t\t\t${part1}\n\t\t\t\t\t${part2}\n\t\t\t\t\t<a href=\"#List/Prepared%20Report?report_name=${this.report_name}\">${part3}</a>\n\t\t\t\t</span>\n\t\t\t`);\n\t\t};\n\n\t\t// Three cases\n\t\t// 1. First time with given filters, no data.\n\t\t// 2. Showing data from specific report\n\t\t// 3. Showing data from an old report without specific report name\n\t\tif(this.prepared_report_action == \"New\") {\n\t\t\tthis.page.set_primary_action(\n\t\t\t\t__(\"Generate New Report\"),\n\t\t\t\t() => {\n\t\t\t\t\tthis.generate_background_report();\n\t\t\t\t}\n\t\t\t);\n\t\t} else if(this.prepared_report_action == \"Edit\") {\n\t\t\tthis.page.set_primary_action(\n\t\t\t\t__(\"Edit\"),\n\t\t\t\t() => {\n\t\t\t\t\tfrappe.set_route(frappe.get_route());\n\t\t\t\t}\n\t\t\t);\n\t\t} else if(this.prepared_report_action == \"Rebuild\"){\n\t\t\tthis.page.set_primary_action(\n\t\t\t\t__(\"Rebuild\"),\n\t\t\t\tthis.generate_background_report.bind(this)\n\t\t\t);\n\t\t}\n\t}\n\n\tgenerate_background_report() {\n\t\tlet mandatory = this.filters.filter(f => f.df.reqd);\n\t\tlet missing_mandatory = mandatory.filter(f => !f.get_value());\n\t\tif (!missing_mandatory.length){\n\t\t\tlet filters = this.get_filter_values(true);\n\t\t\treturn new Promise(resolve => frappe.call({\n\t\t\t\tmethod: 'frappe.desk.query_report.background_enqueue_run',\n\t\t\t\ttype: 'GET',\n\t\t\t\targs: {\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\tfilters: filters\n\t\t\t\t},\n\t\t\t\tcallback: resolve\n\t\t\t})).then(r => {\n\t\t\t\tconst data = r.message;\n\t\t\t\t// Rememeber the name of Prepared Report doc\n\t\t\t\tthis.prepared_report_doc_name = data.name;\n\t\t\t\tlet alert_message = `Report initiated. You can track its status\n\t\t\t\t\t<a class='text-info' href='#Form/Prepared Report/${data.name}'>here</a>`;\n\t\t\t\tfrappe.show_alert({message: alert_message, indicator: 'orange'});\n\t\t\t\tthis.toggle_nothing_to_show(true);\n\t\t\t});\n\t\t}\n\t}\n\n\tprepare_report_data(data) {\n\t\tthis.raw_data = data;\n\t\tthis.columns = this.prepare_columns(data.columns);\n\t\tthis.data = this.prepare_data(data.result);\n\n\t\tthis.tree_report = this.data.some(d => 'indent' in d);\n\t}\n\n\trender_datatable() {\n\t\tlet data = this.data;\n\t\tif (this.raw_data.add_total_row) {\n\t\t\tdata = data.slice();\n\t\t\tdata.splice(-1, 1);\n\t\t}\n\n\t\tif (this.datatable) {\n\t\t\tthis.datatable.options.treeView = this.tree_report;\n\t\t\tthis.datatable.refresh(data, this.columns);\n\t\t} else {\n\t\t\tlet datatable_options = {\n\t\t\t\tcolumns: this.columns,\n\t\t\t\tdata: data,\n\t\t\t\tinlineFilters: true,\n\t\t\t\ttreeView: this.tree_report,\n\t\t\t\tlayout: 'fixed',\n\t\t\t\tcellHeight: 33,\n\t\t\t\tshowTotalRow: this.raw_data.add_total_row,\n\t\t\t\thooks: {\n\t\t\t\t\tcolumnTotal: frappe.utils.report_column_total\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (this.report_settings.get_datatable_options) {\n\t\t\t\tdatatable_options = this.report_settings.get_datatable_options(datatable_options);\n\t\t\t}\n\t\t\tthis.datatable = new DataTable(this.$report[0], datatable_options);\n\t\t}\n\n\t\tif (this.report_settings.after_datatable_render) {\n\t\t\tthis.report_settings.after_datatable_render(this.datatable);\n\t\t}\n\t}\n\n\tget_chart_options(data) {\n\t\tlet options = this.report_settings.get_chart_data\n\t\t\t? this.report_settings.get_chart_data(data.columns, data.result)\n\t\t\t: data.chart\n\t\t\t\t? data.chart\n\t\t\t\t: undefined;\n\n\t\tif (!(options && options.data && options.data.labels && options.data.labels.length > 0)) return;\n\n\t\treturn options;\n\t}\n\n\trender_chart(options, height=200) {\n\t\tObject.assign(options, {\n\t\t\theight: height\n\t\t});\n\n\t\tthis.$chart.empty();\n\t\tthis.chart = new Chart(this.$chart[0], options);\n\t\tthis.$chart.show();\n\t}\n\n\tget_possible_chart_options() {\n\t\tconst columns = this.raw_data.columns;\n\t\tconst rows =  this.raw_data.result;\n\t\tconst first_row = rows[0];\n\t\tconst has_total_row = this.raw_data.add_total_row;\n\n\t\tconst indices = first_row.reduce((accumulator, current_value, current_index) => {\n\t\t\tif(!isNaN(Number(current_value))) {\n\t\t\t\taccumulator.push(current_index);\n\t\t\t}\n\t\t\treturn accumulator;\n\t\t}, []);\n\n\t\tfunction get_column_values(column_name) {\n\t\t\tconst column_index = columns.indexOf(column_name);\n\t\t\treturn rows.map(row => row[column_index]);\n\t\t}\n\n\t\tfunction get_chart_options({ y_field, x_field, chart_type, color }) {\n\t\t\tconst type = chart_type.toLowerCase();\n\t\t\tconst colors = color ? [color] : undefined;\n\n\t\t\tlet labels = get_column_values(x_field);\n\n\t\t\tlet dataset_values = get_column_values(y_field).map(d => Number(d));\n\n\t\t\tif(has_total_row) {\n\t\t\t\tlabels = labels.slice(0, -1);\n\t\t\t\tdataset_values = dataset_values.slice(0, -1);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\tlabels: labels,\n\t\t\t\t\tdatasets: [\n\t\t\t\t\t\t{ values: dataset_values }\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ttype: type,\n\t\t\t\tcolors: colors\n\t\t\t};\n\t\t}\n\n\t\tfunction preview_chart() {\n\t\t\tconst wrapper = $(dialog.fields_dict[\"chart_preview\"].wrapper);\n\t\t\tconst values = dialog.get_values(true);\n\t\t\tlet options = get_chart_options(values);\n\n\t\t\tObject.assign(options, {\n\t\t\t\theight: 150\n\t\t\t});\n\n\t\t\twrapper.empty();\n\t\t\tnew Chart(wrapper[0], options);\n\t\t\twrapper.find('.chart-container .title, .chart-container .sub-title').hide();\n\t\t\twrapper.show();\n\t\t}\n\n\t\tconst numeric_fields = columns.filter((col, i) => indices.includes(i));\n\t\tconst non_numeric_fields = columns.filter((col, i) => !indices.includes(i))\n\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Make Chart'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'y_field',\n\t\t\t\t\tlabel: 'Y Field',\n\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\toptions: numeric_fields,\n\t\t\t\t\tdefault: numeric_fields[0],\n\t\t\t\t\tonchange: preview_chart\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'x_field',\n\t\t\t\t\tlabel: 'X Field',\n\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\toptions: non_numeric_fields,\n\t\t\t\t\tdefault: non_numeric_fields[0],\n\t\t\t\t\tonchange: preview_chart\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'cb_1',\n\t\t\t\t\tfieldtype: 'Column Break'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'chart_type',\n\t\t\t\t\tlabel: 'Type of Chart',\n\t\t\t\t\tfieldtype: 'Select',\n\t\t\t\t\toptions: ['Bar', 'Line', 'Percentage', 'Pie'],\n\t\t\t\t\tdefault: 'Bar',\n\t\t\t\t\tonchange: preview_chart\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'color',\n\t\t\t\t\tlabel: 'Color',\n\t\t\t\t\tfieldtype: 'Color',\n\t\t\t\t\tdepends_on: doc => ['Bar', 'Line'].includes(doc.chart_type),\n\t\t\t\t\tonchange: preview_chart,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'sb_1',\n\t\t\t\t\tfieldtype: 'Section Break',\n\t\t\t\t\tlabel: 'Chart Preview'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'chart_preview',\n\t\t\t\t\tlabel: 'Chart Preview',\n\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Make'),\n\t\t\tprimary_action: (values) => {\n\t\t\t\tlet options = get_chart_options(values);\n\n\t\t\t\toptions.title = __(`${this.report_name}: ${values.y_field} vs ${values.x_field}`);\n\n\t\t\t\tthis.render_chart(options);\n\n\t\t\t\tdialog.hide();\n\t\t\t}\n\t\t});\n\n\t\tdialog.show();\n\n\t\t// load preview after dialog animation\n\t\tsetTimeout(preview_chart, 500);\n\t}\n\n\tget_user_settings() {\n\t\treturn frappe.model.user_settings.get(this.report_name)\n\t\t\t.then(user_settings => {\n\t\t\t\tthis.user_settings = user_settings;\n\t\t\t});\n\t}\n\n\tprepare_columns(columns) {\n\t\treturn columns.map(column => {\n\t\t\tif (typeof column === 'string') {\n\t\t\t\tif (column.includes(':')) {\n\t\t\t\t\tlet [label, fieldtype, width] = column.split(':');\n\t\t\t\t\tlet options;\n\n\t\t\t\t\tif (fieldtype.includes('/')) {\n\t\t\t\t\t\t[fieldtype, options] = fieldtype.split('/');\n\t\t\t\t\t}\n\n\t\t\t\t\tcolumn = {\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t\tfieldname: label,\n\t\t\t\t\t\tfieldtype,\n\t\t\t\t\t\twidth,\n\t\t\t\t\t\toptions\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tcolumn = {\n\t\t\t\t\t\tlabel: column,\n\t\t\t\t\t\tfieldname: column,\n\t\t\t\t\t\tfieldtype: 'Data'\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst format_cell = (value, row, column, data) => {\n\t\t\t\treturn frappe.format(value, column,\n\t\t\t\t\t{for_print: false, always_show_decimals: true}, data);\n\t\t\t};\n\n\t\t\tlet compareFn = null;\n\t\t\tif (column.fieldtype === 'Date') {\n\t\t\t\tcompareFn = (cell, keyword) => {\n\t\t\t\t\tif (!cell.content) return null;\n\t\t\t\t\tif (keyword.length !== 'YYYY-MM-DD'.length) return null;\n\n\t\t\t\t\tconst keywordValue = frappe.datetime.user_to_obj(keyword);\n\t\t\t\t\tconst cellValue = frappe.datetime.str_to_obj(cell.content);\n\t\t\t\t\treturn [+cellValue, +keywordValue];\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn Object.assign(column, {\n\t\t\t\tid: column.fieldname,\n\t\t\t\tname: column.label,\n\t\t\t\twidth: parseInt(column.width) || null,\n\t\t\t\teditable: false,\n\t\t\t\tcompareValue: compareFn,\n\t\t\t\tformat: (value, row, column, data) => {\n\t\t\t\t\tif (this.report_settings.formatter) {\n\t\t\t\t\t\treturn this.report_settings.formatter(value, row, column, data, format_cell);\n\t\t\t\t\t}\n\t\t\t\t\treturn format_cell(value, row, column, data);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprepare_data(data) {\n\t\treturn data.map(row => {\n\t\t\tlet row_obj = {};\n\t\t\tif (Array.isArray(row)) {\n\t\t\t\tthis.columns.forEach((column, i) => {\n\t\t\t\t\trow_obj[column.id] = row[i];\n\t\t\t\t});\n\n\t\t\t\treturn row_obj;\n\t\t\t}\n\t\t\treturn row;\n\t\t});\n\t}\n\n\tget_visible_columns() {\n\t\tconst visible_column_ids = this.datatable.datamanager.getColumns(true).map(col => col.id);\n\n\t\treturn visible_column_ids\n\t\t\t.map(id => this.columns.find(col => col.id === id))\n\t\t\t.filter(Boolean);\n\t}\n\n\tget_filter_values(raise) {\n\t\tconst mandatory = this.filters.filter(f => f.df.reqd);\n\t\tconst missing_mandatory = mandatory.filter(f => !f.get_value());\n\t\tif (raise && missing_mandatory.length > 0) {\n\t\t\tlet message = __('Please set filters');\n\t\t\tthis.toggle_message(raise, message);\n\t\t\tthrow \"Filter missing\";\n\t\t}\n\n\t\tconst filters = this.filters\n\t\t\t.filter(f => f.get_value())\n\t\t\t.map(f => {\n\t\t\t\tvar v = f.get_value();\n\t\t\t\t// hidden fields dont have $input\n\t\t\t\tif(f.df.hidden) v = f.value;\n\t\t\t\tif(v === '%') v = null;\n\t\t\t\treturn {\n\t\t\t\t\t[f.df.fieldname]: v\n\t\t\t\t};\n\t\t\t})\n\t\t\t.reduce((acc, f) => {\n\t\t\t\tObject.assign(acc, f);\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t\treturn filters;\n\t}\n\n\tget_filter(fieldname) {\n\t\tconst field = (this.filters || []).find(f => f.df.fieldname === fieldname);\n\t\tif (!field) {\n\t\t\tconsole.warn(`[Query Report] Invalid filter: ${fieldname}`);\n\t\t}\n\t\treturn field;\n\t}\n\n\tget_filter_value(fieldname) {\n\t\tconst field = this.get_filter(fieldname);\n\t\treturn field ? field.get_value() : null;\n\t}\n\n\tset_filter_value(fieldname, value) {\n\t\tlet field_value_map = {};\n\t\tif (typeof fieldname === 'string') {\n\t\t\tfield_value_map[fieldname] = value;\n\t\t} else {\n\t\t\tfield_value_map = fieldname;\n\t\t}\n\n\t\tthis._no_refresh = true;\n\t\tObject.keys(field_value_map)\n\t\t\t.forEach((fieldname, i, arr) => {\n\t\t\t\tconst value = field_value_map[fieldname];\n\n\t\t\t\tif (i === arr.length - 1) {\n\t\t\t\t\tthis._no_refresh = false;\n\t\t\t\t}\n\n\t\t\t\tthis.get_filter(fieldname).set_value(value);\n\t\t\t});\n\t}\n\n\tset_breadcrumbs() {\n\t\tif (!this.report_doc || !this.report_doc.ref_doctype) return;\n\t\tconst ref_doctype = frappe.get_meta(this.report_doc.ref_doctype);\n\t\tfrappe.breadcrumbs.add(ref_doctype.module);\n\t}\n\n\tprint_report(print_settings) {\n\t\tconst custom_format = this.report_settings.html_format || null;\n\t\tconst filters_html = this.get_filters_html_for_print();\n\t\tconst landscape = print_settings.orientation == 'Landscape';\n\n\t\tfrappe.render_grid({\n\t\t\ttemplate: custom_format,\n\t\t\ttitle: __(this.report_name),\n\t\t\tsubtitle: filters_html,\n\t\t\tprint_settings: print_settings,\n\t\t\tlandscape: landscape,\n\t\t\tfilters: this.get_filter_values(),\n\t\t\tdata: custom_format ? this.data : this.get_data_for_print(),\n\t\t\tcolumns: custom_format ? this.columns : this.get_columns_for_print(),\n\t\t\treport: this\n\t\t});\n\t}\n\n\tpdf_report(print_settings) {\n\t\tconst base_url = frappe.urllib.get_base_url();\n\t\tconst print_css = frappe.boot.print_css;\n\t\tconst landscape = print_settings.orientation == 'Landscape';\n\n\t\tconst custom_format = this.report_settings.html_format || null;\n\t\tconst columns = custom_format ? this.columns : this.get_columns_for_print();\n\t\tconst data = custom_format ? this.data : this.get_data_for_print();\n\t\tconst applied_filters = this.get_filter_values();\n\n\t\tconst filters_html = this.get_filters_html_for_print();\n\t\tconst content = frappe.render_template(custom_format || 'print_grid', {\n\t\t\ttitle: __(this.report_name),\n\t\t\tsubtitle: filters_html,\n\t\t\tfilters: applied_filters,\n\t\t\tdata: data,\n\t\t\tcolumns: columns,\n\t\t\treport: this\n\t\t});\n\n\t\t// Render Report in HTML\n\t\tconst html = frappe.render_template('print_template', {\n\t\t\ttitle: __(this.report_name),\n\t\t\tcontent: content,\n\t\t\tbase_url: base_url,\n\t\t\tprint_css: print_css,\n\t\t\tprint_settings: print_settings,\n\t\t\tlandscape: landscape,\n\t\t\tcolumns: columns\n\t\t});\n\n\t\tfrappe.render_pdf(html, print_settings);\n\t}\n\n\tget_filters_html_for_print() {\n\t\tconst applied_filters = this.get_filter_values();\n\t\treturn Object.keys(applied_filters)\n\t\t\t.map(fieldname => {\n\t\t\t\tconst label = frappe.query_report.get_filter(fieldname).df.label;\n\t\t\t\tconst value = applied_filters[fieldname];\n\t\t\t\treturn `<h6>${__(label)}: ${value}</h6>`;\n\t\t\t})\n\t\t\t.join('');\n\t}\n\n\texport_report() {\n\t\tif (this.export_dialog) {\n\t\t\tthis.export_dialog.clear();\n\t\t\tthis.export_dialog.show();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.export_dialog = frappe.prompt([\n\t\t\t{\n\t\t\t\tlabel: __('Select File Format'),\n\t\t\t\tfieldname: 'file_format',\n\t\t\t\tfieldtype: 'Select',\n\t\t\t\toptions: ['Excel', 'CSV'],\n\t\t\t\tdefault: 'Excel',\n\t\t\t\treqd: 1,\n\t\t\t\tonchange: () => {\n\t\t\t\t\tthis.export_dialog.set_df_property('with_indentation',\n\t\t\t\t\t\t'hidden', this.export_dialog.get_value('file_format') !== 'CSV');\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('With Group Indentation'),\n\t\t\t\tfieldname: 'with_indentation',\n\t\t\t\tfieldtype: 'Check',\n\t\t\t\thidden: 1\n\t\t\t}\n\t\t], ({ file_format, with_indentation }) => {\n\t\t\tif (file_format === 'CSV') {\n\t\t\t\tconst column_row = this.columns.map(col => col.label);\n\t\t\t\tconst data = this.get_data_for_csv(with_indentation);\n\t\t\t\tconst out = [column_row].concat(data);\n\n\t\t\t\tfrappe.tools.downloadify(out, null, this.report_name);\n\t\t\t} else {\n\t\t\t\tlet filters = this.get_filter_values(true);\n\t\t\t\tif (frappe.urllib.get_dict(\"prepared_report_name\")) {\n\t\t\t\t\tfilters = Object.assign(frappe.urllib.get_dict(\"prepared_report_name\"), filters);\n\t\t\t\t}\n\n\t\t\t\tconst visible_idx = this.datatable.datamanager.getFilteredRowIndices();\n\t\t\t\tif (visible_idx.length + 1 === this.data.length) {\n\t\t\t\t\tvisible_idx.push(visible_idx.length);\n\t\t\t\t}\n\n\t\t\t\tconst args = {\n\t\t\t\t\tcmd: 'frappe.desk.query_report.export_query',\n\t\t\t\t\treport_name: this.report_name,\n\t\t\t\t\tfile_format_type: file_format,\n\t\t\t\t\tfilters: filters,\n\t\t\t\t\tvisible_idx: visible_idx,\n\t\t\t\t};\n\n\t\t\t\topen_url_post(frappe.request.url, args);\n\t\t\t}\n\t\t}, __('Export Report: '+ this.report_name), __('Download'));\n\t}\n\n\tget_data_for_csv(with_indentation = false) {\n\n\t\tconst indices = this.datatable.datamanager.getFilteredRowIndices();\n\t\tconst rows = indices.map(i => this.datatable.datamanager.getRow(i));\n\t\treturn rows.map(row => {\n\t\t\tconst standard_column_count = this.datatable.datamanager.getStandardColumnCount();\n\t\t\treturn row\n\t\t\t\t.slice(standard_column_count)\n\t\t\t\t.map((cell, i) => {\n\t\t\t\tif (with_indentation && i === 0) {\n\t\t\t\t\treturn '   '.repeat(row.meta.indent) + cell.content;\n\t\t\t\t}\n\t\t\t\treturn cell.content;\n\t\t\t});\n\t\t});\n\t}\n\n\tget_data_for_print() {\n\t\tconst indices = this.datatable.datamanager.getFilteredRowIndices();\n\t\tlet rows = indices.map(i => this.data[i]);\n\t\tlet totalRow = this.datatable.bodyRenderer.getTotalRow().reduce((row, cell) => {\n\t\t\trow[cell.column.id] = cell.content;\n\t\t\treturn row;\n\t\t}, {});\n\t\trows.push(totalRow);\n\t\treturn rows;\n\t}\n\n\tget_columns_for_print() {\n\t\treturn this.get_visible_columns();\n\t}\n\n\tget_menu_items() {\n\t\treturn [\n\t\t\t{\n\t\t\t\tlabel: __('Refresh'),\n\t\t\t\taction: () => this.refresh(),\n\t\t\t\tclass: 'visible-xs'\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Edit'),\n\t\t\t\taction: () => frappe.set_route('Form', 'Report', this.report_name),\n\t\t\t\tcondition: () => frappe.user.is_report_manager(),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Print'),\n\t\t\t\taction: () => {\n\t\t\t\t\tfrappe.ui.get_print_settings(\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tprint_settings => this.print_report(print_settings),\n\t\t\t\t\t\tthis.report_doc.letter_head\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tcondition: () => frappe.model.can_print(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('PDF'),\n\t\t\t\taction: () => {\n\t\t\t\t\tfrappe.ui.get_print_settings(\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tprint_settings => this.pdf_report(print_settings),\n\t\t\t\t\t\tthis.report_doc.letter_head\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tcondition: () => frappe.model.can_print(this.report_doc.ref_doctype),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Export'),\n\t\t\t\taction: () => this.export_report(),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Setup Auto Email'),\n\t\t\t\taction: () => frappe.set_route('List', 'Auto Email Report', {'report' : this.report_name}),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('User Permissions'),\n\t\t\t\taction: () => frappe.set_route('List', 'User Permission', {\n\t\t\t\t\tdoctype: 'Report',\n\t\t\t\t\tname: this.report_name\n\t\t\t\t}),\n\t\t\t\tcondition: () => frappe.model.can_set_user_permissions('Report'),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: __('Add to Desktop'),\n\t\t\t\taction: () => frappe.add_to_desktop(this.report_name, null, this.report_name),\n\t\t\t\tstandard: true\n\t\t\t},\n\t\t];\n\t}\n\n\tsetup_report_wrapper() {\n\t\tif (this.$report) return;\n\n\t\tlet page_form = this.page.main.find('.page-form');\n\t\tthis.$status = $(`<div class=\"form-message text-muted small\"></div>`)\n\t\t\t.hide().insertAfter(page_form);\n\n\t\tthis.$chart = $('<div class=\"chart-wrapper\">').hide().appendTo(this.page.main);\n\t\tthis.$report = $('<div class=\"report-wrapper\">').appendTo(this.page.main);\n\t\tthis.$message = $(this.message_div('')).hide().appendTo(this.page.main);\n\t}\n\n\tshow_status(status_message) {\n\t\tthis.$status.html(status_message).show();\n\t}\n\n\thide_status() {\n\t\tthis.$status.hide();\n\t}\n\n\tshow_footer_message() {\n\t\tconst message = __('For comparison, use >5, <10 or =324. For ranges, use 5:10 (for values between 5 & 10).');\n\t\tconst execution_time_msg = __('Execution Time: {0} sec', [this.execution_time || 0.1]);\n\n\t\tthis.page.footer.removeClass('hide').addClass('text-muted col-md-12').html(`\n\t\t\t<span class=\"text-left col-md-6\">${message}</span><span class=\"text-right col-md-6\">${execution_time_msg}</span>\n\t\t`);\n\n\t\tthis.page.wrapper.find('.tree-footer').remove();\n\t\tif (this.tree_report) {\n\t\t\tthis.$tree_footer = this.page.footer.clone().addClass('tree-footer');\n\t\t\tthis.$tree_footer.html(`<div class=\"col-md-12\">\n\t\t\t\t<button class=\"btn btn-xs btn-default\" data-action=\"expand_all_rows\">\n\t\t\t\t\t${__('Expand All')}</button>\n\t\t\t\t<button class=\"btn btn-xs btn-default\" data-action=\"collapse_all_rows\">\n\t\t\t\t\t${__('Collapse All')}</button>\n\t\t\t</div>`);\n\t\t\tthis.page.footer.before(this.$tree_footer);\n\t\t}\n\t\tthis.$tree_footer.find('[data-action=collapse_all_rows]').show();\n\t\tthis.$tree_footer.find('[data-action=expand_all_rows]').hide();\n\t}\n\n\texpand_all_rows() {\n\t\tthis.$tree_footer.find('[data-action=expand_all_rows]').hide();\n\t\tthis.datatable.rowmanager.expandAllNodes();\n\t\tthis.$tree_footer.find('[data-action=collapse_all_rows]').show();\n\t}\n\n\tcollapse_all_rows() {\n\t\tthis.$tree_footer.find('[data-action=collapse_all_rows]').hide();\n\t\tthis.datatable.rowmanager.collapseAllNodes();\n\t\tthis.$tree_footer.find('[data-action=expand_all_rows]').show();\n\t}\n\n\tmessage_div(message) {\n\t\treturn `<div class='flex justify-center align-center text-muted' style='height: 50vh;'>\n\t\t\t<div>${message}</div>\n\t\t</div>`;\n\t}\n\n\treset_report_view() {\n\t\tthis.hide_status();\n\t\tthis.toggle_nothing_to_show(true);\n\t\tthis.refresh();\n\t}\n\n\ttoggle_loading(flag) {\n\t\tthis.toggle_message(flag, __('Loading') + '...');\n\t}\n\n\n\ttoggle_nothing_to_show(flag) {\n\t\tlet message = this.prepared_report\n\t\t\t? __('This is a background report. Please set the appropriate filters and then generate a new one.')\n\t\t\t: __('Nothing to show')\n\n\t\tthis.toggle_message(flag, message);\n\n\t\tif (flag && this.prepared_report) {\n\t\t\tthis.prepared_report_action = \"New\";\n\t\t\tthis.add_prepared_report_buttons();\n\t\t}\n\t}\n\n\ttoggle_message(flag, message) {\n\t\tif (flag) {\n\t\t\tthis.$message.find('div').html(message);\n\t\t\tthis.$message.show();\n\t\t} else {\n\t\t\tthis.$message.hide();\n\t\t}\n\t\tthis.$report.toggle(!flag);\n\t\tthis.$chart.toggle(!flag);\n\t}\n\t// backward compatibility\n\tget get_values() {\n\t\treturn this.get_filter_values;\n\t}\n};\n\nObject.defineProperty(frappe, 'query_report_filters_by_name', {\n\tget() {\n\t\tconsole.warn('[Query Report] frappe.query_report_filters_by_name is deprecated. Please use the new api: frappe.query_report.get_filter_value(fieldname) and frappe.query_report.set_filter_value(fieldname, value)');\n\t\treturn null;\n\t}\n});\n","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\nimport DataTable from 'frappe-datatable';\nfrappe.provide(\"frappe.report_dump\");\n\n$.extend(frappe.report_dump, {\n\tdata: {},\n\tlast_modified: {},\n\twith_data: function(doctypes, callback) {\n\t\tvar pre_loaded = Object.keys(frappe.report_dump.last_modified);\n\t\treturn frappe.call({\n\t\t\tmethod: \"frappe.desk.report_dump.get_data\",\n\t\t\ttype: \"GET\",\n\t\t\targs: {\n\t\t\t\tdoctypes: doctypes,\n\t\t\t\tlast_modified: frappe.report_dump.last_modified\n\t\t\t},\n\t\t\tfreeze: true,\n\t\t\tcallback: function(r) {\n\t\t\t\t// creating map of data from a list\n\t\t\t\t$.each(r.message, function(doctype, doctype_data) {\n\t\t\t\t\tfrappe.report_dump.set_data(doctype, doctype_data);\n\t\t\t\t});\n\n\t\t\t\t// reverse map names\n\t\t\t\t$.each(r.message, function(doctype, doctype_data) {\n\t\t\t\t\t// only if not pre-loaded\n\t\t\t\t\tif(!in_list(pre_loaded, doctype)) {\n\t\t\t\t\t\tif(doctype_data.links) {\n\t\t\t\t\t\t\t$.each(frappe.report_dump.data[doctype], function(row_idx, row) {\n\t\t\t\t\t\t\t\t$.each(doctype_data.links, function(link_key, link) {\n\t\t\t\t\t\t\t\t\tif(frappe.report_dump.data[link[0]][row[link_key]]) {\n\t\t\t\t\t\t\t\t\t\trow[link_key] = frappe.report_dump.data[link[0]][row[link_key]][link[1]];\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trow[link_key] = null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t},\n\tset_data: function(doctype, doctype_data) {\n\t\tvar data = [];\n\t\tvar replace_dict = {};\n\t\tvar make_row = function(d) {\n\t\t\tvar row = {};\n\t\t\t$.each(doctype_data.columns, function(idx, col) {\n\t\t\t\trow[col] = d[idx];\n\t\t\t});\n\t\t\trow.id = row.name;\n\t\t\trow.doctype = doctype;\n\t\t\treturn row;\n\t\t};\n\t\tif(frappe.report_dump.last_modified[doctype]) {\n\t\t\t// partial loading, make a name dict\n\t\t\t$.each(doctype_data.data, function(i, d) {\n\t\t\t\tvar row = make_row(d);\n\t\t\t\treplace_dict[row.name] = row;\n\t\t\t});\n\n\t\t\t// replace old data\n\t\t\t$.each(frappe.report_dump.data[doctype], function(i, d) {\n\t\t\t\tif(replace_dict[d.name]) {\n\t\t\t\t\tdata.push(replace_dict[d.name]);\n\t\t\t\t\tdelete replace_dict[d.name];\n\t\t\t\t} else if(doctype_data.modified_names.indexOf(d.name)!==-1) {\n\t\t\t\t\t// if modified but not in replace_dict, then assume it as cancelled\n\t\t\t\t\t// don't push in data\n\t\t\t\t} else {\n\t\t\t\t\tdata.push(d);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// add new records\n\t\t\t$.each(replace_dict, function(name, d) {\n\t\t\t\tdata.push(d);\n\t\t\t});\n\t\t} else {\n\n\t\t\t// first loading\n\t\t\t$.each(doctype_data.data, function(i, d) {\n\t\t\t\tdata.push(make_row(d));\n\t\t\t});\n\t\t}\n\t\tfrappe.report_dump.last_modified[doctype] = doctype_data.last_modified;\n\t\tfrappe.report_dump.data[doctype] = data;\n\t}\n});\n\nfrappe.provide(\"frappe.views\");\nfrappe.views.GridReport = Class.extend({\n\tinit: function(opts) {\n\t\tthis.filter_inputs = {};\n\t\tthis.preset_checks = [];\n\t\tthis.tree_grid = {show: false};\n\t\t$.extend(this, opts);\n\n\t\tthis.wrapper = $('<div class=\"grid-report\"></div>').appendTo(this.page.main);\n\t\tthis.page.main.find(\".page\").css({\"padding-top\": \"0px\"});\n\n\t\tif(this.filters) {\n\t\t\tthis.make_filters();\n\t\t}\n\t\tthis.make_waiting();\n\n\t\tthis.get_data_and_refresh();\n\t},\n\tbind_show: function() {\n\t\t// bind show event to reset cur_report_grid\n\t\t// and refresh filters from url\n\t\t// this must be called after init\n\t\t// because \"frappe.container.page\" will only be set\n\t\t// once \"load\" event is over.\n\n\t\tvar me = this;\n\t\t$(this.page).bind('show', function() {\n\t\t\t// reapply filters on show\n\t\t\tfrappe.cur_grid_report = me;\n\t\t\tme.get_data_and_refresh();\n\t\t});\n\n\t},\n\tget_data_and_refresh: function() {\n\t\tvar me = this;\n\t\tthis.get_data(function() {\n\t\t\tme.apply_filters_from_route();\n\t\t\tme.refresh();\n\t\t});\n\t},\n\tget_data: function(callback) {\n\t\tvar me = this;\n\n\t\tfrappe.report_dump.with_data(this.doctypes, function() {\n\t\t\tif(!me.setup_filters_done) {\n\t\t\t\tme.setup_filters();\n\t\t\t\tme.setup_filters_done = true;\n\t\t\t}\n\t\t\tcallback();\n\t\t});\n\t},\n\tsetup_filters: function() {\n\t\tvar me = this;\n\n\t\t$.each(me.filter_inputs, function(i, v) {\n\t\t\tvar opts = v.get(0).opts;\n\t\t\tif(opts.fieldtype == \"Select\" && in_list(me.doctypes, opts.link)) {\n\t\t\t\t$(v).add_options(frappe.report_dump.data[opts.link].map(d => d.name));\n\t\t\t} else if(opts.fieldtype == \"Link\" && in_list(me.doctypes, opts.link)) {\n\t\t\t\topts.list = frappe.report_dump.data[opts.link].map(d => d.name);\n\t\t\t\tme.set_autocomplete(v, opts.list);\n\t\t\t}\n\t\t});\n\n\t\t// refresh\n\t\tthis.page.set_primary_action(__(\"Refresh\"), function() {\n\t\t\tme.get_data(function() {\n\t\t\t\tme.refresh();\n\t\t\t});\n\t\t});\n\n\t\t// reset filters button\n\t\tif (this.filter_inputs) {\n\t\t\tthis.page.add_menu_item(__(\"Reset Filters\"), function() {\n\t\t\t\tme.init_filter_values();\n\t\t\t\tme.refresh();\n\t\t\t}, true);\n\t\t}\n\n\t\tthis.page.add_menu_item(__(\"Print\"), function() {\n\t\t\tfrappe.ui.get_print_settings(false, function(print_settings) {\n\t\t\t\tfrappe.render_grid({grid: me.grid, title: me.page.title, print_settings: print_settings, report: me});\n\t\t\t});\n\n\t\t}, true);\n\n\t\t// range\n\t\tthis.filter_inputs.range && this.filter_inputs.range.on(\"change\", function() {\n\t\t\tme.refresh();\n\t\t});\n\t},\n\tset_filter: function(key, value) {\n\t\tvar filters = this.filter_inputs[key];\n\t\tif(filters) {\n\t\t\tvar opts = filters.get(0).opts;\n\t\t\tif(opts.fieldtype === \"Check\") {\n\t\t\t\tfilters.prop(\"checked\", cint(value) ? true : false);\n\t\t\t} if(opts.fieldtype==\"Date\") {\n\t\t\t\tfilters.val(frappe.datetime.str_to_user(value));\n\t\t\t} else {\n\t\t\t\tfilters.val(value);\n\t\t\t}\n\t\t} else {\n\t\t\tfrappe.msgprint(__(\"Invalid Filter: {0}\", [key]));\n\t\t}\n\t},\n\tset_autocomplete: function($filter, list) {\n\t\tvar me = this;\n\t\tnew Awesomplete($filter.get(0), {\n\t\t\tlist: list\n\t\t});\n\t\t$filter.on(\"awesomplete-select\", function(e) {\n\t\t\tvar value = e.originalEvent.text.value;\n\t\t\t$filter.val(value);\n\t\t\tme.refresh();\n\t\t});\n\t},\n\tinit_filter_values: function() {\n\t\t$.each(this.filter_inputs, function(key, filter) {\n\t\t\tvar opts = filter.get(0).opts;\n\t\t\tif(frappe.sys_defaults[key]) {\n\t\t\t\tfilter.val(frappe.sys_defaults[key]);\n\t\t\t} else if(opts.fieldtype=='Select') {\n\t\t\t\tfilter.get(0).selectedIndex = 0;\n\t\t\t} else if(opts.fieldtype=='Data') {\n\t\t\t\tfilter.val(\"\");\n\t\t\t} else if(opts.fieldtype==\"Link\") {\n\t\t\t\tfilter.val(\"\");\n\t\t\t}\n\t\t});\n\n\t\tthis.set_default_values();\n\t},\n\n\tset_default_values: function() {\n\t\tvar values = {\n\t\t\tfrom_date: frappe.datetime.str_to_user(frappe.sys_defaults.year_start_date),\n\t\t\tto_date: frappe.datetime.str_to_user(frappe.sys_defaults.year_end_date)\n\t\t};\n\n\t\tvar me = this;\n\t\t$.each(values, function(i, v) {\n\t\t\tif(me.filter_inputs[i] && !me.filter_inputs[i].val())\n\t\t\t\tme.filter_inputs[i].val(v);\n\t\t});\n\t},\n\n\tmake_filters: function() {\n\t\tvar me = this;\n\t\t$.each(this.filters, function(i, v) {\n\t\t\tv.fieldname = v.fieldname || v.label.replace(/ /g, '_').toLowerCase();\n\t\t\tvar input = null;\n\t\t\tif(v.fieldtype=='Select') {\n\t\t\t\tinput = me.page.add_select(v.label, v.options || [v.default_value]);\n\t\t\t} else if(v.fieldtype==\"Link\") {\n\t\t\t\tinput = me.page.add_data(v.label);\n\t\t\t\tnew Awesomplete(input.get(0), {\n\t\t\t\t\tlist: v.list || []\n\t\t\t\t});\n\t\t\t} else if(v.fieldtype==='Button' && v.label===__(\"Refresh\")) {\n\t\t\t\tinput = me.page.set_primary_action(v.label, null, v.icon);\n\t\t\t} else if(v.fieldtype==='Button') {\n\t\t\t\tinput = me.page.add_menu_item(v.label, null, true);\n\t\t\t} else if(v.fieldtype==='Date') {\n\t\t\t\tinput = me.page.add_date(v.label);\n\t\t\t} else if(v.fieldtype==='Label') {\n\t\t\t\tinput = me.page.add_label(v.label);\n\t\t\t} else if(v.fieldtype==='Data') {\n\t\t\t\tinput = me.page.add_data(v.label);\n\t\t\t} else if(v.fieldtype==='Check') {\n\t\t\t\tinput = me.page.add_check(v.label);\n\t\t\t}\n\n\t\t\tif(input) {\n\t\t\t\tinput && (input.get(0).opts = v);\n\t\t\t\tif(v.cssClass) {\n\t\t\t\t\tinput.addClass(v.cssClass);\n\t\t\t\t}\n\t\t\t\tinput.keypress(function(e) {\n\t\t\t\t\tif(e.which==13) {\n\t\t\t\t\t\tme.refresh();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tme.filter_inputs[v.fieldname] = input;\n\t\t});\n\t},\n\tmake_waiting: function() {\n\t\tthis.waiting = frappe.messages.waiting(this.wrapper, __(\"Loading Report\")+\"...\");\n\t},\n\tload_filter_values: function() {\n\t\tvar me = this;\n\t\t$.each(this.filter_inputs, function(i, f) {\n\t\t\tvar opts = f.get(0).opts;\n\t\t\tif(opts.fieldtype=='Check') {\n\t\t\t\tme[opts.fieldname] = f.prop('checked') ? 1 : 0;\n\t\t\t} else if(opts.fieldtype!='Button') {\n\t\t\t\tme[opts.fieldname] = f.val();\n\t\t\t\tif(opts.fieldtype==\"Date\") {\n\t\t\t\t\tme[opts.fieldname] = frappe.datetime.user_to_str(me[opts.fieldname]);\n\t\t\t\t} else if (opts.fieldtype == \"Select\") {\n\t\t\t\t\tme[opts.fieldname+'_default'] = opts.default_value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif(this.filter_inputs.from_date && this.filter_inputs.to_date && (this.to_date < this.from_date)) {\n\t\t\tfrappe.msgprint(__(\"From Date must be before To Date\"));\n\t\t\treturn;\n\t\t}\n\n\t},\n\n\tmake_name_map: function(data, key) {\n\t\tvar map = {};\n\t\tkey = key || \"name\";\n\t\t$.each(data, function(i, v) {\n\t\t\tmap[v[key]] = v;\n\t\t});\n\t\treturn map;\n\t},\n\n\treset_item_values: function(item) {\n\t\tvar me = this;\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tif (col.formatter==me.currency_formatter) {\n\t\t\t\titem[col.id] = 0.0;\n\t\t\t}\n\t\t});\n\t},\n\n\tround_item_values: function(item) {\n\t\tvar me = this;\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tif (col.formatter==me.currency_formatter) {\n\t\t\t\titem[col.id] = flt(item[col.id], frappe.defaults.get_default(\"float_precision\") || 3);\n\t\t\t}\n\t\t});\n\t},\n\n\tround_off_data: function() {\n\t\tvar me = this;\n\t\t$.each(this.data, function(i, d) {\n\t\t\tme.round_item_values(d);\n\t\t});\n\t},\n\n\trefresh: function() {\n\t\tthis.waiting.toggle(false);\n\t\tif(!this.grid_wrapper)\n\t\t\tthis.make();\n\t\t// this.show_zero = $('.show-zero input:checked').length;\n\t\tthis.load_filter_values();\n\t\tthis.setup_columns();\n\t\tthis.setup_dataview_columns();\n\t\tthis.apply_link_formatters();\n\t\tthis.prepare_data();\n\t\tthis.round_off_data();\n\t\tthis.prepare_data_view();\n\t\t// chart might need prepared data\n\t\tfrappe.show_alert(\"Updated\", 2);\n\t\tthis.render();\n\t\tthis.setup_chart && this.setup_chart();\n\t},\n\tsetup_dataview_columns: function() {\n\t\tthis.columns = this.columns.filter(col => !col.hidden);\n\t\tthis.datatable_columns = this.columns.map(column => {\n\t\t\treturn Object.assign(column, {\n\t\t\t\tformat: (value, row, column, data) => {\n\t\t\t\t\treturn column.formatter ?\n\t\t\t\t\t\tcolumn.formatter(row, {}, value, column, data) :\n\t\t\t\t\t\tvalue || '';\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\tmake: function() {\n\t\t// chart wrapper\n\t\tthis.chart_area = $('<div class=\"chart\" style=\"padding-bottom: 1px\"></div>').appendTo(this.wrapper);\n\n\t\tthis.page.add_menu_item(__(\"Export\"), () =>  this.export(), true);\n\n\t\t// grid wrapper\n\t\tthis.grid_wrapper = $(\"<div style='height: 500px;'>\")\n\t\t\t.appendTo(this.wrapper);\n\t\tthis.id = frappe.dom.set_unique_id(this.grid_wrapper.get(0));\n\n\t\tthis.bind_show();\n\n\t\tfrappe.cur_grid_report = this;\n\t\t$(this.wrapper).trigger('make');\n\n\t},\n\tapply_filters_from_route: function() {\n\t\tvar me = this;\n\t\tif(frappe.route_options) {\n\t\t\t$.each(frappe.route_options, function(key, value) {\n\t\t\t\tme.set_filter(key, value);\n\t\t\t});\n\t\t\tfrappe.route_options = null;\n\t\t} else {\n\t\t\tthis.init_filter_values();\n\t\t}\n\t\tthis.set_default_values();\n\n\t\t$(this.wrapper).trigger('apply_filters_from_route');\n\t},\n\toptions: {\n\t\teditable: false,\n\t\tenableColumnReorder: false\n\t},\n\trender: function() {\n\t\tthis.datatable = new DataTable('#' + this.id, {\n\t\t\tcolumns: this.datatable_columns,\n\t\t\tdata: this.data,\n\t\t\tlayout: 'fixed',\n\t\t\tinlineFilters: true,\n\t\t\ttreeView: true,\n\t\t\tcheckboxColumn: true,\n\t\t\tcheckedRowStatus: false,\n\t\t\tevents: {\n\t\t\t\tonCheckRow: (row) => {\n\t\t\t\t\tconst rowIndex = row.meta.rowIndex;\n\t\t\t\t\tconst checked = this.datatable.rowmanager.checkMap[rowIndex];\n\t\t\t\t\tconst data = this.datatable.datamanager.getData(rowIndex);\n\t\t\t\t\tdata.checked = Boolean(checked);\n\n\t\t\t\t\tthis.setup_chart && this.setup_chart();\n\t\t\t\t}\n\t\t\t},\n\t\t\thooks: {\n\t\t\t\tcolumnTotal: frappe.utils.report_column_total\n\t\t\t}\n\t\t});\n\n\t\tthis.data.forEach((d, i) => {\n\t\t\tif (d.checked) {\n\t\t\t\tthis.datatable.rowmanager.checkRow(i, true);\n\t\t\t}\n\t\t});\n\t},\n\tprepare_data_view: function() {\n\t},\n\texport: function() {\n\t\tfrappe.tools.downloadify(frappe.slickgrid_tools.get_view_data(this.columns, this.dataView),\n\t\t\t[\"Report Manager\", \"System Manager\"], this.title);\n\t\treturn false;\n\t},\n\tapply_filters: function(item) {\n\t\t// generic filter: apply filter functiions\n\t\t// from all filter_inputs\n\t\tvar filters = this.filter_inputs;\n\t\tif(item._show) return true;\n\n\t\tfor (var i in filters) {\n\t\t\tif(!this.apply_filter(item, i)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\tapply_filter: function(item, fieldname) {\n\t\tvar filter = this.filter_inputs[fieldname].get(0);\n\t\tif(filter.opts.filter) {\n\t\t\tif(!filter.opts.filter(this[filter.opts.fieldname], item, filter.opts, this)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\tapply_zero_filter: function(val, item, opts, me) {\n\t\t// show only non-zero values\n\t\tif(!me.show_zero) {\n\t\t\tfor(var i=0, j=me.columns.length; i<j; i++) {\n\t\t\t\tvar col = me.columns[i];\n\t\t\t\tif(col.formatter==me.currency_formatter && !col.hidden) {\n\t\t\t\t\tif(flt(item[col.field]) > 0.001 ||  flt(item[col.field]) < -0.001) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\tshow_zero_check: function() {\n\t\tvar me = this;\n\t\tthis.wrapper.bind('make', function() {\n\t\t\tme.wrapper.find('.show-zero').toggle(true).find('input').click(function(){\n\t\t\t\tme.refresh();\n\t\t\t});\n\t\t});\n\t},\n\tis_default: function(fieldname) {\n\t\treturn this[fieldname]==this[fieldname + \"_default\"];\n\t},\n\tdate_formatter: function(row, cell, value) {\n\t\treturn frappe.datetime.str_to_user(value);\n\t},\n\tcurrency_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\tif (isNaN(value)) value = '';\n\t\treturn repl('<div style=\"text-align: right; %(_style)s\">%(value)s</div>', {\n\t\t\t_style: dataContext._style || \"\",\n\t\t\tvalue: ((value==null || value===\"\") ? \"\" : format_number(value))\n\t\t});\n\t},\n\ttext_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\treturn repl('<span style=\"%(_style)s\" title=\"%(esc_value)s\">%(value)s</span>', {\n\t\t\t_style: dataContext._style || \"\",\n\t\t\tesc_value: cstr(value).replace(/\"/g, '\\\\\"'),\n\t\t\tvalue: cstr(value)\n\t\t});\n\t},\n\tcheck_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\treturn repl('<input type=\"checkbox\" data-id=\"%(id)s\" \\\n\t\t\tclass=\"chart-check\" %(checked)s>', {\n\t\t\t\t\"id\": dataContext.id,\n\t\t\t\t\"checked\": dataContext.checked ? 'checked=\"checked\"' : \"\"\n\t\t\t});\n\t},\n\tapply_link_formatters: function() {\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tif(col.link_formatter) {\n\t\t\t\tcol.formatter = function(row, cell, value, columnDef, dataContext, for_print) {\n\t\t\t\t\t// added link and open button to links\n\t\t\t\t\t// link_formatter must have\n\t\t\t\t\t// filter_input, open_btn (true / false), doctype (will be eval'd)\n\t\t\t\t\tif(!value) return \"\";\n\n\t\t\t\t\tif(for_print) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar me = frappe.cur_grid_report;\n\n\t\t\t\t\tif(dataContext._show) {\n\t\t\t\t\t\treturn repl('<span style=\"%(_style)s\">%(value)s</span>', {\n\t\t\t\t\t\t\t_style: dataContext._style || \"\",\n\t\t\t\t\t\t\tvalue: value\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// make link to add a filter\n\t\t\t\t\tvar html;\n\t\t\t\t\tvar link_formatter = me.dataview_columns[cell].link_formatter;\n\t\t\t\t\tif (link_formatter.filter_input) {\n\t\t\t\t\t\thtml = repl('<a href=\"#\" \\\n\t\t\t\t\t\t\tonclick=\"frappe.cur_grid_report.set_filter(\\'%(col_name)s\\', \\'%(value)s\\'); \\\n\t\t\t\t\t\t\t\tfrappe.cur_grid_report.refresh(); return false;\">\\\n\t\t\t\t\t\t\t%(value)s</a>', {\n\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\tcol_name: link_formatter.filter_input,\n\t\t\t\t\t\t\t\tpage_name: frappe.container.page.page_name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\thtml = value;\n\t\t\t\t\t}\n\n\t\t\t\t\t// make icon to open form\n\t\t\t\t\tif(link_formatter.open_btn) {\n\t\t\t\t\t\tvar doctype = link_formatter.doctype\n\t\t\t\t\t\t\t? eval(link_formatter.doctype)\n\t\t\t\t\t\t\t: dataContext.doctype;\n\t\t\t\t\t\thtml += me.get_link_open_icon(doctype, value);\n\t\t\t\t\t}\n\t\t\t\t\treturn html;\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t},\n\tget_link_open_icon: function(doctype, name) {\n\t\treturn repl(' <a href=\"#Form/%(doctype)s/%(name)s\">\\\n\t\t\t<i class=\"fa fa-share\" style=\"cursor: pointer;\"></i></a>', {\n\t\t\t\tdoctype: doctype,\n\t\t\t\tname: encodeURIComponent(name)\n\t\t\t});\n\t},\n\tmake_date_range_columns: function() {\n\t\tthis.columns = [];\n\n\t\tvar me = this;\n\t\tvar range = this.filter_inputs.range.val();\n\t\tthis.from_date = frappe.datetime.user_to_str(this.filter_inputs.from_date.val());\n\t\tthis.to_date = frappe.datetime.user_to_str(this.filter_inputs.to_date.val());\n\t\tvar date_diff = frappe.datetime.get_diff(this.to_date, this.from_date);\n\n\t\tme.column_map = {};\n\t\tme.last_date = null;\n\n\t\tvar add_column = function(date) {\n\t\t\tme.columns.push({\n\t\t\t\tid: date,\n\t\t\t\tname: frappe.datetime.str_to_user(date),\n\t\t\t\tfield: date,\n\t\t\t\tformatter: me.currency_formatter,\n\t\t\t\twidth: 100\n\t\t\t});\n\t\t};\n\n\t\tvar build_columns = function(condition) {\n\t\t\t// add column for each date range\n\t\t\tfor(var i=0; i <= date_diff; i++) {\n\t\t\t\tvar date = frappe.datetime.add_days(me.from_date, i);\n\t\t\t\tif(!condition) condition = () => true;\n\n\t\t\t\tif(condition(date)) add_column(date);\n\t\t\t\tme.last_date = date;\n\n\t\t\t\tif(me.columns.length) {\n\t\t\t\t\tme.column_map[date] = me.columns[me.columns.length-1];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// make columns for all date ranges\n\t\tif(range=='Daily') {\n\t\t\tbuild_columns();\n\t\t} else if(range=='Weekly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn !(frappe.datetime.get_diff(date, me.from_date) % 7);\n\t\t\t});\n\t\t} else if(range=='Monthly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn frappe.datetime.str_to_obj(me.last_date).getMonth() != frappe.datetime.str_to_obj(date).getMonth();\n\t\t\t});\n\t\t} else if(range=='Quarterly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn frappe.datetime.str_to_obj(date).getDate()==1 && in_list([0,3,6,9], frappe.datetime.str_to_obj(date).getMonth());\n\t\t\t});\n\t\t} else if(range=='Yearly') {\n\t\t\tbuild_columns(function(date) {\n\t\t\t\tif(!me.last_date) return true;\n\t\t\t\treturn $.map(frappe.report_dump.data['Fiscal Year'], function(v) {\n\t\t\t\t\treturn date==v.year_start_date ? true : null;\n\t\t\t\t}).length;\n\t\t\t});\n\n\t\t}\n\n\t\t// set label as last date of period\n\t\t$.each(this.columns, function(i, col) {\n\t\t\tcol.name = me.columns[i+1]\n\t\t\t\t? frappe.datetime.str_to_user(frappe.datetime.add_days(me.columns[i+1].id, -1))\n\t\t\t\t: frappe.datetime.str_to_user(me.to_date);\n\t\t});\n\t},\n\ttrigger_refresh_on_change: function(filters) {\n\t\tvar me = this;\n\t\t$.each(filters, function(i, f) {\n\t\t\tme.filter_inputs[f] && me.filter_inputs[f].on(\"change\", function() {\n\t\t\t\tme.refresh();\n\t\t\t});\n\t\t});\n\t}\n});\n\nfrappe.views.GridReportWithPlot = frappe.views.GridReport.extend({\n\tsetup_chart: function() {\n\t\tif (in_list([\"Daily\", \"Weekly\"], this.filter_inputs.range.val())) {\n\t\t\tthis.chart_area.toggle(false);\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis.chart_area.toggle(true);\n\t\t}\n\t\tvar chart_data = this.get_chart_data ? this.get_chart_data() : null;\n\n\t\tconst parent = this.wrapper.find('.chart')[0];\n\t\tthis.chart = new Chart(parent, {\n\t\t\theight: 200,\n\t\t\tdata: chart_data,\n\t\t\ttype: 'line'\n\t\t});\n\t},\n\n\tget_chart_data: function() {\n\t\tvar me = this;\n\t\tvar plottable_cols = [];\n\t\t$.each(me.columns, function(idx, col) {\n\t\t\tif(col.formatter==me.currency_formatter && !col.hidden && col.plot!==false) {\n\t\t\t\tplottable_cols.push(col.field);\n\t\t\t}\n\t\t});\n\n\t\tvar data = {\n\t\t\tlabels: plottable_cols,\n\t\t\tdatasets: []\n\t\t};\n\n\t\t$.each(this.data, function(i, item) {\n\t\t\tif (item.checked) {\n\t\t\t\tlet dataset = {};\n\t\t\t\tdataset.name = item.name;\n\t\t\t\tdataset.values = [];\n\t\t\t\t$.each(plottable_cols, function(idx, col) {\n\t\t\t\t\tdataset.values.push(item[col]);\n\t\t\t\t});\n\t\t\t\tdata[\"datasets\"].push(dataset);\n\t\t\t}\n\t\t});\n\t\treturn data;\n\t}\n});\n\n\nfrappe.views.TreeGridReport = frappe.views.GridReportWithPlot.extend({\n\tmake_transaction_list: function(parent_doctype, doctype) {\n\t\tvar me = this;\n\t\tvar tmap = {};\n\t\t$.each(frappe.report_dump.data[doctype], function(i, v) {\n\t\t\tif(!tmap[v.parent]) tmap[v.parent] = [];\n\t\t\ttmap[v.parent].push(v);\n\t\t});\n\t\tif (!this.tl) this.tl = {};\n\t\tif (!this.tl[parent_doctype]) this.tl[parent_doctype] = [];\n\n\t\t$.each(frappe.report_dump.data[parent_doctype], function(i, parent) {\n\t\t\tif(tmap[parent.name]) {\n\t\t\t\t$.each(tmap[parent.name], function(i, d) {\n\t\t\t\t\tme.tl[parent_doctype].push($.extend(copy_dict(parent), d));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n\tadd_tree_grid_events: function() {\n\t\tvar me = this;\n\t\tthis.grid.onClick.subscribe(function(e, args) {\n\t\t\tif ($(e.target).hasClass(\"toggle\")) {\n\t\t\t\tvar item = me.dataView.getItem(args.row);\n\t\t\t\tif (item) {\n\t\t\t\t\tif (!item._collapsed) {\n\t\t\t\t\t\titem._collapsed = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem._collapsed = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tme.dataView.updateItem(item.id, item);\n\t\t\t\t}\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t}\n\t\t});\n\t},\n\ttree_formatter: function(row, cell, value, columnDef, dataContext) {\n\t\tvar me = frappe.cur_grid_report;\n\t\tvar data = me.data;\n\t\tvar spacer = \"<span style='display:inline-block;height:1px;width:\" +\n\t\t\t(15 * dataContext[\"indent\"]) + \"px'></span>\";\n\t\tvar idx = me.dataView.getIdxById(dataContext.id);\n\t\tvar link = me.tree_grid.formatter(dataContext);\n\n\t\tif(dataContext.doctype) {\n\t\t\tlink += me.get_link_open_icon(dataContext.doctype, dataContext.name);\n\t\t}\n\n\t\tif (data[idx + 1] && data[idx + 1].indent > data[idx].indent) {\n\t\t\tif (dataContext._collapsed) {\n\t\t\t\treturn spacer + \" <span class='toggle expand'></span>&nbsp;\" + link;\n\t\t\t} else {\n\t\t\t\treturn spacer + \" <span class='toggle collapse'></span>&nbsp;\" + link;\n\t\t\t}\n\t\t} else {\n\t\t\treturn spacer + \" <span class='toggle'></span>&nbsp;\" + link;\n\t\t}\n\t},\n\ttree_dataview_filter: function(item) {\n\t\tvar me = frappe.cur_grid_report;\n\t\tif(!me.apply_filters(item)) return false;\n\n\t\tvar parent = item[me.tree_grid.parent_field];\n\t\twhile (parent) {\n\t\t\tif (me.item_by_name[parent]._collapsed) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tparent = me.parent_map[parent];\n\t\t}\n\t\treturn true;\n\t},\n\tprepare_tree: function(item_dt, group_dt) {\n\t\tvar group_data = frappe.report_dump.data[group_dt];\n\t\tvar item_data = frappe.report_dump.data[item_dt];\n\n\t\t// prepare map with child in respective group\n\t\tvar me = this;\n\t\tvar item_group_map = {};\n\t\tvar group_ids = group_data.map(v => v.id);\n\n\t\t$.each(item_data, function(i, item) {\n\t\t\tvar parent = item[me.tree_grid.parent_field];\n\t\t\tif(!item_group_map[parent]) item_group_map[parent] = [];\n\t\t\tif(group_ids.indexOf(item.name)==-1) {\n\t\t\t\titem_group_map[parent].push(item);\n\t\t\t} else {\n\t\t\t\tfrappe.msgprint(__(\"Ignoring Item {0}, because a group exists with the same name!\", [item.name.bold()]));\n\t\t\t}\n\t\t});\n\n\t\t// arrange items besides their parent item groups\n\t\tvar items = [];\n\t\t$.each(group_data, function(i, group){\n\t\t\tgroup.is_group = true;\n\t\t\titems.push(group);\n\t\t\titems = items.concat(item_group_map[group.name] || []);\n\t\t});\n\t\treturn items;\n\t},\n\tset_indent: function() {\n\t\tvar me = this;\n\t\t$.each(this.data, function(i, d) {\n\t\t\tvar indent = 0;\n\t\t\tvar parent = me.parent_map[d.name];\n\t\t\tif(parent) {\n\t\t\t\twhile(parent) {\n\t\t\t\t\tindent++;\n\t\t\t\t\tparent = me.parent_map[parent];\n\t\t\t\t}\n\t\t\t}\n\t\t\td.indent = indent;\n\t\t});\n\t},\n\n\texport: function() {\n\t\tvar msgbox =\tfrappe.msgprint($.format('<p>{0}</p>\\\n\t\t\t<p><input type=\"checkbox\" name=\"with_groups\" checked=\"checked\"> {1}</p>\\\n\t\t\t<p><input type=\"checkbox\" name=\"with_ledgers\" checked=\"checked\"> {2}</p>\\\n\t\t\t<p><button class=\"btn btn-primary\"> {3}</button>', [\n\t\t\t\t__('Select To Download:'),\n\t\t\t\t__('With Groups'),\n\t\t\t\t__('With Ledgers'),\n\t\t\t\t__('Download')\n\t\t\t]));\n\n\t\tvar me = this;\n\n\t\t$(msgbox.body).find(\"button\").click(function() {\n\t\t\tvar with_groups = $(msgbox.body).find(\"[name='with_groups']\").prop(\"checked\");\n\t\t\tvar with_ledgers = $(msgbox.body).find(\"[name='with_ledgers']\").prop(\"checked\");\n\n\t\t\tvar data = frappe.slickgrid_tools.get_view_data(me.columns, me.data,\n\t\t\t\tfunction(row, item) {\n\t\t\t\t\tif(with_groups) {\n\t\t\t\t\t\t// add row\n\t\t\t\t\t\tfor(var i=0; i<item.indent; i++) row[0] = \"   \" + row[0];\n\t\t\t\t\t}\n\t\t\t\t\tif(with_groups && (item.is_group == 1 || item.is_group)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif(with_ledgers && (item.is_group != 1 && !item.is_group)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\n\t\t\tfrappe.tools.downloadify(data, [\"Report Manager\", \"System Manager\"], me.title);\n\t\t\treturn false;\n\t\t});\n\n\t\treturn false;\n\t},\n\n});\n"],"names":["module","q","b","a","c","addEventListener","attachEvent","n","removeEventListener","detachEvent","r","Object","prototype","toString","call","m","window","getComputedStyle","currentStyle","l","document","createElement","all","innerHTML","documentMode","x","navigator","platform","toLowerCase","indexOf","p","this","rows_in_block","blocks_in_cluster","tag","show_no_data_row","no_data_class","no_data_text","keep_parity","callbacks","options","h","d","split","f","getElementById","Error","content_elem","hasAttribute","setAttribute","e","rows","fetchMarkup","g","scroll_elem","scrollTop","insertToDOM","k","t","style","pointerEvents","clearTimeout","setTimeout","getClusterNum","scrollingProgress","getScrollProgress","u","v","refresh","destroy","html","generateEmptyRow","join","getRowsHeight","update","length","item_height","clear","getRowsAmount","scroll_top","w","concat","append","prepend","constructor","getChildNodes","push","shift","outerHTML","exploreEnvironment","content_tag","tagName","match","children","data","cluster_height","Math","floor","offsetHeight","parseInt","max","block_height","rows_in_cluster","createTextNode","className","colSpan","appendChild","generate","top_offset","bottom_offset","rows_above","renderExtraTag","height","checkChanges","clusterWillChange","clusterChanged","lastChild","removeChild","firstChild","frappe","views","ReportFactory","Factory","[object Object]","route","const","_route","set_route","factory","dragEl","parentEl","ghostEl","cloneEl","rootEl","nextEl","lastDownEl","scrollEl","scrollParentEl","scrollCustomFn","lastEl","lastCSS","lastParentCSS","oldIndex","newIndex","activeGroup","putSortable","tapEvt","touchEvt","moved","el","autoScroll","R_SPACE","R_FLOAT","expando","Date","getTime","win","$","jQuery","Zepto","Polymer","captureMode","supportDraggable","supportCssPointerEvents","userAgent","cssText","_silent","abs","min","savedInputChecked","touchDragOverListeners","_autoScroll","_throttle","evt","scroll","rect","vx","vy","scrollOffsetX","scrollOffsetY","_this","sens","scrollSensitivity","speed","scrollSpeed","clientX","y","clientY","winWidth","innerWidth","winHeight","innerHeight","scrollFn","offsetWidth","scrollWidth","scrollHeight","parentNode","getBoundingClientRect","right","left","bottom","top","clearInterval","pid","setInterval","scrollTo","pageXOffset","pageYOffset","scrollLeft","_prepareGroup","toFn","value","pull","group","name","to","from","fromGroup","originalGroup","checkPull","checkPut","put","revertClone","defineProperty","get","capture","passive","err","Sortable","nodeType","_extend","defaults","random","sort","disabled","store","handle","draggable","test","nodeName","ghostClass","chosenClass","dragClass","ignore","filter","preventOnFilter","animation","setData","dataTransfer","textContent","dropBubble","dragoverBubble","dataIdAttr","delay","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","fn","charAt","bind","nativeDraggable","_on","_onTapStart","_onDragOver","_cloneHide","sortable","state","lastPullMode","_css","insertBefore","_animate","_closest","selector","ctx","_matches","_getParentOrHost","parent","host","event","_off","_toggleClass","classList","replace","prop","val","defaultView","_find","iterator","list","getElementsByTagName","i","_dispatchEvent","targetEl","toEl","fromEl","startIndex","createEvent","onName","toUpperCase","substr","initEvent","item","clone","dispatchEvent","_onMove","dragRect","targetRect","originalEvt","willInsertAfter","retVal","onMoveFn","onMove","dragged","draggedRect","related","relatedRect","_disableDraggable","_unsilent","_generateId","str","src","href","sum","charCodeAt","_index","index","previousElementSibling","re","RegExp","callback","ms","args","arguments","apply","dst","key","hasOwnProperty","_clone","dom","cloneNode","_nextTick","_cancelNextTick","id","type","touch","touches","target","originalTarget","shadowRoot","path","root","inputs","idx","checked","_saveInputCheckedState","button","isContentEditable","preventDefault","some","criteria","trim","_prepareDragStart","dragStartFn","ownerDocument","nextSibling","_lastX","_lastY","_disableDelayedDrag","_triggerDragStart","forEach","_onDrop","_dragStartTimer","pointerType","_onDragStart","selection","empty","getSelection","removeAllRanges","_dragStarted","active","_nulling","_emulateDragOver","elementFromPoint","_onTouchMove","dx","dy","translate3d","_appendGhost","ghostRect","css","marginTop","marginLeft","width","body","useFallback","_offUpEvents","_cloneId","_loopId","effectAllowed","_dragStartId","revert","activeSortable","isOwner","isMovingBetweenSortable","canSort","stopPropagation","animated","contains","lastElementChild","floating","cssFloat","display","isWide","isLong","halfway","nextElementSibling","after","elTop","offsetTop","tgTop","moveVector","prevRect","currentRect","save","handleEvent","dropEffect","_globalDragOver","toArray","order","getAttribute","items","set","closest","option","Array","querySelectorAll","removeAttribute","splice","utils","on","off","find","is","extend","throttle","toggleClass","nextTick","cancelNextTick","create","version","ex","require$$0","expr","con","querySelector","each","o","let","element","ref","keys","map","delegate","handler","delegatedTarget","unbind","fire","properties","j","attrs","dataset","attr","elements","styleMap","getStyle","isArray","removeStyle","styleProps","includes","parseFloat","matches","inViewport","pTop","pLeft","pBottom","pRight","pixels","requestAnimationFrame","scrollbarSize","scrollBarSizeValue","scrollDiv","overflow","position","scrollbarWidth","clientWidth","getScrollBarSize","hasVerticalOverflow","hasHorizontalOverflow","measureTextWidth","text","div","visibility","whiteSpace","innerText","isObject_1","commonjsGlobal","global","self","commonjsRequire","_freeGlobal","freeSelf","_root","Function","now_1","now","_Symbol","Symbol","objectProto","nativeObjectToString","symToStringTag","toStringTag","undefined","_getRawTag","isOwn","result","nativeObjectToString$1","_objectToString","nullTag","undefinedTag","symToStringTag$1","_baseGetTag","isObjectLike_1","symbolTag","isSymbol_1","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","toNumber_1","other","valueOf","isBinary","slice","FUNC_ERROR_TEXT","nativeMax","nativeMin","debounce_1","func","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","thisArg","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","cancel","flush","FUNC_ERROR_TEXT$1","throttle_1","asyncTag","funcTag","genTag","proxyTag","uid","isFunction_1","_coreJsData","maskSrcKey","exec","IE_PROTO","_isMasked","funcToString","_toSource","reIsHostCtor","funcProto$1","objectProto$2","funcToString$1","hasOwnProperty$1","reIsNative","_baseIsNative","_getValue","object","_getNative","_nativeCreate","_hashClear","__data__","size","_hashDelete","has","HASH_UNDEFINED","hasOwnProperty$2","_hashGet","hasOwnProperty$3","_hashHas","HASH_UNDEFINED$1","_hashSet","Hash","entries","entry","_Hash","_listCacheClear","eq_1","_assocIndexOf","array","_listCacheDelete","pop","_listCacheGet","_listCacheHas","_listCacheSet","ListCache","_ListCache","_Map","_mapCacheClear","hash","string","_isKeyable","_getMapData","_mapCacheDelete","_mapCacheGet","_mapCacheHas","_mapCacheSet","MapCache","_MapCache","HASH_UNDEFINED$2","_setCacheAdd","_setCacheHas","SetCache","values","add","_SetCache","_baseFindIndex","predicate","fromIndex","fromRight","_baseIsNaN","_strictIndexOf","_baseIndexOf","_arrayIncludes","_arrayIncludesWith","comparator","_cacheHas","cache","_Set","noop_1","_setToArray","_createSet","LARGE_ARRAY_SIZE","_baseUniq","iteratee","isCommon","seen","outer","computed","seenIndex","uniq_1","camelCaseToDash","makeDataAttributeString","props","_key","copyTextToClipboard","textArea","padding","border","outline","boxShadow","background","select","execCommand","console","log","throttle$1","debounce$1","context","Promise","resolve","out","linkProperties","source","reduce","acc","defineProperties","isNumber","isNaN","numberSortAsc","DataManager","sortRows","switchColumn","removeColumn","filterRows","columns","rowCount","prepareColumns","prepareRows","prepareTreeRows","prepareRowView","prepareNumericColumns","currentSort","col","sortOrder","colIndex","validateColumns","prepareDefaultColumns","prepareHeader","checkboxColumn","hasColumnById","cell","content","getCheckboxHTML","editable","resizable","focusable","dropdown","serialNoColumn","align","baseCell","isHeader","format","prepareCell","assign","column","row0","getRow","cellValue","validateData","_getNextRowCount","row","meta","rowIndex","indent","prepareRow","nextRow","isLeaf","isSet","isTreeNodeClose","rowViewOrder","baseRowCell","DataError","getColumns","_sortRows","reverseArray","aIndex","bIndex","aContent","getCell","bContent","srNoColIndex","getColumnIndexById","viewIndex","temporary","index1","index2","temp","newCell1","newCell2","_row","findIndex","newVal","keyValPairs","getColumn","filters","then","getAllRowIndices","rowsToShow","_filteredRows","start","end","skipStandardColumns","getStandardColumnCount","parentRowIndex","parentIndent","childIndent","Boolean","icons","chevronDown","chevronRight","CellManager","instance","bindEvents","bindFocusCell","bindEditCell","bindKeyboardSelection","bindCopyCellContents","bindMouseEvents","bindTreeEvents","bindKeyboardNav","$editingCell","bodyScrollable","activateEditing","keyboard","$focusedCell","submitEditing","deactivateEditing","direction","$cell","getLeftCell$","getRightCell$","getAboveCell$","getBelowCell$","focusCell","getLeftMostCell$","getRightMostCell$","getTopMostCell$","getBottomMostCell$","focusLastCell","columnmanager","toggleFilter","inlineFilters","activateFilter","header","unfocusCell","selectArea","$selectionCursor","getSelectionCursor","getNextSelectionCursor","noOfCellsCopied","copyCellContents","message","showToastMessage","pasteFromClipboard","pasteTarget","focus","pasteContentInCell","mouseDown","$toggle","rowmanager","openSingleNode","closeSingleNode","skipScrollToCell","scrollToCell","skipClearSelection","clearSelection","remove","skipDOMFocus","highlightRowColumnHeader","lastHeaders","colHeaderSelector","rowHeaderSelector","datamanager","colHeader","wrapper","rowHeader","getCell$","fCell","_selectArea","$cell1","$cell2","cells","getCellsInRange","_selectedCells","colIndex1","rowIndex1","colIndex2","rowIndex2","cell1","cell2","isStandardCell","rowIndices","_rowIndex","_colIndex","$editCell","editor","getEditor","currentCellEditor","initValue","getData","getDefaultEditor","$input","class","inside","getValue","setValue","valuePromise","done","oldValue","updateCell","catch","curr","total","matrix","every","it","focusedCell","focusFilter","isFilterShown","refreshCell","getCellContent","flag","getFirstColumnIndex","$aboveRow","parentElement","$belowRow","getLastColumnIndex","getFirstRowIndex","getLastRowIndex","scrollToRow","ceil","getViewportHeight","getRowHeight","dataAttr","isFilter","isTotalRow","isBodyCell","contentHTML","editCellHTML","getEditCellHTML","sortIndicator","resizeColumn","getDropdownHTML","customFormatter","treeView","addToggle","ColumnManager","refreshHeader","getHeaderHTML","$filterRow","$columnMap","bindMoveColumn","getRowHTML","bindDropdown","bindResizeColumn","bindPerfectColumnWidth","bindFilter","dropdownClass","dropdownContainer","getDropdownListHTML","$dropdownList","firstElementChild","openDropdown","deactivateDropdownOnBodyClick","deactivateDropdown","$item","_dropdownActiveColIndex","dropdownItems","headerDropdown","action","hideDropdown","_dropdownWidth","$resizingCell","startWidth","startX","isDragging","$handle","pageX","onMouseup","setColumnWidth","setBodyStyle","onMouseMove","finalWidth","updateColumn","setColumnHeaderWidth","longestCell","bodyRenderer","visibleRows","$longestCellHTML","cellmanager","getCellHTML","$div","cellText","$parent","onEnd","$draggedCell","nextSortOrder","freeze","refreshRows","unfreeze","fireEvent","removedCol","showFilter","applyFilter","getAppliedFilters","showRows","input","columnsToSort","sortColumn","columnWidth","styles","setStyle","$column","minWidth","getColumnCount","RowManager","bindCheckbox","checkMap","$checkbox","checkAll","checkRow","renderBody","setDimensions","updateRow","getCheckedRows","toggle","highlightRow","showCheckStatus","getTotalRows","highlightAll","checkedRowStatus","count","clearToastMessage","$row","getRow$","_highlightedRows","renderRows","arr","childrenToShow","getImmediateChildren","visibleRowIndices","rowsToHide","getChildren","getRows","getRowCount","_lastScrollTo","rowsInView","offset","rowIdentifier","getFilterInput","hyperlist","exports","createCommonjsModule","s","code","1","_dereq_","_createClass","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","defaultConfig","Number","HyperList","userProvidedConfig","_classCallCheck","_config","_lastRepaint","_maxElementHeight","getMaxBrowserHeight","config","render","_getScrollPosition","lastRepaint","_renderAnimationFrame","_averageHeight","rendered","_renderChunk","afterRender","fixture","mergeStyle","opacity","maxElementHeight","cancelAnimationFrame","_this2","_element","scroller","_scroller","scrollerTagName","useFragment","itemHeight","_itemHeights","fill","isValueNumber","isValuePercent","msg","numberValue","_containerHeight","elementStyle","scrollerHeight","warn","scrollerStyle","_scrollHeight","_computeScrollHeight","_itemPositions","_computePositions","oldClass","rowClassName","overrideScrollPosition","force","reverse","_getReverseFrom","_getFrom","_screenItemsLen","_lastFrom","_cachedItemsLen","fragment","createDocumentFragment","_getRow","applyPatch","_this3","sortedItemHeights","middle","averageHeight","containerHeight","clientHeight","default","__esModule","BodyRenderer","footer","computedStyle","cellHeight","rowHTML","restoreState","renderFooter","getRowsForView","showTotalRow","totalRow","getTotalRow","hooks","columnTotal","columnValues","prevRow","prevCell","highlightCheckedRows","selectAreaOnClusterChanged","focusCellOnClusterChanged","hideAfter","toastMessage","getToastMessageHTML","Style","scopeClass","instances","datatableWrapper","styleEl","bindResizeWindow","bindScrollHeader","stylesheet","sheet","onWindowResize","layout","_settingHeaderPosition","transform","distributeRemainingWidth","refreshColumnWidth","styleObject","_styleRulesMap","prefixedSelector","_getPrefixedSelector","ruleString","_getRuleString","insertRule","cssRules","rule","selectorText","deleteRule","dashed","setupMinWidth","setupNaturalColumnWidth","setupColumnWidth","setColumnStyle","$headerCell","minimumColumnWidth","naturalWidth","getRowIndexColumnWidth","totalWidth","getColumnById","onePart","ratioWidth","wrapperWidth","firstRowWidth","resizableColumns","deltaWidth","getColumnHeaderElement","text-align","bodyWidth","firstRow","rowWidth","bodyHeight","Infinity","overflowY","overflowX","KEYCODES","13","91","16","17","18","37","38","39","40","9","27","67","70","86","Keyboard","listeners","keyCode","shiftKey","ctrlKey","metaKey","preventBubbling","listener","DEFAULT_OPTIONS","dropdownButton","label","events","onRemoveColumn","onSwitchColumn","column1","column2","onSortColumn","onCheckRow","onDestroy","asc","desc","none","filteredRowIndices","keyword","compareString","startsWith","guessFilter","filterMethod","stringCompareValue","String","getCompareValues","compareValue","compareValues","float","numberCompareValue","hay","needle","greaterThan","keywordValue","lessThan","equals","notEquals","range","rangeValues","values1","values2","getFilterMethod","freezeMessage","clusterize","logs","noDataMessage","dynamicRowHeight","DataTable","HTMLElement","buildOptions","prepare","applyDefaultSortOrder","prepareDom","freezeContainer","init","appendRows","refreshRow","renderHeader","viewportHeight","eventName","_internalEventHandlers","packageJson","__version__","provide","ReportView","ListView","view_name","super","setup_defaults","page_title","__","menu_items","report_menu_items","get_route","report_name","add_totals_row","view_user_settings","get_report_doc","doc","report_doc","json","JSON","parse","order_by","page_length","setup_columns","bind_charts_button","setup_result_area","$datatable_wrapper","$charts_wrapper","$result","setup_paging_area","$paging_area","sort_selector","ui","SortSelector","filter_area","$filter_list_wrapper","doctype","onchange","on_sort_change","before_refresh","set_dirty_state_for_custom_report","save_report_settings","current_settings","fields","get_sql_string","column_widths","get_column_widths","report_settings","deep_equal","page","clear_indicator","set_indicator","model","user_settings","save_view_user_settings","dict","render_count","chart","refresh_charts","datatable","setup_datatable","get_data","$list_count","addClass","prependTo","get_count_str","flash_row","user","session","db","get_doc","update_row","to_refresh","fieldname","cdt_row","cdt","cdoc","_field","new_row","build_row","removeClass","_flash_row","get_editing_object","remove_column_from_datatable","switch_column","checked_items","get_checked_items","toggle_actions_menu_button","report_column_total","datatabe_col","columns_in_picker","get_columns_for_picker","df","is_column_added","Dialog","title","fieldtype","docfield","bold","primary_action","show_alert","hide","insert_before","add_column_to_datatable","show","list_sidebar","sidebar","toggle_charts","get_chart_data","refresh_charts_sidebar_button","$configure_btn","hasClass","setup_charts","labels","datasets","last_chart_type","chart_type","Chart","colors","format_tooltip_x","format_tooltip_y","field","get_docfield","always_show_decimals","inline","chart_args","get_chart_args","x_field","y_fields","update_values","get_different_chart","cur_list_fields","x_fields","hidden","is_numeric_field","dialog","description","toTitle","y_axes","x_axis","y_axis","control","render_editing_input","change","set_focus","set_value","docname","set_control_value","updated_doc","_data","get_value","last_updated_doc","reject","fail","fields_dict","form","make_control","render_input","toggle_label","toggle_description","docstatus","std_fields_list","read_only","can_write","build_rows","add_field","_add_field","title_field","image_field","in_list_view","in_standard_filter","perm","has_perm","permlevel","is_value_type","report_hide","settings","add_fields","build_fields","column_name","get_full_column_name","cdt_name_fields","get_unique_cdt_in_view","uniqBy","col_index","add_currency_column","has_field","throw","col1","col2","_fields","standard_fields_filter","in_list","no_value_type","doctype_fields","get_docfields","std_fields","get_table_fields","child_table_fields","dialog_fields","hide_columns","build_column","docfield_map","get_std_field","is_non_std_field","cint","compareFn","datetime","user_to_obj","str_to_obj","totals","get_columns_totals","totals_row","cdt_field","is_editable","only_docnames","save_type","_save_report","method","stringify","exc","msgprint","boot","all_reports","ref_doctype","report_type","setup_reports","prompt","reqd","with_doc","condition","get_label","row_totals","flt","rows_in_order","total_data","get_print_settings","print_settings","render_grid","subtitle","get_filters_html_for_print","toggle_side_bar","get_dialog_fields","can_export","get_args","selected_items","total_count","primary_action_label","cmd","file_format_type","export_all_rows","open_url_post","request","url","report","is_report_manager","save_report","can_set_user_permissions","add_to_desktop","standard","standard_pages","container","add_page","make_app_page","single_column","query_report","QueryReport","BaseList","load","init_promise","tasks","setup_page","setup_report_wrapper","setup_events","run_serially","page_name","get_route_str","secondary_action","setup_progress_bar","realtime","prepared_report_action","prepared_report_doc_name","alert_message","indicator","action_name","currentTarget","toggle_nothing_to_show","load_report","clear_inner_toolbar","get_menu_items","get_report_settings","setup_page_head","refresh_report","add_make_chart_button","add_inner_button","get_possible_chart_options","toggle_message","setup_filters","set_route_filters","onload","get_user_settings","with_doctype","query_reports","_load_script","eval","script","after_ajax","html_format","execution_time","seconds_elapsed","interval","show_progress","clear_filters","set_input","get_query","on_change","previous_filters","get_filter_values","prepared_report","reset_report_view","_no_refresh","hide_form","show_form","route_options","promises","clear_fields","query","get_query_string","obj","get_query_params","last_ajax","abort","always","btn_secondary","hide_status","query_string","prepared_report_name","filters_from_report","add_prepared_report_buttons","prepare_report_data","chart_options","get_chart_options","$chart","render_chart","render_datatable","show_footer_message","hide_progress","open","urllib","get_full_url","encodeURIComponent","part1","comment_when","report_end_time","part2","part3","show_status","set_primary_action","generate_background_report","raw_data","prepare_columns","prepare_data","tree_report","add_total_row","datatable_options","get_datatable_options","$report","after_datatable_render","first_row","has_total_row","indices","accumulator","current_value","current_index","get_column_values","column_index","color","dataset_values","y_field","preview_chart","get_values","numeric_fields","non_numeric_fields","depends_on","format_cell","for_print","formatter","row_obj","raise","missing_mandatory","get_filter","field_value_map","get_meta","breadcrumbs","custom_format","filters_html","landscape","orientation","template","get_data_for_print","get_columns_for_print","base_url","get_base_url","print_css","applied_filters","render_template","render_pdf","export_dialog","set_df_property","file_format","column_row","get_data_for_csv","with_indentation","tools","downloadify","get_dict","visible_idx","getFilteredRowIndices","standard_column_count","repeat","get_visible_columns","print_report","letter_head","can_print","pdf_report","export_report","page_form","main","$status","insertAfter","appendTo","$message","message_div","status_message","execution_time_msg","$tree_footer","before","expandAllNodes","collapseAllNodes","report_dump","last_modified","with_data","doctypes","pre_loaded","doctype_data","set_data","links","row_idx","link_key","link","replace_dict","make_row","modified_names","GridReport","Class","opts","filter_inputs","preset_checks","tree_grid","padding-top","make_filters","make_waiting","get_data_and_refresh","bind_show","me","cur_grid_report","apply_filters_from_route","setup_filters_done","add_options","set_autocomplete","add_menu_item","init_filter_values","grid","set_filter","str_to_user","$filter","Awesomplete","originalEvent","sys_defaults","selectedIndex","set_default_values","from_date","year_start_date","to_date","year_end_date","add_select","default_value","add_data","icon","add_date","add_label","add_check","cssClass","keypress","which","waiting","messages","load_filter_values","user_to_str","make_name_map","reset_item_values","currency_formatter","round_item_values","get_default","round_off_data","grid_wrapper","make","setup_dataview_columns","apply_link_formatters","prepare_data_view","setup_chart","datatable_columns","chart_area","export","set_unique_id","trigger","enableColumnReorder","slickgrid_tools","get_view_data","dataView","apply_filters","_show","apply_filter","apply_zero_filter","show_zero","show_zero_check","click","is_default","date_formatter","columnDef","dataContext","repl","_style","format_number","text_formatter","esc_value","cstr","check_formatter","link_formatter","dataview_columns","filter_input","col_name","open_btn","get_link_open_icon","make_date_range_columns","date_diff","get_diff","column_map","last_date","add_column","date","build_columns","add_days","getMonth","getDate","trigger_refresh_on_change","GridReportWithPlot","chart_data","plottable_cols","plot","TreeGridReport","make_transaction_list","parent_doctype","tmap","tl","copy_dict","add_tree_grid_events","onClick","subscribe","getItem","_collapsed","updateItem","stopImmediatePropagation","tree_formatter","spacer","getIdxById","tree_dataview_filter","parent_field","item_by_name","parent_map","prepare_tree","item_dt","group_dt","group_data","item_data","item_group_map","group_ids","is_group","set_indent","msgbox","with_groups","with_ledgers"],"mappings":"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"}