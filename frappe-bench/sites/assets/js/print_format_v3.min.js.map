{"version":3,"file":"print_format_v3.min.js","sources":["../../../apps/frappe/frappe/public/js/legacy/layout.js","../../../apps/frappe/frappe/public/js/legacy/print_table.js","../../../apps/frappe/frappe/public/js/legacy/print_format.js"],"sourcesContent":["// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\n/*\n+ Layout\n\t+ wrapper\n\t\t+ LayoutRow\n\t\t\t+ main_head\n\t\t\t+ main_body\n\t\t\t\t+ header\n\t\t\t\t+ body\n\t\t\t\t..\n\t\t\t\t..\n\t\t\t\t+ subrows\n\n*/\nwindow.Layout = function Layout(parent, width) {\n\tif(parent&&parent.substr) { parent = $i(parent); }\n\n\tthis.wrapper = $a(parent, 'div', '', {display:'none'});\n\n\n\tif(width) {\n\t\tthis.width = this.wrapper.style.width;\n\t}\n\n\tthis.myrows = [];\n}\n\nLayout.prototype.addrow = function() {\n\tthis.cur_row = new LayoutRow(this, this.wrapper);\n\tthis.myrows[this.myrows.length] = this.cur_row;\n\treturn this.cur_row\n}\n\nLayout.prototype.addsubrow = function() {\n\tthis.cur_row = new LayoutRow(this, this.cur_row.main_body);\n\tthis.myrows[this.myrows.length] = this.cur_row;\n\treturn this.cur_row\n}\n\nLayout.prototype.addcell = function(width) {\n\treturn this.cur_row.addCell(width);\n}\n\n// eslint-disable-next-line\nLayout.prototype.setcolour = function(col) { $bg(cc,col); }\n\nLayout.prototype.show = function() { $(this.wrapper).toggle(false); }\nLayout.prototype.hide = function() { $(this.wrapper).toggle(false); }\nLayout.prototype.close_borders = function() {\n\tif(this.with_border) {\n\t\tthis.myrows[this.myrows.length-1].wrapper.style.borderBottom = '1px solid #000';\n\t}\n}\n\nfunction LayoutRow(layout, parent) {\n\tthis.layout = layout;\n\tthis.wrapper = $a(parent,'div','form-layout-row');\n\n\t// main head\n\tthis.main_head = $a(this.wrapper, 'div');\n\n\t// main head\n\tthis.main_body = $a(this.wrapper, 'div');\n\n\tif(layout.with_border) {\n\t\tthis.wrapper.style.border = '1px solid #000';\n\t\tthis.wrapper.style.borderBottom = '0px';\n\t}\n\n\tthis.header = $a(this.main_body, 'div','',{padding:(layout.with_border ? '0px 8px' : '0px')});\n\tthis.body = $a(this.main_body,'div');\n\tthis.table = $a(this.body, 'table', '', {width:'100%', borderCollapse: 'collapse', tableLayout:'fixed'});\n\tthis.row = this.table.insertRow(0);\n\n\tthis.mycells = [];\n}\n\nLayoutRow.prototype.hide = function() { $(this.wrapper).toggle(false); }\nLayoutRow.prototype.show = function() { $(this.wrapper).toggle(true); }\n\nLayoutRow.prototype.addCell = function(wid) {\n\tvar lc = new LayoutCell(this.layout, this, wid);\n\tthis.mycells[this.mycells.length] = lc;\n\treturn lc;\n}\n\nfunction LayoutCell(layout, layoutRow, width) {\n\tif(width) { // add '%' if user has forgotten\n\t\tvar w = width + '';\n\t\tif(w.substr(w.length-2, 2) != 'px') {\n\t\t\tif(w.substr(w.length-1, 1) != \"%\") {width = width + '%'}\n\t\t}\n\t}\n\n\tthis.width = width;\n\tthis.layout = layout;\n\tvar cidx = layoutRow.row.cells.length;\n\tthis.cell = layoutRow.row.insertCell(cidx);\n\n\tthis.cell.style.verticalAlign = 'top';\n\tthis.set_width(layoutRow.row, width);\n\n\tvar h = $a(this.cell, 'div','',{padding:(layout.with_border ? '0px 8px' : '0px')});\n\n\tthis.wrapper = $a(this.cell, 'div','',{padding:(layout.with_border ? '8px' : '0px')});\n\n\tlayout.cur_cell = this.wrapper;\n\tlayout.cur_cell.header = h;\n}\n\n// evenly distribute columns\nLayoutCell.prototype.set_width = function(row, width) {\n\tvar w = 100;\n\tvar n_cells = row.cells.length;\n\tvar cells_with_no_width = n_cells;\n\n\t// current cell\n\tif(width) {\n\t\t$y(row.cells[n_cells-1], {width: cint(width) + '%'})\n\t} else {\n\t\trow.cells[n_cells-1].estimated_width = 1;\n\t}\n\n\t// get user specified width\n\tfor(var i=0; i<n_cells; i++) {\n\t\tif(!row.cells[i].estimated_width) {\n\t\t\tw = w - cint(row.cells[i].style.width);\n\t\t\tcells_with_no_width--;\n\t\t}\n\t}\n\n\t// evenly distribute all\n\tfor(var i=0; i<n_cells; i++) {\n\t\tif(row.cells[i].estimated_width)\n\t\t\t$y(row.cells[i], {width:cint(w/cells_with_no_width) + '%'})\n\t}\n\n}\n\nLayoutCell.prototype.show = function() { $(this.wrapper).toggle(true); }\nLayoutCell.prototype.hide = function() { $(this.wrapper).toggle(false); }\n","frappe.printTable = Class.extend({\n\tinit: function(opts) {\n\t\t$.extend(this, opts);\n\t\tif(!this.columns)\n\t\t\tthis.columns = this.get_columns();\n\t\tthis.data = this.get_data();\n\t\tthis.remove_empty_cols();\n\t\tthis.set_widths();\n\t\tthis.make();\n\t},\n\tget_columns: function() {\n\t\tvar perms = frappe.perm.get_perm(this.doctype);\n\t\treturn ['Sr'].concat($.map(frappe.meta.docfield_list[this.tabletype], function(df) {\n\t\t\treturn (cint(df.print_hide) || !(perms[df.permlevel] &&\n\t\t\t\tperms[df.permlevel].read)) ? null : df.fieldname;\n\t\t}));\n\t},\n\tget_data: function() {\n\t\tvar children = frappe.get_doc(this.doctype, this.docname)[this.fieldname] || [];\n\n\t\tvar data = []\n\t\tfor(var i=0; i<children.length; i++) {\n\t\t\tdata.push(copy_dict(children[i]));\n\t\t}\n\t\treturn data;\n\t},\n\n\tremove_empty_cols: function() {\n\t\tvar me = this;\n\n\t\tvar cols_with_value = [];\n\n\t\t$.each(this.data, function(i, row) {\n\t\t\t$.each(me.columns, function(ci, fieldname) {\n\t\t\t\tvar value = row[fieldname];\n\t\t\t\tif(value || ci==0) {\n\t\t\t\t\tif(cols_with_value.indexOf(ci)===-1) {\n\t\t\t\t\t\tcols_with_value.push(ci);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tvar columns = [],\n\t\t\twidths = [],\n\t\t\thead_labels = [];\n\n\n\t\t// sort by col index, asc\n\t\tcols_with_value.sort(function(a, b) { return a - b; });\n\n\t\t// make new arrays to remove empty cols, widths and head labels\n\t\t$.each(cols_with_value, function(i, col_idx) {\n\t\t\tcolumns.push(me.columns[col_idx]);\n\t\t\tme.widths && widths.push(me.widths[col_idx]);\n\t\t\tme.head_labels && head_labels.push(me.head_labels[col_idx]);\n\t\t});\n\n\t\tthis.columns = columns;\n\t\tif(this.widths) this.widths = widths;\n\t\tif(this.head_labels) this.head_labels = head_labels;\n\n\t},\n\n\tmake: function() {\n\t\tvar me = this;\n\t\tthis.tables = [];\n\t\tvar table_data = [];\n\t\t$.each(this.data, function(i, d) {\n\t\t\ttable_data.push(d);\n\t\t\tif(d.page_break) {\n\t\t\t\tme.add_table(table_data);\n\t\t\t\ttable_data = [];\n\t\t\t}\n\t\t});\n\t\tif(table_data)\n\t\t\tme.add_table(table_data);\n\t},\n\n\tadd_table: function(data) {\n\t\tvar me = this;\n\t\tvar wrapper = $(\"<div>\")\n\t\tvar table = $(\"<table>\").css(this.table_style).appendTo(wrapper);\n\n\t\tvar headrow = $(\"<tr>\").appendTo(table);\n\t\t$.each(me.columns, function(ci, fieldname) {\n\t\t\tvar df = frappe.meta.docfield_map[me.tabletype][fieldname];\n\t\t\tif(me.head_labels) {\n\t\t\t\tvar label = me.head_labels[ci];\n\t\t\t} else {\n\t\t\t\tvar label = df ? df.label : fieldname;\n\t\t\t}\n\t\t\tvar td = $(\"<td>\").html(__(label))\n\t\t\t\t.css(me.head_cell_style)\n\t\t\t\t.css({\"width\": me.widths[ci]})\n\t\t\t\t.appendTo(headrow)\n\n\t\t\tif(df && in_list(['Float', 'Currency'], df.fieldtype)) {\n\t\t\t\ttd.css({\"text-align\": \"right\"});\n\t\t\t}\n\t\t});\n\n\t\t$.each(data, function(ri, row) {\n\t\t\tvar allow = true;\n\t\t\tif(me.condition) {\n\t\t\t\tallow = me.condition(row);\n\t\t\t}\n\t\t\tif(allow) {\n\t\t\t\tvar tr = $(\"<tr>\").appendTo(table);\n\n\t\t\t\t$.each(me.columns, function(ci, fieldname) {\n\t\t\t\t\tif(fieldname.toLowerCase()===\"sr\")\n\t\t\t\t\t\tvar value = row.idx;\n\t\t\t\t\telse\n\t\t\t\t\t\tvar value = row[fieldname];\n\n\t\t\t\t\tvar df = frappe.meta.docfield_map[me.tabletype][fieldname];\n\t\t\t\t\tvalue = frappe.format(value, df, {for_print:true});\n\n\t\t\t\t\t// set formatted value back into data so that modifer can use it\n\t\t\t\t\trow[fieldname] = value;\n\n\t\t\t\t\t// modifier is called after formatting so that\n\t\t\t\t\t// modifier's changes do not get lost in formatting (eg. 3.45%)\n\t\t\t\t\tif(me.modifier && me.modifier[fieldname])\n\t\t\t\t\t\tvalue = me.modifier[fieldname](row);\n\n\t\t\t\t\tvar td = $(\"<td>\").html(value)\n\t\t\t\t\t\t.css(me.cell_style)\n\t\t\t\t\t\t.css({width: me.widths[ci]})\n\t\t\t\t\t\t.appendTo(tr);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.tables.push(wrapper)\n\t},\n\n\tset_widths: function() {\n\t\tvar me = this;\n\t\t// if widths not passed (like in standard),\n\t\t// get from doctype and redistribute to fit 100%\n\t\tif(!this.widths) {\n\t\t\tthis.widths = $.map(this.columns, function(fieldname, ci) {\n\t\t\t\tvar df = frappe.meta.docfield_map[me.tabletype][fieldname];\n\t\t\t\treturn df && df.print_width || (fieldname==\"Sr\" ? 30 : 80);\n\t\t\t});\n\n\t\t\tvar sum = 0;\n\t\t\t$.each(this.widths, function(i, w) {\n\t\t\t\tsum += cint(w);\n\t\t\t});\n\n\t\t\tthis.widths = $.map(this.widths, function(w) {\n\t\t\t\tw = (flt(w) / sum * 100).toFixed(0);\n\t\t\t\treturn (w < 5 ? 5 : w) + \"%\";\n\t\t\t});\n\t\t}\n\t},\n\n\tget_tables: function() {\n\t\tif(this.tables.length > 1) {\n\t\t\treturn $.map(this.tables, function(t) {\n\t\t\t\treturn t.get(0);\n\t\t\t});\n\t\t} else {\n\t\t\treturn this.tables[0].get(0);\n\t\t}\n\t},\n\n\tcell_style: {\n\t\tborder: '1px solid #999',\n\t\tpadding: '3px',\n\t\t'vertical-align': 'top',\n\t\t'word-wrap': 'break-word',\n\t},\n\n\thead_cell_style: {\n\t\tborder: '1px solid #999',\n\t\tpadding: '3px',\n\t\t'vertical-align': 'top',\n\t\t'background-color': '#ddd',\n\t\t'font-weight': 'bold',\n\t\t'word-wrap': 'break-word',\n\t},\n\n\ttable_style: {\n\t\twidth: '100%',\n\t\t'border-collapse': 'collapse',\n\t\t'margin-bottom': '10px',\n\t\t'margin-top': '10px',\n\t\t'table-layout': 'fixed'\n\t},\n})\n\nwindow.print_table = function print_table(dt, dn, fieldname, tabletype, cols, head_labels, widths, condition, cssClass, modifier) {\n\treturn new frappe.printTable({\n\t\tdoctype: dt,\n\t\tdocname: dn,\n\t\tfieldname: fieldname,\n\t\ttabletype: tabletype,\n\t\tcolumns: cols,\n\t\thead_labels: head_labels,\n\t\twidths: widths,\n\t\tcondition: condition,\n\t\tcssClass: cssClass,\n\t\tmodifier: modifier\n\t}).get_tables();\n}\n","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\n// default print style\n_p.def_print_style_body = \"html, body, div, span, td, p { \\\n\t\tfont-family: inherit; \\\n\t\tfont-size: inherit; \\\n\t}\\\n\t.page-settings {\\\n\t\tfont-family: Helvetica, 'Open Sans', sans-serif;\\\n\t\tfont-size: 9pt;\\\n\t}\\\n\tpre { margin:0; padding:0;}\";\n\n_p.def_print_style_other = \"\\n.simpletable, .noborder { \\\n\t\tborder-collapse: collapse;\\\n\t\tmargin-bottom: 10px;\\\n\t}\\\n\t.simpletable td {\\\n\t\tborder: 1pt solid #777;\\\n\t\tvertical-align: top;\\\n\t\tpadding: 4px;\\\n\t}\\\n\t.noborder td {\\\n\t\tvertical-align: top;\\\n\t}\";\n\n_p.go = function(html) {\n\tvar w = _p.preview(html);\n\tw.print();\n\tw.close();\n}\n\n_p.preview = function(html) {\n\tvar w = window.open();\n\tif(!w) {\n\t\tfrappe.msgprint(__(\"Please enable pop-ups\"));\n\t\treturn;\n\t}\n\tw.document.write(html);\n\tw.document.close();\n\treturn w\n}\n\n_f.get_value = function(dt, dn, fn) {\n\tif(locals[dt] && locals[dt][dn])\n\t\treturn locals[dt][dn][fn];\n}\n\n// _p can be referenced as this inside $.extend\n$.extend(_p, {\n\tshow_dialog: function() {\n\t\tif(!_p.dialog) {\n\t\t\t_p.make_dialog();\n\t\t}\n\t\t_p.dialog.show();\n\t},\n\n\tmake_dialog: function() {\n\t\t// Prepare Dialog Box Layout\n\t\tvar dialog = new frappe.ui.Dialog({\n\t\t\ttitle: \"Print Formats\",\n\t\t\tfields: [\n\t\t\t\t{fieldtype:\"Select\", label:\"Print Format\", fieldname:\"print_format\", reqd:1},\n\t\t\t\t{fieldtype:\"Check\", label:\"No Letter Head\", fieldname:\"no_letterhead\"},\n\t\t\t\t{fieldtype:\"HTML\", options: '<p style=\"text-align: right;\">\\\n\t\t\t\t\t<button class=\"btn btn-primary btn-print\">Print</button>\\\n\t\t\t\t\t<button class=\"btn btn-default btn-preview\">Preview</button>\\\n\t\t\t\t</p>'},\n\t\t\t]\n\t\t});\n\n\t\tdialog.$wrapper.find(\".btn-print\").click(function() {\n\t\t\tvar args = dialog.get_values();\n\t\t\t_p.build(\n\t\t\t\targs.print_format, // fmtname\n\t\t\t\t_p.go, // onload\n\t\t\t\targs.no_letterhead // no_letterhead\n\t\t\t);\n\t\t});\n\n\t\tdialog.$wrapper.find(\".btn-preview\").click(function() {\n\t\t\tvar args = dialog.get_values();\n\t\t\t_p.build(\n\t\t\t\targs.print_format, // fmtname\n\t\t\t\t_p.preview, // onload\n\t\t\t\targs.no_letterhead // no_letterhead\n\t\t\t);\n\t\t});\n\n\t\tdialog.on_page_show = function() {\n\t\t\tvar $print = dialog.fields_dict.print_format.$input;\n\t\t\t$print.empty().add_options(cur_frm.print_preview.print_formats);\n\n\t\t\tif(cur_frm.$print_view_select && cur_frm.$print_view_select.val())\n\t\t\t\t$print.val(cur_frm.$print_view_select.val());\n\t\t}\n\n\t\t_p.dialog = dialog;\n\t},\n\n\t// Define formats dict\n\tformats: {},\n\n\t/* args dict can contain:\n\t\t\t+ fmtname --> print format name\n\t\t\t+ onload\n\t\t\t+ no_letterhead\n\t\t\t+ only_body\n\t*/\n\tbuild: function(fmtname, onload, no_letterhead, only_body, no_heading) {\n\t\tif(!fmtname) {\n\t\t\tfmtname= \"Standard\";\n\t\t}\n\n\t\tvar args = {\n\t\t\tfmtname: fmtname,\n\t\t\tonload: onload,\n\t\t\tno_letterhead: no_letterhead,\n\t\t\tonly_body: only_body\n\t\t};\n\n\t\tif(!cur_frm) {\n\t\t\tfrappe.msgprint(__(\"No document selected\"));\n\t\t\treturn;\n\t\t}\n\n\t\tif(!frappe.model.can_print(cur_frm.doctype, cur_frm)) {\n\t\t\tfrappe.msgprint(__(\"You are not allowed to print this document\"));\n\t\t\treturn;\n\t\t}\n\n\t\t// Get current doc (record)\n\t\tvar doc = locals[cur_frm.doctype][cur_frm.docname];\n\t\tif(args.fmtname == 'Standard') {\n\t\t\targs.onload(_p.render({\n\t\t\t\tbody: _p.print_std(args.no_letterhead, no_heading),\n\t\t\t\tstyle: _p.print_style,\n\t\t\t\tdoc: doc,\n\t\t\t\ttitle: doc.name,\n\t\t\t\tno_letterhead: args.no_letterhead,\n\t\t\t\tno_heading: no_heading,\n\t\t\t\tonly_body: args.only_body\n\t\t\t}));\n\t\t} else {\n\t\t\tvar print_format_doc = locals[\"Print Format\"][args.fmtname];\n\t\t\tif(!print_format_doc) {\n\t\t\t\tfrappe.msgprint(__(\"Unknown Print Format: {0}\", [args.fmtname]));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\targs.onload(_p.render({\n\t\t\t\tbody: print_format_doc.html,\n\t\t\t\tstyle: '',\n\t\t\t\tdoc: doc,\n\t\t\t\ttitle: doc.name,\n\t\t\t\tno_letterhead: args.no_letterhead,\n\t\t\t\tno_heading: no_heading,\n\t\t\t\tonly_body: args.only_body\n\t\t\t}));\n\t\t}\n\t},\n\n\trender: function(args) {\n\t\tvar container = document.createElement('div');\n\t\tvar stat = '';\n\n\t\tif(!args.no_heading) {\n\t\t\t// if draft/archived, show draft/archived banner\n\t\t\tstat += _p.show_draft(args);\n\t\t\tstat += _p.show_archived(args);\n\t\t\tstat += _p.show_cancelled(args);\n\t\t}\n\n\t\t// Append args.body's content as a child of container\n\t\tcontainer.innerHTML = args.body;\n\n\t\t// Show letterhead?\n\t\t_p.show_letterhead(container, args);\n\n\t\t_p.run_embedded_js(container, args.doc);\n\n\t\tvar style = _p.consolidate_css(container, args);\n\n\t\t_p.render_header_on_break(container, args);\n\n\t\treturn _p.render_final(style, stat, container, args);\n\t},\n\n\n\thead_banner_format: function() {\n\t\treturn \"\\\n\t\t\t<div style = '\\\n\t\t\t\t\ttext-align: center; \\\n\t\t\t\t\tpadding: 8px; \\\n\t\t\t\t\tbackground-color: #CCC;'> \\\n\t\t\t\t<div style = '\\\n\t\t\t\t\t\tfont-size: 20px; \\\n\t\t\t\t\t\tfont-weight: bold;'>\\\n\t\t\t\t\t{{HEAD}}\\\n\t\t\t\t</div>\\\n\t\t\t\t{{DESCRIPTION}}\\\n\t\t\t</div>\"\n\t},\n\n\t/*\n\t\tCheck if doc's status is not submitted (docstatus == 0)\n\t\tand submission is pending\n\n\t\tDisplay draft in header if true\n\t*/\n\tshow_draft: function(args) {\n\t\tvar is_doctype_submittable = 0;\n\t\tvar plist = locals['DocPerm'];\n\t\tfor(var perm in plist) {\n\t\t\tvar p = plist[perm];\n\t\t\tif((p.parent==args.doc.doctype) && (p.submit==1)){\n\t\t\t\tis_doctype_submittable = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(args.doc && cint(args.doc.docstatus)==0 && is_doctype_submittable) {\n\t\t\tvar draft = _p.head_banner_format();\n\t\t\tdraft = draft.replace(\"{{HEAD}}\", \"DRAFT\");\n\t\t\tdraft = draft.replace(\"{{DESCRIPTION}}\", \"This box will go away after the document is submitted.\");\n\t\t\treturn draft;\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t},\n\n\n\t/*\n\t\tCheck if doc is archived\n\t\tDisplay archived in header if true\n\t*/\n\tshow_archived: function(args) {\n\t\tif(args.doc && args.doc.__archived) {\n\t\t\tvar archived = _p.head_banner_format();\n\t\t\tarchived = archived.replace(\"{{HEAD}}\", \"ARCHIVED\");\n\t\t\tarchived = archived.replace(\"{{DESCRIPTION}}\", \"You must restore this document to make it editable.\");\n\t\t\treturn archived;\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t},\n\n\n\t/*\n\t\tCheck if doc is cancelled\n\t\tDisplay cancelled in header if true\n\t*/\n\tshow_cancelled: function(args) {\n\t\tif(args.doc && args.doc.docstatus==2) {\n\t\t\tvar cancelled = _p.head_banner_format();\n\t\t\tcancelled = cancelled.replace(\"{{HEAD}}\", \"CANCELLED\");\n\t\t\tcancelled = cancelled.replace(\"{{DESCRIPTION}}\", \"You must amend this document to make it editable.\");\n\t\t\treturn cancelled;\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t},\n\n\n\tconsolidate_css: function(container, args) {\n\t\t// Extract <style> content from container\n\t\tvar body_style = '';\n\t\tvar style_list = container.getElementsByTagName('style');\n\t\twhile(style_list && style_list.length>0) {\n\t\t\tfor(var i in style_list) {\n\t\t\t\tif(style_list[i] && style_list[i].innerHTML) {\n\t\t\t\t\tbody_style += style_list[i].innerHTML;\n\t\t\t\t\tvar parent = style_list[i].parentNode;\n\t\t\t\t\tif(parent) {\n\t\t\t\t\t\tparent.removeChild(style_list[i]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontainer.removeChild(style_list[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tstyle_list = container.getElementsByTagName('style');\n\t\t}\n\n\t\t// Concatenate all styles\n\t\tvar style_concat =  (args.only_body ? '' : _p.def_print_style_body)\n\t\t\t\t+ _p.def_print_style_other + args.style + body_style;\n\n\t\treturn style_concat;\n\t},\n\n\n\t// This is used to calculate and substitude values in the HTML\n\trun_embedded_js: function(container, doc) {\n\t\tvar script_list = $(container).find(\"script\");\n\n\t\tfor(var i=0, j=script_list.length; i<j; i++) {\n\t\t\tvar element = script_list[i];\n\t\t\tvar code = element.innerHTML;\n\t\t\ttry {\n\t\t\t\tvar new_html = code ? (eval(code) || \"\") : \"\";\n\t\t\t} catch(e) {\n\t\t\t\tconsole.log(\"Error in Custom Script:\" + e + \"\\n\" + code);\n\t\t\t\tconsole.trace(e);\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t\tif(in_list([\"string\", \"number\"], typeof new_html)) {\n\t\t\t\t$(element).replaceWith(this.add_span(new_html + \"\"));\n\t\t\t}\n\t\t}\n\n\t\t// remove scripts once executed\n\t\t$(container).find(\"script\").remove();\n\t},\n\n\tadd_span: function(html) {\n\t\tvar tags = [\"<span\", \"<p\", \"<div\", \"<br\", \"<table\"];\n\t\tvar match = false;\n\t\tfor(var i=0; i<tags.length; i++) {\n\t\t\tif(html.match(tags[i])) {\n\t\t\t\tmatch = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(!match) {\n\t\t\thtml = \"<span>\" + html + \"</span>\";\n\t\t}\n\n\t\treturn html;\n\t},\n\n\n\t// Attach letterhead at top of container\n\tshow_letterhead: function(container, args) {\n\t\tif(!args.no_letterhead) {\n\t\t\tcontainer.innerHTML = '<div style=\"max-width: 100%\">'\n\t\t\t\t+ _p.get_letter_head() + '</div>'\n\t\t\t\t+ container.innerHTML;\n\t\t}\n\t},\n\n\n\trender_header_on_break: function(container, args) {\n\t\tvar page_set = container.getElementsByClassName('page-settings');\n\t\tif(page_set.length) {\n\t\t\tfor(var i = 0; i < page_set.length; i++) {\n\t\t\t\tvar tmp = '';\n\t\t\t\t// if draft/archived, show draft/archived banner\n\t\t\t\ttmp += _p.show_draft(args);\n\t\t\t\ttmp += _p.show_archived(args);\n\t\t\t\t_p.show_letterhead(page_set[i], args);\n\t\t\t\tpage_set[i].innerHTML = tmp + page_set[i].innerHTML;\n\t\t\t}\n\t\t}\n\t},\n\n\n\t// called by _p.render for final render of print\n\trender_final: function(style, stat, container, args) {\n\t\tif(!args.only_body) {\n\t\t\tvar header = '<!DOCTYPE html>\\\n<html>\\\n\t<head>\\\n\t\t<meta charset=\"utf-8\" />\\\n\t\t<title>' + args.title + '</title>\\\n\t\t<style>' + style + '</style>\\\n\t</head>\\\n\t<body>';\n\t\t\tvar footer = '\\\n\t</body>\\\n</html>';\n\t\t} else {\n\t\t\tvar header = '';\n\t\t\tvar footer = '';\n\t\t}\n\t\tvar finished =  header\n\t\t\t+ '<div class=\"page-settings\">'\n\t\t\t+ stat\n\t\t\t+ container.innerHTML\n\t\t\t+ '</div>'\n\t\t\t+ footer;\n\n\n\t\t// replace relative links by absolute links\n\t\tvar prefix = window.location.href.split(\"desk\")[0]\n\t\t// find unique matches\n\t\tvar matches = $.unique(finished.match(/src=['\"]([^'\"]*)['\"]/g) || []);\n\n\t\t$.each(matches, function(i, v) {\n\t\t\tif(v.substr(0,4)==\"src=\") {\n\t\t\t\tvar v = v.substr(5, v.length-6);\n\t\t\t\tif(v.substr(0,4)!=\"http\") {\n\t\t\t\t\tfinished = finished.split(v).join(prefix + lstrip(v, \"/\"));\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\n\t\treturn finished;\n\t},\n\n\n\t// fetches letter head from current doc or control panel\n\tget_letter_head: function() {\n\t\tvar lh = '';\n\t\tif(cur_frm.doc.letter_head) {\n\t\t\tlh = cstr(frappe.boot.letter_heads[cur_frm.doc.letter_head].header);\n\t\t} else if (frappe.boot.sysdefaults.default_letter_head_content) {\n\t\t\tlh = frappe.boot.sysdefaults.default_letter_head_content;\n\t\t}\n\t\treturn lh;\n\t},\n\n\t// common print style setting\n\tprint_style: \"\\\n\t\t.datalabelcell { \\\n\t\t\tpadding: 2px 0px; \\\n\t\t\twidth: 38%; \\\n\t\t\tvertical-align: top; \\\n\t\t\t} \\\n\t\t.datainputcell { \\\n\t\t\tpadding: 2px 0px; \\\n\t\t\twidth: 62%; \\\n\t\t\ttext-align: left; \\\n\t\t\t}\\\n\t\t.sectionHeading { \\\n\t\t\tfont-size: 16px; \\\n\t\t\tfont-weight: bold; \\\n\t\t\tmargin: 8px 0px; \\\n\t\t\t} \\\n\t\t.columnHeading { \\\n\t\t\tfont-size: 14px; \\\n\t\t\tfont-weight: bold; \\\n\t\t\tmargin: 8px 0px; \\\n\t\t\t}\",\n\n\tprint_std: function(no_letterhead, no_heading) {\n\t\t// Get doctype, docname, layout for a doctype\n\t\tvar docname = cur_frm.docname;\n\t\tvar doctype = cur_frm.doctype;\n\t\tvar data = frappe.get_children(\"DocType\", doctype, \"fields\");\n\t\tvar layout = _p.add_layout(doctype);\n\t\tthis.pf_list = [layout];\n\t\tvar me = this;\n\t\tme.layout = layout;\n\n\t\t$.extend(this, {\n\t\t\tbuild_head: function(data, doctype, docname) {\n\t\t\t\t// Heading\n\t\t\t\tvar h1_style = {\n\t\t\t\t\tfontSize: '22px',\n\t\t\t\t\tmarginBottom: '8px'\n\t\t\t\t}\n\t\t\t\tvar h1 = $a(me.layout.cur_row.header, 'h1', '', h1_style);\n\n\t\t\t\t// Get print heading\n\t\t\t\tif (cur_frm.pformat[docname]) {\n\t\t\t\t\t// first check in cur_frm.pformat\n\t\t\t\t\th1.innerHTML = cur_frm.pformat[docname];\n\t\t\t\t} else {\n\t\t\t\t\t// then check if select print heading exists and has a value\n\t\t\t\t\tvar val = null;\n\t\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\t\tif (data[i].fieldname === 'select_print_heading') {\n\t\t\t\t\t\t\tval = _f.get_value(doctype, docname, data[i].fieldname);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// if not, just have doctype has heading\n\t\t\t\t\th1.innerHTML = val ? val : __(doctype);\n\t\t\t\t}\n\n\t\t\t\tvar h2_style = {\n\t\t\t\t\tfontSize: '16px',\n\t\t\t\t\tcolor: '#888',\n\t\t\t\t\tmarginBottom: '8px',\n\t\t\t\t\tpaddingBottom: '8px',\n\t\t\t\t\tborderBottom: (me.layout.with_border ? '0px' :\n\t\t\t\t\t\t'1px solid #000')\n\t\t\t\t}\n\t\t\t\tvar h2 = $a(me.layout.cur_row.header, 'div', '', h2_style);\n\t\t\t\th2.innerHTML = docname;\n\n\t\t\t\tif(cur_frm.state_fieldname && !cur_frm.fields_dict[cur_frm.state_fieldname].df.print_hide) {\n\t\t\t\t\t$a(h2, 'br');\n\t\t\t\t\tvar span = $a(h2, 'span', '',\n\t\t\t\t\t\t{padding: \"3px\", color: \"#fff\", backgroundColor: \"#777\",\n\t\t\t\t\t\t\tdisplay:\"inline-block\"});\n\t\t\t\t\tspan.innerHTML = cur_frm.doc[cur_frm.state_fieldname];\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tbuild_data: function(data, doctype, docname) {\n\t\t\t\t// Start with a row and a cell in that row\n\t\t\t\tif(data[0] && data[0].fieldtype != \"Section Break\") {\n\t\t\t\t\tme.layout.addrow();\n\t\t\t\t\tif(data[0].fieldtype != \"Column Break\") {\n\t\t\t\t\t\tme.layout.addcell();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$.extend(this, {\n\t\t\t\t\tgenerate_custom_html: function(field, doctype, docname) {\n\t\t\t\t\t\tvar container = $a(me.layout.cur_cell, 'div');\n\t\t\t\t\t\tcontainer.innerHTML = cur_frm.pformat[field.fieldname](locals[doctype][docname]);\n\t\t\t\t\t},\n\n\t\t\t\t\trender_normal: function(field, data, i) {\n\t\t\t\t\t\tswitch(field.fieldtype) {\n\t\t\t\t\t\t\tcase 'Fold': break;\n\t\t\t\t\t\t\tcase 'Section Break':\n\t\t\t\t\t\t\t\tme.layout.addrow();\n\n\t\t\t\t\t\t\t\t// Add column if no column break after this field\n\t\t\t\t\t\t\t\tif(data[i+1] && data[i+1].fieldtype !=\n\t\t\t\t\t\t\t\t\t\t'Column Break') {\n\t\t\t\t\t\t\t\t\tme.layout.addcell();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'Column Break':\n\t\t\t\t\t\t\t\tme.layout.addcell(field.width, field.label);\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'Table':\n\t\t\t\t\t\t\t\tvar table = print_table(\n\t\t\t\t\t\t\t\t\t\tdoctype, // dt\n\t\t\t\t\t\t\t\t\t\tdocname, // dn\n\t\t\t\t\t\t\t\t\t\tfield.fieldname,\n\t\t\t\t\t\t\t\t\t\tfield.options, // tabletype\n\t\t\t\t\t\t\t\t\t\tnull, // cols\n\t\t\t\t\t\t\t\t\t\tnull, // head_labels\n\t\t\t\t\t\t\t\t\t\tnull, // widths\n\t\t\t\t\t\t\t\t\t\tnull); // condition\n\t\t\t\t\t\t\t\tme.layout = _p.print_std_add_table(table, me.layout, me.pf_list, doctype, no_letterhead);\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'HTML':\n\t\t\t\t\t\t\t\tvar div = $a(me.layout.cur_cell, 'div');\n\t\t\t\t\t\t\t\tdiv.innerHTML = cstr(field.options);\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'Code':\n\t\t\t\t\t\t\t\tvar div = $a(me.layout.cur_cell, 'div');\n\t\t\t\t\t\t\t\tvar val = _f.get_value(doctype, docname,\n\t\t\t\t\t\t\t\t\tfield.fieldname);\n\t\t\t\t\t\t\t\tdiv.innerHTML = '<div>' + __(field.label) +\n\t\t\t\t\t\t\t\t\t': </div><pre style=\"font-family: Courier, Fixed;\">' + (val ? val : '') +\n\t\t\t\t\t\t\t\t\t'</pre>';\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'Text Editor':\n\t\t\t\t\t\t\t\tvar div = $a(me.layout.cur_cell, 'div');\n\t\t\t\t\t\t\t\tvar val = _f.get_value(doctype, docname,\n\t\t\t\t\t\t\t\t\tfield.fieldname);\n\t\t\t\t\t\t\t\tdiv.innerHTML = val ? val : '';\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t// Add Cell Data\n\t\t\t\t\t\t\t\t_p.print_std_add_field(doctype, docname, field, me.layout);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Then build each field\n\t\t\t\tfor(var i = 0; i < data.length; i++) {\n\t\t\t\t\tvar fieldname = data[i].fieldname ? data[i].fieldname :\n\t\t\t\t\t\tdata[i].label;\n\t\t\t\t\tvar field = fieldname ?\n\t\t\t\t\t\tfrappe.meta.get_docfield(doctype, fieldname, docname) : data[i];\n\t\t\t\t\tif(!field.print_hide) {\n\t\t\t\t\t\tif(cur_frm.pformat[field.fieldname]) {\n\t\t\t\t\t\t\t// If there is a custom method to generate the HTML, then use it\n\t\t\t\t\t\t\tthis.generate_custom_html(field, doctype, docname);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Do the normal rendering\n\t\t\t\t\t\t\tthis.render_normal(field, data, i);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tme.layout.close_borders();\n\t\t\t},\n\n\t\t\tbuild_html: function() {\n\t\t\t\tvar html = '';\n\t\t\t\tfor(var i = 0; i < me.pf_list.length; i++) {\n\t\t\t\t\tif(me.pf_list[i].wrapper) {\n\t\t\t\t\t\thtml += me.pf_list[i].wrapper.innerHTML;\n\t\t\t\t\t} else if(me.pf_list[i].innerHTML) {\n\t\t\t\t\t\thtml += me.pf_list[i].innerHTML;\n\t\t\t\t\t} else {\n\t\t\t\t\t\thtml += me.pf_list[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.pf_list = [];\n\t\t\t\treturn html;\n\t\t\t}\n\t\t});\n\n\t\tif(!no_heading) {\n\t\t\tthis.build_head(data, doctype, docname);\n\t\t}\n\n\t\tthis.build_data(data, doctype, docname);\n\n\t\tvar html = this.build_html();\n\t\treturn html;\n\t},\n\n\tadd_layout: function(doctype) {\n\t\tvar layout = new Layout();\n\t\tlayout.addrow();\n\n\t\tif(locals['DocType'][doctype].print_outline == 'Yes') {\n\t\t\tlayout.with_border = 1\n\t\t}\n\n\t\treturn layout;\n\t},\n\n\tprint_std_add_table: function(t, layout, pf_list, dt, no_letterhead) {\n\t\tif(t.appendChild) {\n\t\t\t// If only one table is passed\n\t\t\tlayout.cur_cell.appendChild(t);\n\t\t} else {\n\t\t\tvar page_break = '\\n\\\n\t\t\t\t<div style = \"page-break-after: always;\" \\\n\t\t\t\tclass = \"page_break\"></div><div class=\"page-settings\"></div>';\n\n\t\t\t// If a list of tables is passed\n\t\t\tfor(var i = 0; i < t.length-1; i++) {\n\t\t\t\t// add to current page\n\t\t\t\tlayout.cur_cell.appendChild(t[i]);\n\t\t\t\tlayout.close_borders();\n\n\t\t\t\tpf_list.push(page_break);\n\n\t\t\t\t// Create new page\n\t\t\t\tlayout = _p.add_layout(dt, no_letterhead);\n\t\t\t\tpf_list.push(layout);\n\n\t\t\t\tlayout.addrow();\n\t\t\t\tlayout.addcell();\n\n\t\t\t\tvar div = $a(layout.cur_cell, 'div');\n\t\t\t\tdiv.innerHTML = 'Continued from previous page...';\n\t\t\t\tdiv.style.padding = '4px';\n\t\t\t}\n\n\t\t\t// Append last table\n\t\t\tlayout.cur_cell.appendChild(t[t.length-1]);\n\t\t}\n\t\treturn layout;\n\t},\n\n\tprint_std_add_field: function(dt, dn, f, layout) {\n\t\tvar val = _f.get_value(dt, dn, f.fieldname);\n\t\tif(f.fieldtype!='Button') {\n\t\t\tif(val || in_list(['Float', 'Int', 'Currency'], f.fieldtype)) {\n\t\t\t\t// If value or a numeric type then proceed\n\n\t\t\t\t// Add field table\n\t\t\t\tvar row = _p.field_tab(layout.cur_cell);\n\n\t\t\t\t// Add label\n\t\t\t\trow.cells[0].innerHTML = __(f.label ? f.label : f.fieldname);\n\t\t\t\trow.cells[1].innerHTML = frappe.format(val, f, {for_print: true});\n\n\t\t\t\t// left align currency in normal display\n\t\t\t\tif(f.fieldtype == 'Currency') {\n\t\t\t\t\t$y(row.cells[1], { textAlign: 'left' });\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t},\n\n\tfield_tab: function(layout_cell) {\n\t\tvar tab = $a(layout_cell, 'table', '', {width:'100%'});\n\t\tvar row = tab.insertRow(0);\n\t\t_p.row = row; // Don't know this line's purpose\n\t\trow.insertCell(0);\n\t\trow.insertCell(1);\n\t\trow.cells[0].className = 'datalabelcell';\n\t\trow.cells[0].style.width = \"38%\";\n\t\trow.cells[1].className = 'datainputcell';\n\t\treturn row;\n\t}\n});\n"],"names":["LayoutRow","layout","parent","this","wrapper","$a","main_head","main_body","with_border","style","border","borderBottom","header","padding","body","table","width","borderCollapse","tableLayout","row","insertRow","mycells","LayoutCell","layoutRow","w","substr","length","cidx","cells","cell","insertCell","verticalAlign","set_width","h","cur_cell","window","Layout","$i","display","myrows","prototype","addrow","cur_row","addsubrow","addcell","addCell","setcolour","col","$bg","cc","show","$","toggle","hide","close_borders","wid","lc","n_cells","cells_with_no_width","$y","cint","estimated_width","i","frappe","printTable","Class","extend","init","opts","columns","get_columns","data","get_data","remove_empty_cols","set_widths","make","perms","perm","get_perm","doctype","concat","map","meta","docfield_list","tabletype","df","print_hide","permlevel","read","fieldname","children","get_doc","docname","push","copy_dict","me","cols_with_value","each","ci","indexOf","widths","head_labels","sort","a","b","col_idx","tables","table_data","d","page_break","add_table","css","table_style","appendTo","headrow","docfield_map","label","td","html","__","head_cell_style","in_list","fieldtype","text-align","ri","allow","condition","tr","toLowerCase","value","idx","format","for_print","modifier","cell_style","print_width","sum","flt","toFixed","get_tables","t","get","vertical-align","word-wrap","background-color","font-weight","border-collapse","margin-bottom","margin-top","table-layout","print_table","dt","dn","cols","cssClass","_p","def_print_style_body","def_print_style_other","go","preview","print","close","open","document","write","msgprint","_f","get_value","fn","locals","show_dialog","dialog","make_dialog","ui","Dialog","title","fields","reqd","options","$wrapper","find","click","args","get_values","build","print_format","no_letterhead","on_page_show","$print","fields_dict","$input","empty","add_options","cur_frm","print_preview","print_formats","$print_view_select","val","formats","fmtname","onload","only_body","no_heading","model","can_print","doc","render","print_std","print_style","name","print_format_doc","container","createElement","stat","show_draft","show_archived","show_cancelled","innerHTML","show_letterhead","run_embedded_js","consolidate_css","render_header_on_break","render_final","head_banner_format","is_doctype_submittable","plist","p","submit","docstatus","draft","replace","__archived","archived","cancelled","body_style","style_list","getElementsByTagName","parentNode","removeChild","script_list","j","element","code","new_html","eval","e","console","log","trace","replaceWith","add_span","remove","tags","match","get_letter_head","page_set","getElementsByClassName","tmp","footer","finished","prefix","location","href","split","matches","unique","v","join","lstrip","lh","letter_head","cstr","boot","letter_heads","sysdefaults","default_letter_head_content","get_children","add_layout","pf_list","build_head","h1","fontSize","marginBottom","pformat","h2_style","color","paddingBottom","h2","state_fieldname","backgroundColor","build_data","generate_custom_html","field","render_normal","print_std_add_table","div","print_std_add_field","get_docfield","build_html","print_outline","appendChild","f","field_tab","textAlign","layout_cell","className"],"mappings":"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"}